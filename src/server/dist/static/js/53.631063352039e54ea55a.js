webpackJsonp([53],{"0E7Y":function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var n=t("0oES"),i=t("syAl"),r=t("pADA"),s={props:{optons:Object},data:function(){return{tableInfo:[],currentPage:1,pageSize:void 0,deviceStatus:{},comDeviceStatuSpinner:{}}},beforeUpdate:function(){this.tableInfo=this.optons.tablelist},created:function(){this.pageSize=i.a.get("PageSize")},computed:{dataTypeInfoPage:function(){return this.tableInfo?this.tableInfo.slice((this.currentPage-1)*this.pageSize,this.currentPage*this.pageSize):[]}},methods:{changePage:function(e){this.currentPage=e},handleCurrentChange:function(e){this.$emit("rowDate",e),1==e.length?this.$emit("isEnabled",!0):this.$emit("isEnabled",!1)}}},o={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{attrs:{"visible.sync":"optons.isShow"}},[t("aui-table",{ref:"tableInfo",staticClass:"tableMarginTop",staticStyle:{height:"430px"},attrs:{data:e.dataTypeInfoPage,border:"",width:"100%","header-row-class-name":"tableHeaderClass","highlight-current-row":""},on:{"selection-change":e.handleCurrentChange}},[t("aui-table-column",{attrs:{prop:"menunum",label:"菜单编号"}}),e._v(" "),t("aui-table-column",{attrs:{prop:"menuname",label:"菜单名称"}})],1),e._v(" "),t("div",{staticStyle:{"text-align":"right","margin-top":"20px"}},[t("aui-pagination",{attrs:{background:"","page-size":e.pageSize,"current-page":e.currentPage,layout:"total, prev, pager, next, jumper",total:e.tableInfo.length},on:{"current-change":e.changePage}})],1)],1)},staticRenderFns:[]};var u=t("/Xao")(s,o,!1,function(e){t("CZE8")},"data-v-b199a5fa",null).exports,d=t("QdxY"),l=t("zdBp"),c=t("XDsu"),m=t("AA3o"),p=t.n(m),h=function e(){p()(this,e),this.data={BusiOper:"Q",DeviceModel:"",DeviceNum:"",TlrNo:""},this.BusiDataKey="devappqry",this.TransServiceCode="ib-dbcomm/dbComm"},g=function e(){p()(this,e),this.data={OperType:"Q",DeviceModel:"",DeviceNum:"",AppNum:"",MenuViewNum:""},this.CommCode="IBUserPermissionsManagement",this.SceneCode="DevSpeacialPermission",this.TransServiceCode="mg-afaservices-upm/devSpeacialPermission"},v={data:function(){return{props:{label:"menuname",children:"children"},menuViewId:[],appId:[],devModel:[],tradMenuList:[],devList:[],checkList:[],menuMap:{},queryForm:{devModel:"",devId:"",appId:"",menuViewId:""},dialogList:{listTable:u},addTable:[],delTable:[],loading:!1,pageSize:void 0,currentPage:1,currentPage1:1,totalRcrdNum:0,totalRcrdNum1:0,currentRow:[],querystate:!1,confirmstate:!1,rules:{devModel:[{required:!0,message:"请选择设备类型",trigger:"change"}],devId:[{required:!0,message:"请选择设备",trigger:"change"}],appId:[{required:!0,message:"请选择应用编号",trigger:"change"}],menuViewId:[{required:!0,message:"请选择菜单视图",trigger:"change"}]}}},computed:{tableDataPage:function(){return this.addTable.slice((this.currentPage-1)*this.pageSize,this.currentPage*this.pageSize)},tableDataPage1:function(){return this.delTable.slice((this.currentPage1-1)*this.pageSize,this.currentPage1*this.pageSize)}},created:function(){this.pageSize=i.a.get("PageSize"),this.initDate()},watch:{queryForm:{handler:function(e,a){this.currentPage=1},deep:!0}},methods:{changePage:function(e){this.currentPage=e},changePage1:function(e){this.currentPage1=e},rowDate:function(){},initDate:function(){var e=this,a=new l.a;Object(n.a)(a).then(function(a){e.devModel=a.RspInfo.pageList||[]}).catch(function(a){e.$aui.message.show({type:"warning",message:a.SYS_HEAD.ReturnMessage}),console.error("查询错误",a)})},appChange:function(){this.queryForm.devId="",this.queryForm.appId="",this.dataClear(),this.appId=[],this.menuViewId=[],this.queryForm.menuViewId="",this.devIdBlur()},devNumChange:function(){var e=this;this.loading=!0,this.dataClear(),this.queryForm.appId="",this.appId=[],this.menuViewId=[],this.queryForm.menuViewId="";var a=new h;a.data.DeviceModel=this.queryForm.devModel,a.data.DeviceNum=this.queryForm.devId,a.data.TlrNo=this.$store.getters.UserNum,Object(n.a)(a).then(function(a){e.appId=a.RspInfo.Result||[],e.loading=!1}).catch(function(a){e.$aui.message.show({type:"warning",message:"设备已删除或无激活应用"}),console.error("查询错误",a)})},menuViewLoad:function(){var e=this;this.loading=!0,this.dataClear(),this.menuViewId=[],this.queryForm.menuViewId="";var a=new d.a;a.data.AppNum=this.queryForm.appId,Object(n.a)(a).then(function(a){e.menuViewId=a.RspInfo.Result||[],e.loading=!1}).catch(function(a){e.loading=!1,e.$aui.message.show({type:"warning",message:a.SYS_HEAD.ReturnMessage}),console.error("查询错误",a)})},devIdBlur:function(){var e=this;if(this.loading=!0,""==this.queryForm.devModel)return this.devList=[],void(this.loading=!1);var a=new c.a;a.data.DeviceModel=this.queryForm.devModel,a.data.start=0,a.data.length=99999,a.data.draw=2,Object(n.a)(a).then(function(a){e.devList=a.RspInfo.pageList||[],e.loading=!1}).catch(function(a){e.$aui.message.show({type:"warning",message:"该型号下没有设备!"}),e.devList=[],e.loading=!1})},confirm:function(){var e=this;this.loading=!0;var a=new g;a.data.OperType="C",a.data.DeviceModel=this.queryForm.devModel,a.data.DeviceNum=this.queryForm.devId,a.data.AppNum=this.queryForm.appId,a.data.MenuViewNum=this.queryForm.menuViewId;var t=[];Object(n.a)(a).then(function(a){(a.RspInfo.pageList1||[]).forEach(function(e){t.push(e.entynum)});var n=[],i=[],r=[];(e.$refs.tree.getCheckedNodes()||[]).forEach(function(a){"02"==a.menutype&&(n.push(a.menunum),t.indexOf(a.menunum)<0&&e.menuMap[a.menunum]&&i.push({menunum:a.menunum,menuname:a.menuname}))}),t.forEach(function(a){n.indexOf(a)<0&&e.menuMap[a]&&r.push({menunum:a,menuname:e.menuMap[a]})}),e.addTable=i,e.delTable=r,e.loading=!1,e.confirmstate=!0,e.loading=!1}).catch(function(a){e.loading=!1})},clearForm:function(e){this.dataClear(),this.menuViewId=[],this.devList=[],this.$refs[""+e].resetFields()},submit:function(){var e=this;this.loading=!0;var a=new g;a.data.OperType="M",a.data.DeviceModel=this.queryForm.devModel,a.data.DeviceNum=this.queryForm.devId,a.data.AppNum=this.queryForm.appId,a.data.MenuViewNum=this.queryForm.menuViewId;var t=[],i=this.addTable||[],r=this.delTable||[];i.forEach(function(a){t.push({TranCode:a.menunum,PrivlegeType:"0",DeviceNum:e.queryForm.devId,AppNum:e.queryForm.appId,MenuViewNum:e.queryForm.menuViewId,DeviceModel:e.queryForm.devModel})}),r.forEach(function(a){t.push({TranCode:a.menunum,PrivlegeType:"1",DeviceNum:e.queryForm.devId,AppNum:e.queryForm.appId,MenuViewNum:e.queryForm.menuViewId,DeviceModel:e.queryForm.devModel})}),a.data.postList=t,Object(n.a)(a).then(function(a){e.$aui.message.show({type:"success",message:"保存成功"}),e.querystate=!1,e.confirmstate=!1,e.loading=!1}).catch(function(a){e.$aui.message.show({type:"warning",message:"保存失败"}),e.querystate=!1,e.confirmstate=!1,e.loading=!1})},dataClear:function(){this.confirmstate=!1,this.querystate=!1,this.tradMenuList=[],this.checkList=[],this.addTable=[],this.delTable=[],this.menuMap={}},queryDate:function(){var e=this;this.$refs.queryForm.validate(function(a){if(!a)return!1;e.loading=!0,e.dataClear();var t=new g;t.data.DeviceModel=e.queryForm.devModel,t.data.DeviceNum=e.queryForm.devId,t.data.AppNum=e.queryForm.appId,t.data.MenuViewNum=e.queryForm.menuViewId,Object(n.a)(t).then(function(a){var t=a.RspInfo.pageList||[];e.tradMenuList=r.a.formatTreeData(t,"menunum","parentmenunum");var n={};t.forEach(function(a){e.$set(n,a.menunum,a.menuname)}),e.menuMap=n;var i=[];(a.RspInfo.pageList1||[]).forEach(function(e){i.push(e.entynum)}),e.checkList=i;for(var s=[],o=[],u=0,d=a.RspInfo.pageList2?a.RspInfo.pageList2.length:0;u<d;u++){var l=a.RspInfo.pageList2[u];"0"==l.privlegetype?s.push(l):o.push(l)}e.delTable=o,e.addTable=s,e.querystate=!0,e.loading=!1}).catch(function(a){e.$aui.message.show({type:"warning",message:a.SYS_HEAD.ReturnMessage}),e.loading=!1})})}}},f={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"dev-brand-manage",attrs:{"element-loading-text":"加载中。。。"}},[t("aui-card",[t("aui-form",{ref:"queryForm",attrs:{model:e.queryForm,rules:e.rules,size:"mini","label-position":"top"}},[t("aui-row",{attrs:{gutter:10}},[t("aui-col",{attrs:{lg:4,md:6}},[t("aui-form-item",{attrs:{label:"设备型号",prop:"devModel"}},[t("aui-select",{attrs:{placeholder:"请选择设备型号"},on:{change:e.appChange},model:{value:e.queryForm.devModel,callback:function(a){e.$set(e.queryForm,"devModel",a)},expression:"queryForm.devModel"}},e._l(e.devModel,function(e){return t("aui-option",{key:e.value,attrs:{label:e.devicemodel+"-"+e.devicetype,value:e.devicemodel,disabled:e.disabled}})}))],1)],1),e._v(" "),t("aui-col",{attrs:{lg:4,md:6}},[t("aui-form-item",{attrs:{label:"设备编号",prop:"devId"}},[t("aui-select",{attrs:{placeholder:"请选择设备"},on:{change:e.devNumChange},model:{value:e.queryForm.devId,callback:function(a){e.$set(e.queryForm,"devId",a)},expression:"queryForm.devId"}},e._l(e.devList,function(e){return t("aui-option",{key:e.devicenum,attrs:{label:e.devicenum,value:e.devicenum,disabled:e.disabled}})}))],1)],1),e._v(" "),t("aui-col",{attrs:{lg:4,md:6}},[t("aui-form-item",{attrs:{label:"应用编号",prop:"appId"}},[t("aui-select",{attrs:{placeholder:"请选择应用编号"},on:{change:e.menuViewLoad},model:{value:e.queryForm.appId,callback:function(a){e.$set(e.queryForm,"appId",a)},expression:"queryForm.appId"}},e._l(e.appId,function(e){return t("aui-option",{key:e.value,attrs:{label:e.AppNum+"-"+e.AppName,value:e.AppNum,disabled:e.disabled}})}))],1)],1),e._v(" "),t("aui-col",{attrs:{lg:4,md:6}},[t("aui-form-item",{attrs:{label:"菜单视图编号",prop:"menuViewId"}},[t("aui-select",{attrs:{placeholder:"请选择菜单视图编号"},on:{change:function(a){e.dataClear()}},model:{value:e.queryForm.menuViewId,callback:function(a){e.$set(e.queryForm,"menuViewId",a)},expression:"queryForm.menuViewId"}},e._l(e.menuViewId,function(e){return t("aui-option",{key:e.value,attrs:{label:e.MenuViewName,value:e.MenuViewNum,disabled:e.disabled}})}))],1)],1)],1),e._v(" "),t("aui-row",{attrs:{gutter:2}},[t("aui-col",{staticClass:"searchBtnMarginTop",attrs:{lg:2,md:3}},[t("aui-button",{attrs:{type:"primary",icon:"aui-icon-search",loading:e.loading,size:"mini"},on:{click:function(a){e.queryDate()}}},[e._v("查询")])],1),e._v(" "),t("aui-col",{staticClass:"searchBtnMarginTop",attrs:{lg:9,md:3}},[t("aui-button",{attrs:{type:"warning",size:"mini",icon:"aui-icon-refresh"},on:{click:function(a){e.clearForm("queryForm")}}},[e._v("重置")])],1),e._v(" "),t("aui-col",{staticClass:"searchBtnMarginTop",attrs:{lg:11,md:3}},[t("aui-button",{attrs:{type:"primary",size:"mini",icon:"aui-icon-success",disabled:!e.querystate},on:{click:function(a){e.confirm()}}},[e._v("确认")])],1),e._v(" "),t("aui-col",{staticClass:"searchBtnMarginTop",attrs:{lg:1,md:3}},[t("aui-button",{attrs:{type:"primary",size:"mini",icon:"aui-icon-check",disabled:!e.confirmstate},on:{click:function(a){e.submit()}}},[e._v("提交")])],1)],1)],1)],1),e._v(" "),t("aui-row",{attrs:{gutter:10}},[t("aui-col",{attrs:{span:8}},[t("aui-card",{staticStyle:{margin:"10px 0 0 0"}},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("span",[e._v("交易菜单")])]),e._v(" "),t("aui-tree",{ref:"tree",attrs:{data:e.tradMenuList,props:e.props,"show-checkbox":"","default-checked-keys":e.checkList,"node-key":"menunum"}})],1)],1),e._v(" "),t("aui-col",{attrs:{span:8}},[t("aui-card",{staticStyle:{margin:"10px 0 0 0"}},[t("span",[e._v("添加权限")]),e._v(" "),t("aui-table",{ref:"table",staticClass:"tableMarginTop",staticStyle:{"min-height":"390px"},attrs:{data:e.tableDataPage,border:"","highlight-current-row":"","header-row-class-name":"tableHeaderClass"}},[t("aui-table-column",{attrs:{prop:"menunum",label:"菜单编号"}}),e._v(" "),t("aui-table-column",{attrs:{prop:"menuname",label:"菜单名称"}})],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:this.addTable,expression:"this.addTable"}]},[t("aui-pagination",{attrs:{"current-page":e.currentPage,background:"","page-size":e.pageSize,layout:"total, prev, pager, next, jumper",total:e.addTable.length},on:{"current-change":e.changePage}})],1)],1)],1),e._v(" "),t("aui-col",{attrs:{span:8}},[t("aui-card",{staticStyle:{margin:"10px 0 0 0"}},[t("span",[e._v("删除权限")]),e._v(" "),t("aui-table",{ref:"table",staticClass:"tableMarginTop",staticStyle:{"min-height":"390px"},attrs:{data:e.tableDataPage1,border:"","highlight-current-row":"","header-row-class-name":"tableHeaderClass"}},[t("aui-table-column",{attrs:{prop:"menunum",label:"菜单编号"}}),e._v(" "),t("aui-table-column",{attrs:{prop:"menuname",label:"菜单名称"}})],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:this.delTable,expression:"this.delTable"}]},[t("aui-pagination",{attrs:{"current-page":e.currentPage1,background:"","page-size":e.pageSize,layout:"total, prev, pager, next, jumper",total:e.delTable.length},on:{"current-change":e.changePage1}})],1)],1)],1)],1)],1)},staticRenderFns:[]};var b=t("/Xao")(v,f,!1,function(e){t("qOm7")},"data-v-b33601fe",null);a.default=b.exports},"9iRk":function(e,a,t){(e.exports=t("BkJT")(!1)).push([e.i,"",""])},CZE8:function(e,a,t){var n=t("9iRk");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);t("8bSs")("70b07253",n,!0)},TCkY:function(e,a,t){(e.exports=t("BkJT")(!1)).push([e.i,"\n.roleBlock[data-v-b33601fe] {\n  border: 1px solid #eee;\n  margin-right: 10px;\n  border-radius: 3px;\n  height: 280px;\n  /* overflow: auto; */\n}\n.headerRole[data-v-b33601fe] {\n  padding: 10px 10px;\n  background: #f5f7fa;\n  border-bottom: 1px solid #e4e7ed;\n}\n.roleBox[data-v-b33601fe] {\n  height: 555px;\n  overflow-y: auto;\n  padding: 10px;\n}\n.cardStyle[data-v-b33601fe] {\n  margin: 5px 0;\n}\n.listEdit[data-v-b33601fe] {\n  text-align: right;\n}\n.listEdit a[data-v-b33601fe] {\n    margin: 5px;\n}\n.demo-table-expand .aui-form-item[data-v-b33601fe] {\n  margin-bottom: 5px;\n}\n.editClass input.el-input__inner[data-v-b33601fe] {\n  border: none;\n  background: rgba(0, 0, 0, 0) !important;\n}\n.fade-enter-active[data-v-b33601fe],\n.fade-leave-active[data-v-b33601fe] {\n  -webkit-transition: opacity 0.6s;\n  transition: opacity 0.6s;\n}\n.fade-enter[data-v-b33601fe],\n.fade-leave-to[data-v-b33601fe] {\n  opacity: 0;\n}\n",""])},qOm7:function(e,a,t){var n=t("TCkY");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);t("8bSs")("3d3a0b86",n,!0)}});