webpackJsonp([139],{Oj6l:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("0oES"),s=n("AA3o"),i=n.n(s),r=function e(){i()(this,e),this.data={BusiOper:"Q",BranchNum:""},this.CommCode="CQParaManage",this.SceneCode="SelBranchNum",this.TransServiceCode="mg-afaservices-cq/allBranchLish"},o=n("syAl"),u=function e(){i()(this,e),this.data={Brno:""},this.CommCode="CRReservationSystem",this.SceneCode="ReserveBizServicePrdQry",this.TransServiceCode="mg-afaservices-rsv/servetimeBusiServeTimeQry"},c=function e(){i()(this,e),this.data={Brno:"",data:"",WeekOrHoliday:""},this.CommCode="CRReservationSystem",this.SceneCode="NtwkReserveServicePrdConf",this.TransServiceCode="mg-afaservices-rsv/servetimeBusiServeTimeCfg"},l=n("pADA"),m={components:{selectTree:n("tzsN").a},data:function(){return{currentRow:[],QueryForm:{branchNum:[]},branchNum:[],brnoList:[],busiStatusMap:{},busiAttrMap:{},total:void 0,busiTypeList:[],brnoMap:{},permission:{},loading:!1,isDisabledDel:!1,currentPage:1,pageSize:void 0,rules:{branchNum:[{required:!0,message:"请选择机构编号",trigger:"change"}]}}},watch:{"QueryForm.branchNum":function(e){this.query()}},created:function(){this.pageSize=o.a.get("PageSize"),this.busiStatusMap=o.a.get("Status"),this.busiAttrMap=o.a.get("BsAttr1"),this.queryBranchNum()},computed:{},methods:{queryBranchNum:function(){var e=this,t=new r;t.data.BranchNum=this.$store.getters.BranchNum,Object(a.a)(t).then(function(t){e.brnoList=t.RspInfo.Result||[],e.brnoMap=t.RspInfo.orgMap||{},e.brnoList=l.a.formatTreeData(e.brnoList,"orgno","superno"),e.QueryForm.branchNum.push(e.brnoList[0].orgno)}).catch(function(t){e.$aui.message.show({type:"warning",message:t.SYS_HEAD.ReturnMessage}),console.error("查询错误",t)})},dataFormat:function(e,t){if("BsID"==t.property)return e.BsID+"-"+e.BsName},checkPermission:function(){if(0===this.busiTypeList.length)this.$aui.message.show({type:"warning",message:"无提交信息!"});else{for(var e=!0,t="",n=0,a=this.busiTypeList.length;n<a;n++){t="";for(var s=1;s<9;s++)this.busiTypeList[n]["Cntnt"+s]&&(t+=s);if(this.busiTypeList[n].WeekOrHoliday=t,""!==this.busiTypeList[n].ServeTime&&!this.busiTypeList[n].ServeTime.match("^((([01][0-9])|(2[0-3])):[0-5][0-9]-(([01][0-9])|(2[0-3])):[0-5][0-9])(;((([01][0-9])|(2[0-3])):[0-5][0-9]-(([01][0-9])|(2[0-3])):[0-5][0-9]))?$"))return this.$aui.message.show({type:"warning",message:this.busiTypeList[n].BsID+"业务服务时段格式有误!"}),e=!1,!1;this.busiTypeList[n].HolidayServeTime=this.busiTypeList[n].ServeTime}e&&this.submit()}},submit:function(){var e=this,t=new c;t.data.Brno=this.QueryForm.branchNum[0],t.data.data=this.busiTypeList,Object(a.a)(t).then(function(t){e.loading=!1,e.$aui.message.show({type:"success",message:"修改成功"})}).catch(function(t){e.$aui.message.show({type:"warning",message:"错误信息："+t.SYS_HEAD.ReturnMessage}),e.loading=!1,console.log(t)})},query:function(){var e=this;this.$refs.QueryForm.validate(function(t){if(t){e.loading=!0;var n=new u;n.data.Brno=e.QueryForm.branchNum[0],Object(a.a)(n).then(function(t){e.loading=!1,e.busiTypeList=t.RspInfo.data||[],e.busiTypeList.forEach(function(t){""!=t.ServeTime&&void 0!=t.ServeTime||(t.ServeTime="08:00-18:00");for(var n=1;n<9;n++)void 0!==t.WeekOrHoliday&&-1!==t.WeekOrHoliday.indexOf(n+"")?e.$set(t,"Cntnt"+n,!0):e.$set(t,"Cntnt"+n,!1)}),0===e.busiTypeList.length&&e.$aui.message.show({type:"warning",message:"无业务类型,请添加!"})}).catch(function(t){e.loading=!1,e.$aui.message.show({type:"warning",message:"请求失败，错误码:"+t.SYS_HEAD.ReturnCode+"，错误信息："+t.SYS_HEAD.ReturnMessage}),console.log(t)})}})}}},d={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":"加载中。。。"}},[n("aui-card",[n("aui-form",{ref:"QueryForm",attrs:{model:e.QueryForm,rules:e.rules,size:"mini","label-position":"top"}},[n("aui-row",{attrs:{gutter:10}},[n("aui-col",{attrs:{lg:4,md:6}},[n("aui-form-item",{attrs:{label:"机构编号",prop:"branchNum"}},[n("select-tree",{staticStyle:{width:"170px"},attrs:{"single-check":!0,props:{id:"orgno",label:"cname",children:"children"},"tree-data":e.brnoList,placeholder:"请选择机构"},model:{value:e.QueryForm.branchNum,callback:function(t){e.$set(e.QueryForm,"branchNum",t)},expression:"QueryForm.branchNum"}})],1)],1)],1)],1)],1),e._v(" "),n("aui-card",{staticStyle:{"margin-top":"10px"}},[n("aui-table",{ref:"busiTypeList",staticClass:"tableMarginTop",staticStyle:{"min-height":"390px"},attrs:{data:e.busiTypeList,border:"","header-row-class-name":"tableHeaderClass"}},[n("aui-table-column",{attrs:{prop:"BsID",formatter:e.dataFormat,label:"业务类型","min-width":"187px"}}),e._v(" "),n("aui-table-column",{attrs:{label:"星期一","min-width":"57px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("aui-checkbox",{model:{value:t.row.Cntnt1,callback:function(n){e.$set(t.row,"Cntnt1",n)},expression:"scope.row.Cntnt1"}})]}}])}),e._v(" "),n("aui-table-column",{attrs:{label:"星期二","min-width":"57px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("aui-checkbox",{model:{value:t.row.Cntnt2,callback:function(n){e.$set(t.row,"Cntnt2",n)},expression:"scope.row.Cntnt2"}})]}}])}),e._v(" "),n("aui-table-column",{attrs:{label:"星期三","min-width":"57px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("aui-checkbox",{model:{value:t.row.Cntnt3,callback:function(n){e.$set(t.row,"Cntnt3",n)},expression:"scope.row.Cntnt3"}})]}}])}),e._v(" "),n("aui-table-column",{attrs:{label:"星期四","min-width":"57px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("aui-checkbox",{model:{value:t.row.Cntnt4,callback:function(n){e.$set(t.row,"Cntnt4",n)},expression:"scope.row.Cntnt4"}})]}}])}),e._v(" "),n("aui-table-column",{attrs:{label:"星期五","min-width":"57px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("aui-checkbox",{model:{value:t.row.Cntnt5,callback:function(n){e.$set(t.row,"Cntnt5",n)},expression:"scope.row.Cntnt5"}})]}}])}),e._v(" "),n("aui-table-column",{attrs:{label:"星期六","min-width":"57px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("aui-checkbox",{model:{value:t.row.Cntnt6,callback:function(n){e.$set(t.row,"Cntnt6",n)},expression:"scope.row.Cntnt6"}})]}}])}),e._v(" "),n("aui-table-column",{attrs:{label:"星期日","min-width":"57px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("aui-checkbox",{model:{value:t.row.Cntnt7,callback:function(n){e.$set(t.row,"Cntnt7",n)},expression:"scope.row.Cntnt7"}})]}}])}),e._v(" "),n("aui-table-column",{attrs:{label:"节假日","min-width":"57px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("aui-checkbox",{model:{value:t.row.Cntnt8,callback:function(n){e.$set(t.row,"Cntnt8",n)},expression:"scope.row.Cntnt8"}})]}}])})],1),e._v(" "),n("div",{staticStyle:{"text-align":"center","margin-top":"10px"}},[n("aui-button",{attrs:{type:"primary",icon:"aui-icon-check"},on:{click:e.checkPermission}},[e._v("提交")])],1)],1)],1)])},staticRenderFns:[]};var h=n("/Xao")(m,d,!1,function(e){n("SEV9")},"data-v-2e424d57",null);t.default=h.exports},SEV9:function(e,t,n){var a=n("c86p");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);n("8bSs")("66b93c49",a,!0)},c86p:function(e,t,n){(e.exports=n("BkJT")(!1)).push([e.i,"",""])}});