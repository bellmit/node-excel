webpackJsonp([134],{OBG9:function(a,e,t){var n=t("SCtf");"string"==typeof n&&(n=[[a.i,n,""]]),n.locals&&(a.exports=n.locals);t("8bSs")("1250ccb1",n,!0)},SCtf:function(a,e,t){(a.exports=t("BkJT")(!1)).push([a.i,"\n.aui-date-editor.aui-input,\n.aui-date-editor.el-input__inner {\n  width: 100%;\n}\n\n",""])},e4nW:function(a,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=t("tzsN"),r=t("pADA"),i=t("0oES"),o=t("syAl"),l=(t("Luip"),t("0VOF")),s=t("AA3o"),d=t.n(s),c=function a(){d()(this,a),this.data={BusiOper:"Q"},this.BusiDataKey="SelectRetainCardLog",this.TransServiceCode="ib-dbcomm/dbComm"},u={components:{selectTree:n.a},data:function(){return{pickerOptionsStart:{disabledDate:function(a){(new Date).getTime();return a.getTime()>Date.now()}},brnoList:[],formInline:{startdate:"",enddate:"",branchId:[],devNum:"",reatincardtype:"",reatincarddealflag:"",expdealstatus:""},filename:"吞卡记录查询导出",currentPage:1,loading:!1,tableData:[],tableTotal:0,typereatincardtype:[{label:"开卡过程中吞卡 ",value:"0"},{label:"非开卡过程中吞卡",value:"1"}],typereatincarddealflag:[{label:"吞卡 ",value:"0"},{label:"已上缴",value:"1"},{label:"已处理 ",value:"2"}],reatincarddealflagtype:o.a.get("reatincarddealflagtype"),reatincardtypetype:o.a.get("reatincardtypetype")}},created:function(){this.formInline.startdate=r.a.getNowTime(29),this.formInline.enddate=r.a.getNowTime(0),this.pageSize=o.a.get("PageSize"),this.initBrno()},watch:{formInline:{handler:function(a,e){this.currentPage=1},deep:!0}},methods:{dateChange:function(){this.formInline.startdate>this.formInline.enddate?(this.$aui.message.show({type:"warning",message:"开始日期不能大于结束日期"}),this.formInline.startdate=r.a.getNowTime(29),this.formInline.enddate=r.a.getNowTime(0)):this.formInline.startdate<r.a.getNowTime(365)&&(this.$aui.message.show({type:"warning",message:"开始日期不能超过当日前12个月"}),this.formInline.startdate=r.a.getNowTime(365))},dFormat:function(a,e){return r.a.timeFormat2Date(a[e.property])},tFormat:function(a,e){return r.a.timeFormat2Time(a[e.property])},reatincarddealflagFormat:function(a,e){return this.reatincarddealflagtype[a[e.property]]},reatincardtypeFormat:function(a,e){return this.reatincardtypetype[a[e.property]]},handleDownload:function(){var a=this;t.e(169).then(t.bind(null,"FNRk")).then(function(e){var t=a.list1,n=a.formatJson(["PLATFM_SN","PLATFM_WORK_DT","PLATFM_WORK_TM","ORG_NO","ORG_NM","EQUIP_NO","CARD_NO","SWA_CARD_FLG_CD","PLATFM_SN","RSNDSC","DLWTH_FLG_CD","SERVICECODE"],t);e.export_json_to_excel({header:["业务流水号","交易日期","交易时间","机构号","机构名称","设备编号","卡号","吞卡标志","错误代码","错误描述","吞卡处理标志","备注"],data:n,filename:a.filename,autoWidth:a.autoWidth,bookType:a.bookType})})},formatJson:function(a,e){return e.map(function(e){return a.map(function(a){return"timestamp"===a?parseTime(e[a]):e[a]})})},initBrno:function(){var a=this;this.loading=!0;var e=new l.a;e.data.orgno=this.$store.getters.BranchNum,Object(i.a)(e).then(function(e){a.loading=!1,a.branchNum=e.RspInfo.Result||[],a.permission=r.a.objArray2Hash(a.branchNum,"orgno"),a.brnoMap=e.RspInfo.orgMap||{},a.brnoList=r.a.formatTreeData(a.branchNum,"orgno","superno"),a.formInline.branchId.push(a.brnoList[0].orgno)}).catch(function(e){a.loading=!1,a.$aui.message.show({type:"warning",message:e.SYS_HEAD.ReturnMessage}),console.error("查询错误",e)})},handleSizeChange:function(a){},handleCurrentChange:function(a){this.currentPage=a,this.querylist()},querylist:function(){var a=this;this.loading=!0;var e=new c;e.data.ORG_NO=this.formInline.branchId[0],e.data.BGN_DT=this.formInline.startdate,e.data.END_DT=this.formInline.enddate,e.data.DLWTH_FLG_CD=this.formInline.reatincarddealflag,e.data.SWA_CARD_FLG_CD=this.formInline.reatincardtype,e.data.EQUIP_NO=this.formInline.devNum,e.data.CurtPage=this.currentPage+"",e.data.PageSize=this.pageSize+"",e.data.StartRows=(this.currentPage-1)*this.pageSize+"",Object(i.a)(e).then(function(e){a.loading=!1,a.tableData=e.RspInfo.Result||[],a.tableTotal=e.RspInfo.totalNum,"0"==a.tableTotal&&a.$aui.message.show({type:"warning",message:"无满足条件的记录"})}).catch(function(e){a.loading=!1,a.tableData=[],a.tableTotal=0,a.$aui.message.show({type:"error",message:"请求失败，错误码:"+e.SYS_HEAD.ReturnCode+"，错误信息："+e.SYS_HEAD.ReturnMessage}),console.error("查询错误",e)})},getExcel:function(){var a=this;this.$refs.formInline.validate(function(e){if(e){a.loading=!0;var t=new c;t.data.ORG_NO=a.formInline.branchId[0],t.data.BGN_DT=a.formInline.startdate,t.data.END_DT=a.formInline.enddate,t.data.DLWTH_FLG_CD=a.formInline.reatincarddealflag,t.data.SWA_CARD_FLG_CD=a.formInline.reatincardtype,t.data.EQUIP_NO=a.formInline.devNum,t.data.CurtPage="1",t.data.PageSize="50000000",t.data.StartRows="",console.log(t.data),Object(i.a)(t).then(function(e){a.loading=!1,a.list1=e.RspInfo.Result||[],a.handleDownload()}).catch(function(e){a.loading=!1,a.$aui.message.show({type:"warning",message:"请求失败，错误码:"+e.SYS_HEAD.ReturnCode+"，错误信息："+e.SYS_HEAD.ReturnMessage}),console.error("查询错误",e)})}})},resetForm:function(a){this.formInline.selBrno=[],this.$refs[a].resetFields()}}},m={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:a.loading,expression:"loading"}],attrs:{"element-loading-text":"拼命加载中"}},[t("aui-card",{staticStyle:{"margin-bottom":"10px",overflow:"visible"}},[t("aui-form",{ref:"formInline",attrs:{model:a.formInline,"label-position":"top",size:"mini"}},[t("aui-row",{attrs:{gutter:10}},[t("aui-col",{attrs:{md:6,lg:4}},[t("aui-form-item",{staticClass:"typeInfo-aui-form-item",attrs:{label:"机构编号",prop:"branchId"}},[t("select-tree",{staticStyle:{width:"170px"},attrs:{"single-check":!0,props:{id:"orgno",label:"cname",children:"children"},"tree-data":a.brnoList,placeholder:"请选择机构"},model:{value:a.formInline.branchId,callback:function(e){a.$set(a.formInline,"branchId",e)},expression:"formInline.branchId"}})],1)],1),a._v(" "),t("aui-col",{attrs:{md:6,lg:4}},[t("aui-form-item",{attrs:{label:"开始日期",prop:"startdate"}},[t("aui-date-picker",{attrs:{editable:!1,clearable:!1,"value-format":"yyyyMMdd",type:"date",placeholder:"选择日期","picker-options":a.pickerOptionsStart},on:{change:a.dateChange},model:{value:a.formInline.startdate,callback:function(e){a.$set(a.formInline,"startdate",e)},expression:"formInline.startdate"}})],1)],1),a._v(" "),t("aui-col",{attrs:{md:6,lg:4}},[t("aui-form-item",{attrs:{label:"结束日期",prop:"enddate"}},[t("aui-date-picker",{attrs:{editable:!1,clearable:!1,"value-format":"yyyyMMdd",type:"date",placeholder:"选择日期","picker-options":a.pickerOptionsStart},on:{change:a.dateChange},model:{value:a.formInline.enddate,callback:function(e){a.$set(a.formInline,"enddate",e)},expression:"formInline.enddate"}})],1)],1),a._v(" "),t("aui-col",{attrs:{md:6,lg:4}},[t("aui-form-item",{attrs:{label:"吞卡标志",prop:"reatincardtype"}},[t("aui-select",{attrs:{placeholder:"选择吞卡标志"},model:{value:a.formInline.reatincardtype,callback:function(e){a.$set(a.formInline,"reatincardtype",e)},expression:"formInline.reatincardtype"}},a._l(a.typereatincardtype,function(a){return t("aui-option",{key:a.value,attrs:{label:a.label,value:a.value}})}))],1)],1),a._v(" "),t("aui-col",{attrs:{md:6,lg:4}},[t("aui-form-item",{attrs:{label:"处理标志",prop:"reatincarddealflag"}},[t("aui-select",{attrs:{placeholder:"请选择处理标志"},model:{value:a.formInline.reatincarddealflag,callback:function(e){a.$set(a.formInline,"reatincarddealflag",e)},expression:"formInline.reatincarddealflag"}},a._l(a.typereatincarddealflag,function(a){return t("aui-option",{key:a.value,attrs:{label:a.label,value:a.value}})}))],1)],1),a._v(" "),t("aui-col",{attrs:{md:6,lg:4}},[t("aui-form-item",{attrs:{label:"设备编号",prop:"devNum"}},[t("aui-input",{attrs:{placeholder:"请选择设备编号"},model:{value:a.formInline.devNum,callback:function(e){a.$set(a.formInline,"devNum",e)},expression:"formInline.devNum"}})],1)],1)],1),a._v(" "),t("aui-row",[t("aui-col",{staticClass:"searchBtnMarginTop",attrs:{md:3,lg:2}},[t("aui-form-item",[t("aui-button",{attrs:{type:"primary",icon:"aui-icon-search"},on:{click:a.querylist}},[a._v("查询")])],1)],1),a._v(" "),t("aui-col",{staticClass:"searchBtnMarginTop",attrs:{lg:2,md:3}},[t("aui-form-item",[t("aui-button",{attrs:{type:"warning",icon:"aui-icon-refresh"},on:{click:function(e){a.resetForm("formInline")}}},[a._v("重置")])],1)],1),a._v(" "),t("aui-col",{staticClass:"searchBtnMarginTop",attrs:{lg:2,md:3}},[t("aui-form-item",[a.btnPermission("Button_SwallowCardQue_Export")?t("aui-button",{attrs:{type:"primary",icon:"aui-icon-download"},on:{click:a.getExcel}},[a._v("导出")]):a._e()],1)],1)],1)],1)],1),a._v(" "),t("aui-card",[t("aui-table",{staticStyle:{"min-height":"390px"},attrs:{data:a.tableData,height:"390","header-row-class-name":"tableHeaderClass",border:""}},[t("aui-table-column",{attrs:{prop:"PLATFM_SN",label:"业务流水号"}}),a._v(" "),t("aui-table-column",{attrs:{prop:"PLATFM_WORK_DT",label:"交易日期"}}),a._v(" "),t("aui-table-column",{attrs:{prop:"PLATFM_WORK_TM",label:"交易时间"}}),a._v(" "),t("aui-table-column",{attrs:{prop:"ORG_NO",label:"机构号"}}),a._v(" "),t("aui-table-column",{attrs:{prop:"ORG_NM",label:"机构名称"}}),a._v(" "),t("aui-table-column",{attrs:{prop:"EQUIP_NO",label:"设备编号"}}),a._v(" "),t("aui-table-column",{attrs:{prop:"CARD_NO",label:"卡号"}}),a._v(" "),t("aui-table-column",{attrs:{prop:"SWA_CARD_FLG_CD",formatter:a.reatincardtypeFormat,label:"吞卡标志"}}),a._v(" "),t("aui-table-column",{attrs:{prop:"PLATFM_SN",label:"错误代码"}}),a._v(" "),t("aui-table-column",{attrs:{prop:"RSNDSC",label:"错误描述"}}),a._v(" "),t("aui-table-column",{attrs:{prop:"DLWTH_FLG_CD",formatter:a.reatincarddealflagFormat,label:"吞卡处理标志"}}),a._v(" "),t("aui-table-column",{attrs:{prop:"SERVICECODE",label:"备注"}})],1),a._v(" "),t("aui-pagination",{staticStyle:{"text-align":"right","margin-top":"20px"},attrs:{"current-page":a.currentPage,background:"",layout:"total, prev, pager, next, jumper",total:a.tableTotal},on:{"current-change":a.handleCurrentChange,"update:currentPage":function(e){a.currentPage=e}}})],1)],1)},staticRenderFns:[]};var p=t("/Xao")(u,m,!1,function(a){t("OBG9")},null,null);e.default=p.exports}});