webpackJsonp([97],{"1Zcf":function(e,t,a){(e.exports=a("BkJT")(!1)).push([e.i,"\n.type-info-bottom {\n  margin-top: 10px;\n}\n.box {\n  margin-top: 20px;\n  text-align: right;\n}\n.headerClass {\n  background: #f7f7f7 !important;\n}\n.aui-date-editor.aui-input {\n  width: 100% !important;\n}\n.aui-card {\n  overflow: inherit;\n}\n",""])},"Tby/":function(e,t,a){var r=a("1Zcf");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("8bSs")("3981ee5e",r,!0)},Trs9:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("syAl"),i=a("B+2e"),o=a("0oES"),n=a("0VOF"),s=a("AA3o"),u=a.n(s),l=function e(){u()(this,e),this.data={BusiOper:"Q"},this.BusiDataKey="GetQueueNoInfo",this.TransServiceCode="ib-dbcomm/dbComm"},p=a("pADA"),c={components:{selectTree:a("tzsN").a},data:function(){return{QueueTpStatus:{0:"0-取号",1:"1-业务办理中",2:"2-业务办理结束",3:"3-弃号",4:"4-转移",5:"5-休眠"},list1:[],filename:"排队流水查询导出",bookType:"xlsx",autoWidth:!0,brnoMap:{},loading:!1,brnoList:[],tableData:[],CtfTplist:[],CustGrd:[],QueueCallTp:{1:"1-普通",2:"2-转移",3:"3-指定叫号"},busiTypeList:[{label:"0-全部",value:"0"},{label:"2-个人业务",value:"2"},{label:"1-对公业务",value:"1"}],tableTotal:0,currentPage:1,pageSize:r.a.get("PageSize"),queryForm:{branchId:[],sTime:"",eTime:"",busiType:"0"},rules:{branchId:[{required:!0,message:"请选择机构编号",trigger:"change"}],sTime:[{required:!0,message:"请选择开始日期",trigger:"change"}],eTime:[{required:!0,message:"请选择结束日期",trigger:"change"}]},pickerOptionsStart:{disabledDate:function(e){(new Date).getTime();return e.getTime()>Date.now()}}}},mounted:function(){this.queryForm.sTime=p.a.getNowTime(29),this.queryForm.eTime=p.a.getNowTime(0),this.initBrno(),this.NoticPrty()},methods:{handleDownload:function(){var e=this;a.e(169).then(a.bind(null,"FNRk")).then(function(t){var a=e.list1,r=e.formatJson(["Brno","QueueNo","QueueGetTime","TransferNum","WinNo","QueueCallTlrNo","BizType","BsID","BsName","QueueTpName","IDCode","IDType"],a);t.export_json_to_excel({header:["机构","排队号","取号时间","转移次数","窗口号","服务柜员号","业务类型","业务ID","业务名称","队列名称","证件号码","证件类型"],data:r,filename:e.filename,autoWidth:e.autoWidth,bookType:e.bookType})})},formatJson:function(e,t){return t.map(function(t){return e.map(function(e){return"timestamp"===e?parseTime(t[e]):t[e]})})},dateChange:function(){this.queryForm.sTime>this.queryForm.eTime&&(this.$aui.message.show({type:"warning",message:"开始日期不能大于结束日期"}),this.queryForm.sTime=p.a.getNowTime(29),this.queryForm.eTime=p.a.getNowTime(0))},NoticPrty:function(){var e=this,t=new i.a;t.data.DataKey="CtfTp",Object(o.a)(t).then(function(t){e.CtfTplist=t.RspInfo.Result||[]}).catch(function(t){e.loading=!1})},NoticPrty1:function(){var e=this,t=new i.a;t.data.DataKey="CustGrd",Object(o.a)(t).then(function(t){e.CustGrd=t.RspInfo.Result||[]}).catch(function(t){e.loading=!1})},appNumFormat:function(e,t){var a="";return(this.CtfTplist||[]).forEach(function(r){r.DataKeyVal==e[t.property]&&(a=r.DataKeyVal+"-"+r.Meaning)}),a},appNumFormat1:function(e,t){var a="";return(this.CustGrd||[]).forEach(function(r){r.DataKeyVal==e[t.property]&&(a=r.DataKeyVal+"-"+r.Meaning)}),a},dataFormat:function(e,t){if("Brno"==t.property)return e[t.property]+"-"+this.brnoMap[e[t.property]];if("QueueTpStatus"==t.property)return this.QueueTpStatus[e[t.property]];if("QueueCallTp"==t.property)return this.QueueCallTp[e[t.property]];if("QueueGetTime"==t.property)return p.a.timeFormat2Time(e[t.property]);if("BizType"==t.property)for(var a=0;a<this.busiTypeList.length;a++)if(e[t.property]==this.busiTypeList[a].value)return this.busiTypeList[a].label},initBrno:function(){var e=this;this.loading=!0;var t=new n.a;t.data.orgno=this.$store.getters.BranchNum,Object(o.a)(t).then(function(t){e.loading=!1,e.brnoList=t.RspInfo.Result||[],e.brnoMap=t.RspInfo.orgMap||{},e.brnoList=p.a.formatTreeData(e.brnoList,"orgno","superno"),e.queryForm.branchId.push(e.brnoList[0].orgno)}).catch(function(t){e.loading=!1,e.$aui.message.show({type:"warning",message:"请求失败，错误码:"+t.SYS_HEAD.ReturnCode+"，错误信息："+t.SYS_HEAD.ReturnMessage}),console.error("错误信息",t)})},queryModel:function(){var e=this;this.loading=!0;var t=new l;t.data.Brno=this.queryForm.branchId[0],t.data.StartDate=this.queryForm.sTime,t.data.EndDate=this.queryForm.eTime,t.data.BusiType="0"==this.queryForm.busiType?"":this.queryForm.busiType,t.data.BusiOper="Q",t.data.CurtPage=this.currentPage+"",t.data.PageSize=this.pageSize+"",t.data.StartRows=(this.currentPage-1)*this.pageSize+"",Object(o.a)(t).then(function(t){e.loading=!1,console.log(t.RspInfo.Result),e.tableData=t.RspInfo.Result||[],e.tableTotal=t.RspInfo.totalNum||0}).catch(function(t){e.$aui.message.show({type:"warning",message:"请求失败，错误码:"+t.SYS_HEAD.ReturnCode+"，错误信息："+t.SYS_HEAD.ReturnMessage}),e.tableData=[],e.tableTotal=0,e.loading=!1,console.error("查询错误",t)})},getExcel:function(){var e=this;this.loading=!0;var t=new l;t.data.Brno=this.queryForm.branchId[0],t.data.StartDate=this.queryForm.sTime,t.data.EndDate=this.queryForm.eTime,t.data.BusiType="0"==this.queryForm.busiType?"":this.queryForm.busiType,t.data.BusiOper="Q",t.data.CurtPage="1",t.data.PageSize="50000000",t.data.StartRows="",Object(o.a)(t).then(function(t){e.loading=!1,"000000"==t.SYS_HEAD.ReturnCode?(e.list1=t.RspInfo.Result||[],e.handleDownload()):e.$aui.message.show({type:"warning",message:"导出失败"+t.SYS_HEAD.ReturnMessage})})},handleSizeChange:function(e){this.pageSize=e,this.queryModel()},handleCurrentChange:function(e){this.currentPage=e,this.queryModel()}}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"customer-buss-form-manage",attrs:{"element-loading-text":"加载中。。。"}},[a("div",[a("aui-card",{staticClass:"type-info-box-card"},[a("aui-form",{ref:"queryForm",attrs:{model:e.queryForm,rules:e.rules,size:"mini","label-position":"top"}},[a("aui-row",{attrs:{gutter:10}},[a("aui-col",{attrs:{md:6,lg:4}},[a("aui-form-item",{staticClass:"typeInfo-aui-form-item",attrs:{label:"机构编号",prop:"branchId"}},[a("select-tree",{staticStyle:{width:"170px"},attrs:{"single-check":!0,props:{id:"orgno",label:"cname",children:"children"},"tree-data":e.brnoList,placeholder:"请选择机构"},model:{value:e.queryForm.branchId,callback:function(t){e.$set(e.queryForm,"branchId",t)},expression:"queryForm.branchId"}})],1)],1),e._v(" "),a("aui-col",{attrs:{md:6,lg:4}},[a("aui-form-item",{staticClass:"typeInfo-aui-form-item",attrs:{label:"开始日期",prop:"sTime"}},[a("aui-date-picker",{attrs:{"value-format":"yyyyMMdd",type:"date",placeholder:"选择日期",clearable:!1,"picker-options":e.pickerOptionsStart},on:{change:e.dateChange},model:{value:e.queryForm.sTime,callback:function(t){e.$set(e.queryForm,"sTime",t)},expression:"queryForm.sTime"}})],1)],1),e._v(" "),a("aui-col",{attrs:{md:6,lg:4}},[a("aui-form-item",{staticClass:"typeInfo-aui-form-item",attrs:{label:"结束日期",prop:"eTime"}},[a("aui-date-picker",{attrs:{"value-format":"yyyyMMdd",type:"date",placeholder:"选择日期",clearable:!1,"picker-options":e.pickerOptionsStart},on:{change:e.dateChange},model:{value:e.queryForm.eTime,callback:function(t){e.$set(e.queryForm,"eTime",t)},expression:"queryForm.eTime"}})],1)],1),e._v(" "),a("aui-col",{attrs:{md:6,lg:4}},[a("aui-form-item",{attrs:{label:"业务类型",prop:"busiType"}},[a("aui-select",{attrs:{placeholder:"请选择业务类型"},model:{value:e.queryForm.busiType,callback:function(t){e.$set(e.queryForm,"busiType",t)},expression:"queryForm.busiType"}},e._l(e.busiTypeList,function(e){return a("aui-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1),e._v(" "),a("aui-col",{staticClass:"searchBtnMarginTop",attrs:{md:3,lg:2}},[a("aui-button",{attrs:{type:"primary",size:"mini",icon:"aui-icon-search"},on:{click:e.queryModel}},[e._v("查询")])],1),e._v(" "),a("aui-col",{staticClass:"searchBtnMarginTop",attrs:{md:3,lg:2}},[e.btnPermission("Button_RunRateRep_Export")?a("aui-button",{staticClass:"b-button",attrs:{type:"primary",size:"mini",icon:"aui-icon-download"},on:{click:e.getExcel}},[e._v("导出")]):e._e()],1)],1)],1)],1),e._v(" "),a("aui-card",{staticClass:"type-info-bottom"},[a("aui-table",{ref:"tableData",staticClass:"tableMarginTop",attrs:{data:e.tableData,"header-row-class-name":"tableHeaderClass",border:""}},[a("aui-table-column",{attrs:{prop:"Brno",formatter:e.dataFormat,label:"机构"}}),e._v(" "),a("aui-table-column",{attrs:{prop:"QueueNo",label:"排队号"}}),e._v(" "),a("aui-table-column",{attrs:{prop:"QueueGetTime",label:"取号时间",formatter:e.dataFormat}}),e._v(" "),a("aui-table-column",{attrs:{prop:"TransferNum",label:"转移次数"}}),e._v(" "),a("aui-table-column",{attrs:{prop:"WinNo",label:"窗口号"}}),e._v(" "),a("aui-table-column",{attrs:{prop:"QueueCallTlrNo",label:"服务柜员号"}}),e._v(" "),a("aui-table-column",{attrs:{prop:"BizType",label:"业务类型",formatter:e.dataFormat}}),e._v(" "),a("aui-table-column",{attrs:{prop:"BsID",label:"业务ID"}}),e._v(" --\x3e\n        "),a("aui-table-column",{attrs:{prop:"BsName",label:"业务名称"}}),e._v(" "),a("aui-table-column",{attrs:{prop:"QueueTpName",label:"队列名称"}}),e._v(" "),a("aui-table-column",{attrs:{prop:"IDCode",label:"证件号码"}}),e._v(" "),a("aui-table-column",{attrs:{prop:"IDType",formatter:e.appNumFormat,label:"证件类型"}})],1),e._v(" "),a("div",{staticClass:"box"},[a("aui-pagination",{attrs:{background:"","current-page":e.currentPage,"page-size":e.pageSize,layout:"total, prev, pager, next, jumper",total:e.tableTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t}}})],1)],1)],1)])},staticRenderFns:[]};var d=a("/Xao")(c,m,!1,function(e){a("Tby/")},null,null);t.default=d.exports}});