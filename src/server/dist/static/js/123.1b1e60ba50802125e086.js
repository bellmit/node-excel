webpackJsonp([123],{"03+g":function(e,t,a){(e.exports=a("BkJT")(!1)).push([e.i,"",""])},"EK+v":function(e,t,a){var n=a("03+g");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a("8bSs")("6e55e604",n,!0)},bsZ9:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("0oES"),s=a("pADA"),i=(a("syAl"),a("AA3o")),r=a.n(i),o=function e(){r()(this,e),this.data={Brno:"",BusiOper:"Q2",RuleTp:"01"},this.BusiDataKey="sel_CQMS_RULE3",this.TransServiceCode="ib-dbcomm/dbComm"},u=function e(){r()(this,e),this.data={RuleId:"",Brno:""},this.CommCode="CQParaManage",this.SceneCode="CallRuleDetail",this.TransServiceCode="mg-afaservices-cq/callRuleQuery"},c=function e(){r()(this,e),this.data={RuleId:"",BsList:""},this.CommCode="CQParaManage",this.SceneCode="RuleOfCallCfg",this.TransServiceCode="mg-afaservices-cq/callRuleCallrule"},l={name:"callruleConfiguration",data:function(){return{pageList:[],checkPageList1:[],checkPageList:[],GroupTranList:[],loading:!1,formInline:{ID:""},props:{label:"BsName",id:"BsID"},BusinessList:[],BusinessList1:[],rules:{ID:[{required:!0,message:"规则ID不能为空",trigger:"change"}]}}},created:function(){this.getRuleID()},methods:{TranGroupToTran:function(){var e=this;this.$aui.confirm.show("此操作将配置叫号规则, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.TranGroupToTran1()}).catch(function(){e.$aui.message.show({type:"info",message:"已取消配置"})})},TranGroupToTran1:function(){var e=this,t=this.$refs.tree.getCheckedNodes();this.$refs.formInline.validate(function(a){if(!a)return e.$aui.message.show({type:"warning",message:"必输项不能为空"}),!1;e.loading=!0;for(var s=new c,i=[],r=0;r<t.length;r++)t[r].icon||i.push({BsID:t[r].pid,QueueTpID:t[r].BsID,QueueTpPrty:t[r].QueueTpPrty});s.data.BsList=i,s.data.RuleId=e.formInline.ID,Object(n.a)(s).then(function(t){e.loading=!1,e.$aui.message.show({type:"success",message:"配置成功!"}),e.isShow=!1,e.$emit("refreshBrand")}).catch(function(t){e.$aui.message.show({type:"warning",message:t.SYS_HEAD.ReturnMessage}),e.loading=!1,console.log(t)})})},menuViewChange:function(e){this.tranGroupQuery(e)},tranGroupQuery:function(e){var t=this;this.$refs.formInline.validate(function(e){if(e){t.loading=!0;var a=new u;a.data.RuleId=t.formInline.ID.split("-")[0],a.data.Brno=t.formInline.ID.split("_")[0],Object(n.a)(a).then(function(e){t.loading=!1;var a=e.RspInfo.BsList||[];t.checkPageList=e.RspInfo.ResultList||[];var n=a.map(function(e){return{BsID:e.BsID,BsName:e.BsID+"-"+e.BsName,pid:"0",QueueTpPrty:e.QueueTpPrty,icon:"folder"}});a=s.a.formatTreeData(n,"BsID","pid");var i=(e.RspInfo.data||[]).map(function(e){return{QueBs:e.QueBs,BsID:e.QueueTpID,BsName:e.QueueTpID+"-"+e.QueueTpName,pid:e.BsID,QueueTpPrty:e.QueueTpPrty}}),r=n.concat(i);t.pageList=s.a.formatTreeData(r,"BsID","pid");var o=[];t.checkPageList.forEach(function(e){o.push(e.QueBs)}),t.checkPageList=o}).catch(function(e){t.loading=!1,t.pageList=[],t.$aui.message.show({type:"warning",message:e.SYS_HEAD.ReturnMessage}),console.error("查询错误",e)})}})},getRuleID:function(){var e=this,t=new o;t.data.Brno=this.$store.getters.BranchNum,Object(n.a)(t).then(function(t){e.BusinessList=t.RspInfo.Result||[],e.formInline.ID=e.BusinessList[0].RuleId,e.tranGroupQuery()})},handleCheckChange:function(e,t,a){this.$refs.tree.getCheckedKeys();this.GroupTranList=[];for(var n=0;n<e.length;n++){e[n].length>3&&this.GroupTranList.push(PostList)}}}},p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":"加载中。。。"}},[a("aui-card",{staticStyle:{"margin-bottom":"10px"}},[a("aui-form",{ref:"formInline",attrs:{model:e.formInline,rules:e.rules,size:"mini","label-position":"top"}},[a("aui-row",{attrs:{gutter:10}},[a("aui-col",{attrs:{md:12,lg:6}},[a("aui-form-item",{attrs:{prop:"ID",label:"规则ID"}},[a("aui-select",{attrs:{placeholder:"请选择"},on:{change:e.tranGroupQuery},model:{value:e.formInline.ID,callback:function(t){e.$set(e.formInline,"ID",t)},expression:"formInline.ID"}},e._l(e.BusinessList,function(e){return a("aui-option",{key:e.RuleId,attrs:{label:e.RuleId+"-"+e.RuleName,value:e.RuleId}})}))],1)],1),e._v(" "),a("aui-col",{staticClass:"searchBtnMarginTop",attrs:{lg:2,md:3}},[a("aui-button",{attrs:{type:"primary",size:"mini",icon:"aui-icon-search"},on:{click:e.tranGroupQuery}},[e._v("查询")])],1),e._v(" "),a("aui-col",{staticClass:"searchBtnMarginTop",attrs:{lg:2,md:3}},[a("aui-button",{attrs:{type:"primary",size:"mini"},on:{click:e.TranGroupToTran}},[e._v("确认")])],1)],1)],1)],1),e._v(" "),a("aui-card",{staticStyle:{"margin-top":"10px"}},[a("aui-tree",{ref:"tree",attrs:{data:e.pageList,props:e.props,"show-checkbox":"","default-checked-keys":e.checkPageList,"node-key":"QueBs"},on:{"check-change":e.handleCheckChange},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.node,s=t.data;return a("span",{},[s.icon?a("svg-icon",{attrs:{"icon-class":s.icon}}):e._e(),e._v(" "),a("span",[e._v(e._s(n.label))])],1)}}])})],1)],1)},staticRenderFns:[]};var d=a("/Xao")(l,p,!1,function(e){a("EK+v")},"data-v-53b88ffe",null);t.default=d.exports}});