webpackJsonp([95],{"5Q2w":function(e,a,t){(e.exports=t("BkJT")(!1)).push([e.i,"\n.type-info-bottom {\n  margin-top: 10px;\n}\n.box {\n  margin-top: 20px;\n  text-align: right;\n}\n.headerClass {\n  background: #f7f7f7 !important;\n}\n.aui-date-editor.aui-input {\n  width: 100% !important;\n}\n.aui-card {\n  overflow: inherit;\n}\n",""])},YUJi:function(e,a,t){var r=t("5Q2w");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);t("8bSs")("4af09f24",r,!0)},rFIf:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r=t("syAl"),o=t("B+2e"),n=t("tzsN"),i=t("0oES"),s=t("pADA"),u=t("0VOF"),l=t("AA3o"),c=t.n(l),m=function e(){c()(this,e),this.data={BusiOper:"Q"},this.CommCode="CRReservationSystem",this.SceneCode="CustLimitInfoQry",this.TransServiceCode="mg-afaservices-rpt/custLimitInfoQuery"},d={components:{selectTree:n.a},data:function(){return{loading:!1,filename:"爽约限制客户名单查询导出",bookType:"xlsx",autoWidth:!0,brnoList:[],branchNum:[],queryForm:{branchNum:[],sTime:"",eTime:"",cardType:"",cardID:"",custNm:""},brnoMap:{},cardTypeList:[],tableData:[],tableTotal:0,currentPage:1,pageSize:r.a.get("PageSize"),rules:{branchNum:[{required:!0,message:"请选择机构号",trigger:"change"}]}}},mounted:function(){this.queryForm.sTime=s.a.getNowTime(29),this.queryForm.eTime=s.a.getNowTime(0),this.queryBranchNum(),this.loadcCardType()},watch:{"queryForm.branchNum":function(e){this.$refs.queryForm.clearValidate()}},methods:{dateChange:function(){this.queryForm.sTime>this.queryForm.eTime&&(this.$aui.message.show({type:"warning",message:"起始日期不能大于截止日期"}),this.queryForm.sTime=s.a.getNowTime(29),this.queryForm.eTime=s.a.getNowTime(0))},queryBranchNum:function(){var e=this;this.loading=!0;var a=new u.a;a.data.orgno=this.$store.getters.BranchNum,Object(i.a)(a).then(function(a){e.loading=!1,e.brnoList=a.RspInfo.Result||[],e.brnoMap=a.RspInfo.orgMap||{},e.brnoList=s.a.formatTreeData(e.brnoList,"orgno","superno"),e.queryForm.branchNum.push(e.brnoList[0].orgno)}).catch(function(a){e.loading=!1,console.error("错误信息",a)})},loadcCardType:function(){var e=this,a=new o.a;a.data.DataKey="CtfTp",Object(i.a)(a).then(function(a){e.cardTypeList=a.RspInfo.Result||[]}).catch(function(a){e.loading=!1})},clearForm:function(e){this.$refs[""+e].resetFields()},queryModel:function(){var e=this;this.tableData=[],this.$refs.queryForm.validate(function(a){if(a){e.loading=!0;var t=new m;t.data.Brno=e.queryForm.branchNum[0],t.data.StartDate=e.queryForm.sTime,t.data.EndDate=e.queryForm.eTime,t.data.CardTp=e.queryForm.cardType,t.data.CardID=e.queryForm.cardID,t.data.CustNm=e.queryForm.custNm,t.data.length=e.pageSize,t.data.start=(e.currentPage-1)*e.pageSize,Object(i.a)(t).then(function(a){e.loading=!1,"000000"===a.SYS_HEAD.ReturnCode?(e.tableData=a.RspInfo.Result,e.tableTotal=a.RspInfo.totalNum):e.$aui.message.show({type:"error",message:"请求失败，错误码:"+a.SYS_HEAD.ReturnCode+"，错误信息："+a.SYS_HEAD.ReturnMessage})}).catch(function(a){e.loading=!1,console.error(a)})}})},getExcel:function(){var e=this;this.$refs.queryForm.validate(function(a){if(a){e.loading=!0;var t=new m;t.data.Brno=e.queryForm.branchNum[0],t.data.StartDate=e.queryForm.sTime,t.data.EndDate=e.queryForm.eTime,t.data.CardTp=e.queryForm.cardType,t.data.CardID=e.queryForm.cardID,t.data.CustNm=e.queryForm.custNm,t.data.CurtPage="1",t.data.PageSize="50000000",t.data.length="50000000",t.data.start="0",Object(i.a)(t).then(function(a){e.loading=!1,"000000"==a.SYS_HEAD.ReturnCode?(e.list1=a.RspInfo.Result||[],e.handleDownload()):e.$aui.message.show({type:"error",message:"请求失败，错误码:"+a.SYS_HEAD.ReturnCode+"，错误信息："+a.SYS_HEAD.ReturnMessage})}).catch(function(a){e.loading=!1,console.error("查询错误",a)})}})},handleDownload:function(){var e=this;t.e(169).then(t.bind(null,"FNRk")).then(function(a){var t=e.list1,r=e.formatJson(["brno","card_tp","card_nm","cust_nm","limit_tp","eff_dt","invalid_dt"],t);a.export_json_to_excel({header:["机构号","证件类型","证件号码","客户姓名","爽约限制业务类型","爽约限制生效日期","爽约限制失效日期"],data:r,filename:e.filename,autoWidth:e.autoWidth,bookType:e.bookType})})},formatJson:function(e,a){return a.map(function(a){return e.map(function(e){return"timestamp"===e?parseTime(a[e]):a[e]})})},handleSizeChange:function(e){this.pageSize=e,this.queryModel()},handleCurrentChange:function(e){this.currentPage=e,this.queryModel()},dataFormat:function(e,a){if("brno"==a.property)return e[a.property]+"-"+this.brnoMap[e[a.property]]}}},p={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"customer-buss-form-manage",attrs:{"element-loading-text":"加载中。。。"}},[t("div",[t("aui-card",{staticClass:"type-info-box-card"},[t("aui-form",{ref:"queryForm",attrs:{model:e.queryForm,rules:e.rules,size:"mini","label-position":"top"}},[t("aui-row",{attrs:{gutter:10}},[t("aui-col",{attrs:{lg:4,md:6}},[t("aui-form-item",{attrs:{label:"机构号",prop:"branchNum"}},[t("select-tree",{staticStyle:{width:"170px"},attrs:{"single-check":!0,props:{id:"orgno",label:"cname",children:"children"},"tree-data":e.brnoList,placeholder:"请选择机构"},model:{value:e.queryForm.branchNum,callback:function(a){e.$set(e.queryForm,"branchNum",a)},expression:"queryForm.branchNum"}})],1)],1),e._v(" "),t("aui-col",{attrs:{md:6,lg:4}},[t("aui-form-item",{attrs:{label:"起始日期",prop:"sTime"}},[t("aui-date-picker",{attrs:{"value-format":"yyyyMMdd",type:"date",placeholder:"选择日期",clearable:!1},on:{change:e.dateChange},model:{value:e.queryForm.sTime,callback:function(a){e.$set(e.queryForm,"sTime",a)},expression:"queryForm.sTime"}})],1)],1),e._v(" "),t("aui-col",{attrs:{md:6,lg:4}},[t("aui-form-item",{staticClass:"typeInfo-aui-form-item",attrs:{label:"截止日期",prop:"eTime"}},[t("aui-date-picker",{attrs:{"value-format":"yyyyMMdd",type:"date",placeholder:"选择日期",clearable:!1},on:{change:e.dateChange},model:{value:e.queryForm.eTime,callback:function(a){e.$set(e.queryForm,"eTime",a)},expression:"queryForm.eTime"}})],1)],1)],1),e._v(" "),t("aui-row",{attrs:{gutter:10}},[t("aui-col",{attrs:{lg:4,md:6}},[t("aui-form-item",{attrs:{label:"证件类型",prop:"cardType"}},[t("aui-select",{attrs:{filterable:"",placeholder:"请选择证件类型"},model:{value:e.queryForm.cardType,callback:function(a){e.$set(e.queryForm,"cardType",a)},expression:"queryForm.cardType"}},e._l(e.cardTypeList,function(e){return t("aui-option",{key:e.DataKeyVal,attrs:{label:e.DataKeyVal+"-"+e.Meaning,value:e.DataKeyVal,disabled:e.disabled}})}))],1)],1),e._v(" "),t("aui-col",{attrs:{lg:4,md:6}},[t("aui-form-item",{attrs:{label:"证件号码",prop:"cardID"}},[t("aui-input",{attrs:{placeholder:"请输入证件号码"},model:{value:e.queryForm.cardID,callback:function(a){e.$set(e.queryForm,"cardID",a)},expression:"queryForm.cardID"}})],1)],1),e._v(" "),t("aui-col",{attrs:{lg:4,md:6}},[t("aui-form-item",{attrs:{label:"客户姓名",prop:"custNm"}},[t("aui-input",{attrs:{placeholder:"请输入客户姓名"},model:{value:e.queryForm.custNm,callback:function(a){e.$set(e.queryForm,"custNm",a)},expression:"queryForm.custNm"}})],1)],1),e._v(" "),t("aui-col",{staticClass:"searchBtnMarginTop",attrs:{md:3,lg:2}},[t("aui-button",{attrs:{type:"primary",size:"mini",icon:"aui-icon-search"},on:{click:e.queryModel}},[e._v("查询")])],1),e._v(" "),t("aui-col",{staticClass:"searchBtnMarginTop",attrs:{md:3,lg:2}},[e.btnPermission("Button_RunRateRep_Export")?t("aui-button",{staticClass:"b-button",attrs:{type:"primary",size:"mini",icon:"aui-icon-download"},on:{click:e.getExcel}},[e._v("导出")]):e._e()],1)],1)],1)],1),e._v(" "),t("aui-card",{staticClass:"type-info-bottom"},[t("aui-table",{ref:"tableData",staticClass:"tableMarginTop",attrs:{data:e.tableData,"header-row-class-name":"tableHeaderClass",border:""}},[t("aui-table-column",{attrs:{prop:"brno",label:"机构号",formatter:e.dataFormat}}),e._v(" "),t("aui-table-column",{attrs:{prop:"card_tp",label:"证件类型"}}),e._v(" "),t("aui-table-column",{attrs:{prop:"card_nm",label:"证件号码"}}),e._v(" "),t("aui-table-column",{attrs:{prop:"cust_nm",label:"客户姓名"}}),e._v(" "),t("aui-table-column",{attrs:{prop:"limit_tp",label:"爽约限制业务类型"}}),e._v(" "),t("aui-table-column",{attrs:{prop:"eff_dt",label:"爽约限制生效日期"}}),e._v(" "),t("aui-table-column",{attrs:{prop:"invalid_dt",label:"爽约限制失效日期"}})],1),e._v(" "),t("div",{staticClass:"box"},[t("aui-pagination",{attrs:{background:"","current-page":e.currentPage,"page-size":e.pageSize,layout:"total, prev, pager, next, jumper",total:e.tableTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(a){e.currentPage=a}}})],1)],1)],1)])},staticRenderFns:[]};var h=t("/Xao")(d,p,!1,function(e){t("YUJi")},null,null);a.default=h.exports}});