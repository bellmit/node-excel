webpackJsonp([73],{"Qe/A":function(t,e,i){var a=i("umyH");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);i("8bSs")("ef265468",a,!0)},hQhX:function(t,e,i){var a=i("nDvd");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);i("8bSs")("2fb75cac",a,!0)},nDvd:function(t,e,i){(t.exports=i("BkJT")(!1)).push([t.i,"",""])},sgVF:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("0oES"),n=i("tzsN"),r=i("fCv1"),o=i("AA3o"),s=i.n(o),l=function t(){s()(this,t),this.data={Brno:"",OperType:"A",TplName:"",DefaultFlag:"",TplStyleTheme:""},this.CommCode="CQParaManage",this.SceneCode="SmlTictPlCfgMnt",this.TransServiceCode="mg-afaservices-cq/tickConfigureManage"},u=function t(){s()(this,t),this.data={Brno:"",OperType:"M",TplName:"",DefaultFlag:"",TplStyleTheme:"",TicketTplNo:""},this.CommCode="CQParaManage",this.SceneCode="SmlTictPlCfgMnt",this.TransServiceCode="mg-afaservices-cq/tickConfigureManage"},c={components:{selectTree:n.a},props:{option:Object},data:function(){return{showDetail:!1,loading:!1,text:"<TEXT:ALIGN-CENTER><FONT:SIZE-LARGE;BOLD-ON>四 川 农 信<CTRL:CRLF><TEXT:ALIGN-CENTER><FONT:SIZE-LARGE;BOLD-ON>欢迎您<CTRL:CRLF><TEXT:ALIGN-LEFT><FONT:SIZE-NORMAL>--------------------------------------<CTRL:CRLF><TEXT:ALIGN-LEFT><FONT:SIZE-NORMAL;BOLD-OFF>您的排队号为：<FONT:SIZE-LARGE;BOLD-OFF>@排队号@<CTRL:CRLF><TEXT:ALIGN-LEFT><FONT:SIZE-NORMAL>您的排队号校验码是：<FONT:SIZE-LARGE>@排队号校验码@<CTRL:CRLF><TEXT:ALIGN-LEFT><FONT:SIZE-NORMAL>您要办理的业务类型是：<FONT:SIZE-LARGE>@业务名称@<CTRL:CRLF><FONT:SIZE-NORMAL>当前有<FONT:SIZE-LARGE>@等候人数@<FONT:SIZE-NORMAL>人在排队等候，请您耐心等待...<CTRL:CRLF><TEXT:ALIGN-LEFT><FONT:SIZE-NORMAL>-----------------------------------------<CTRL:CRLF><TEXT:ALIGN-LEFT><FONT:SIZE-NORMAL>温馨提示：1.过号后请重新取号<CTRL:CRLF>@时间@",explain:[{instructions:"FONT",instruction:"BOLD-ON",explain:"打开粗体模式"},{instructions:"",instruction:"BOLD-OFF",explain:"关闭粗体模式"},{instructions:"",instruction:"SLANT-ON",explain:"打开斜体模式"},{instructions:"",instruction:"SLANT-OFF",explain:"关闭斜体模式"},{instructions:"",instruction:"SIZE-NORMAL",explain:"正常大小字体"},{instructions:"",instruction:"SIZE-LARGE",explain:"大字体"},{instructions:"",instruction:"SIZE-SMALL",explain:"小字体"},{instructions:"TEXT",instruction:"ALIGN-LEFT",explain:"左对齐"},{instructions:"",instruction:"ALIGN-CENTER",explain:"居中对齐"},{instructions:"",instruction:"ALIGN-RIGHT",explain:"右对齐"},{instructions:"",instruction:"AUTOWARP-ON",explain:"打开自动换行模式"},{instructions:"",instruction:"AUTOWARP-OFF",explain:"关闭自动换行模式"},{instructions:"CTRL",instruction:"CRLF",explain:"回车换行"},{instructions:"",instruction:"LT",explain:"打印一个小于号"},{instructions:"",instruction:"GT",explain:"打印一个大于号"},{instructions:"",instruction:"LOGO",explain:"打印LOGO"},{instructions:"",instruction:"INIT",explain:"初始化，清空所有模式"},{instructions:"BARCODE",instruction:"ON",explain:"打开条码模式"},{instructions:"",instruction:"OFF",explain:"关闭条码模式"},{instructions:"QRCODE",instruction:"ON",explain:"打开二维码模式"},{instructions:"",instruction:"OFF",explain:"关闭二维码模式"},{instructions:"",instruction:"LEFT",explain:"左对齐"},{instructions:"",instruction:"CENTER",explain:"居中"},{instructions:"",instruction:"RIGHT",explain:"右对齐"},{instructions:"IMAGE",instruction:"ON",explain:"打开图片路径"},{instructions:"",instruction:"OFF",explain:"关闭图片路径"},{instructions:"",instruction:"LEFT",explain:"左对齐"},{instructions:"",instruction:"CENTER",explain:"居中"},{instructions:"",instruction:"RIGHT",explain:"右对齐"}],appId:[],defaultFlagList:[{value:"1",label:"非默认"},{value:"0",label:"默认模板"}],form:{templateId:"",templateName:"",defaultFlag:"",brno:[],styleTheme:""},rules:{brno:[{type:"array",required:!0,message:"请选择机构编号",trigger:"change"}],templateName:[{required:!0,message:"请输入模板名称",trigger:"blur"},{validator:r.l,trigger:"blur"},{validator:Object(r.h)(30),trigger:"blur"}],defaultFlag:[{required:!0,message:"请选择是否默认标志",trigger:"change"}],styleTheme:[{required:!0,message:"请输入模板样式主题",trigger:"blur"},{validator:Object(r.h)(1024),trigger:"blur"}]}}},created:function(){},methods:{openUpdate:function(){var t=this;this.$nextTick(function(){"2"==t.option.mark?t.setData():t.$refs.form&&t.$refs.form.clearValidate()})},setData:function(){this.form.brno.push(this.option.currentRow.Brno),this.form.templateName=this.option.currentRow.TplName,this.form.styleTheme=this.option.currentRow.TplStyleTheme,this.form.defaultFlag=this.option.currentRow.DefaultFlag,this.form.templateId=this.option.currentRow.TicketTplNo},closeUpdete:function(){this.$refs.form.resetFields(),this.$refs.form1.resetFields(),this.$refs.form1.clearValidate()},ItemUpdate:function(){var t=this;this.$refs.form.validate(function(e){if(!e)return t.$aui.message.show({type:"warning",message:"请输入合法的数据！"}),!1;t.$refs.form1.validate(function(e){if(!e)return t.$aui.message.show({type:"warning",message:"请输入合法的数据！"}),!1;t.loading=!0;var i="1"==t.option.mark?new l:new u;i.data.Brno=t.form.brno[0],i.data.TicketTplNo=t.form.templateId,i.data.TplName=t.form.templateName,i.data.TplStyleTheme=t.form.styleTheme,i.data.DefaultFlag=t.form.defaultFlag,Object(a.a)(i).then(function(e){t.loading=!1;var i="1"==t.option.mark?"新增":"修改";t.$aui.message.show({type:"success",message:""+i+e.SYS_HEAD.ReturnMessage+"!"}),t.option.isShow=!1,t.$emit("refreshTable")}).catch(function(e){t.$aui.message.show({type:"warning",message:e.SYS_HEAD.ReturnMessage+"!"}),t.loading=!1})})})}}},p={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("aui-dialog",{attrs:{title:t.option.title,visible:t.option.isShow,width:"800px","close-on-click-modal":!1},on:{"update:visible":function(e){t.$set(t.option,"isShow",e)},show:t.openUpdate,hide:t.closeUpdete}},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[i("aui-card",[i("aui-form",{ref:"form",attrs:{model:t.form,size:"mini",rules:t.rules,"label-width":"140px","label-position":"right"}},[i("aui-row",{attrs:{gutter:40}},[i("aui-col",{attrs:{span:12}},[i("aui-form-item",{attrs:{label:"机构编号:",prop:"brno"}},[i("select-tree",{staticStyle:{width:"170px"},attrs:{"single-check":!0,props:{id:"orgno",label:"cname",children:"children"},"tree-data":t.option.branchNum,placeholder:"请选择机构",disabled:t.option.isDisabled},model:{value:t.form.brno,callback:function(e){t.$set(t.form,"brno",e)},expression:"form.brno"}})],1)],1),t._v(" "),i("aui-col",{attrs:{span:12}},[t.option.isDisabled?i("aui-form-item",{attrs:{label:"小票模版ID:",prop:"templateId"}},[i("aui-input",{attrs:{disabled:!0},model:{value:t.form.templateId,callback:function(e){t.$set(t.form,"templateId",e)},expression:"form.templateId"}})],1):t._e()],1)],1),t._v(" "),i("aui-row",{attrs:{gutter:40}},[i("aui-col",{attrs:{span:12}},[i("aui-form-item",{attrs:{label:"模版名称:",prop:"templateName"}},[i("aui-input",{attrs:{placeholder:"请输入模版名称"},model:{value:t.form.templateName,callback:function(e){t.$set(t.form,"templateName",e)},expression:"form.templateName"}})],1)],1),t._v(" "),i("aui-col",{attrs:{span:12}},[i("aui-form-item",{attrs:{label:"是否默认标志:",prop:"defaultFlag"}},[i("aui-select",{attrs:{placeholder:"请选择是否默认标志"},model:{value:t.form.defaultFlag,callback:function(e){t.$set(t.form,"defaultFlag",e)},expression:"form.defaultFlag"}},t._l(t.defaultFlagList,function(t){return i("aui-option",{key:t.value,attrs:{label:t.label,value:t.value,disabled:t.disabled}})}))],1)],1)],1)],1),t._v(" "),i("aui-form",{ref:"form1",attrs:{model:t.form,size:"mini",rules:t.rules,"label-width":"140px","label-position":"top"}},[i("aui-row",{attrs:{gutter:40}},[i("aui-col",{attrs:{span:24}},[i("aui-form-item",{attrs:{label:"模板样式主题:",prop:"styleTheme"}},[i("aui-popover",{attrs:{placement:"top-start",title:"指令说明",width:"400",trigger:"click"}},[i("div",{staticStyle:{"min-width":"150px","min-height":"200px","max-height":"300px",overflow:"auto"}},[i("aui-table",{attrs:{data:t.explain,width:"100%"}},[i("aui-table-column",{attrs:{width:"100",property:"instructions",label:"指令集"}}),t._v(" "),i("aui-table-column",{attrs:{width:"100",property:"instruction",label:"指令"}}),t._v(" "),i("aui-table-column",{attrs:{width:"150",property:"explain",label:"说明"}})],1)],1),t._v(" "),i("aui-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[t._v("指令说明")])],1),t._v(" "),i("aui-popover",{attrs:{placement:"top-start",title:"小票例子",width:"800",trigger:"click",content:t.text}},[i("aui-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[t._v("例子")])],1),t._v(" "),i("aui-input",{attrs:{type:"textarea",rows:15,placeholder:"请输入模板样式"},model:{value:t.form.styleTheme,callback:function(e){t.$set(t.form,"styleTheme",e)},expression:"form.styleTheme"}})],1)],1)],1)],1)],1),t._v(" "),i("aui-row",{staticStyle:{margin:"20px 0","text-align":"center"}},[i("aui-button",{attrs:{size:"mini"},on:{click:function(e){t.option.isShow=!1}}},[t._v("返回")]),t._v(" "),i("aui-button",{attrs:{type:"primary",size:"mini"},on:{click:t.ItemUpdate}},[t._v("确定")])],1)],1)])],1)},staticRenderFns:[]};var m=i("/Xao")(c,p,!1,function(t){i("hQhX")},null,null).exports,d=i("0VOF"),g=i("syAl"),h=function t(){s()(this,t),this.data={Brno:"",OperType:"D",TicketTplNo:""},this.CommCode="CQParaManage",this.SceneCode="SmlTictPlCfgMnt",this.TransServiceCode="mg-afaservices-cq/tickConfigureManage"},f=function t(){s()(this,t),this.data={Brno:"",BusiOper:"Q",CurtPage:"",PageSize:"",StartRows:"",QueryType:"",TicketTplNo:""},this.CommCode="CQParaManage",this.SceneCode="SmlTictPlCfgQuy",this.TransServiceCode="mg-afaservices-cq/tickConfigureQuery"},T=i("pADA"),b={name:"ticketConfigure",components:{selectTree:n.a},data:function(){return{defaultFlagMap:{0:"默认模板",1:"非默认"},currentRow:[],QueryForm:{branchNum:[],templateId:""},branchNum:[],brnoList:[],stateMap:{},transferMap:{},total:void 0,busiTypeList:[],brnoMap:{},permission:{},loading:!1,isDisabledDel:!1,dialogList:{dialogAdd:m},dialogOptions:{isShow:!1},currentPage:1,pageSize:void 0,rules:{branchNum:[{required:!0,message:"请选择机构编号",trigger:"change"}],templateId:[{validator:Object(r.h)(15),trigger:"blur"}]}}},created:function(){this.pageSize=g.a.get("PageSize"),this.queryBranchNum()},watch:{QueryForm:{handler:function(t,e){this.currentPage=1},deep:!0}},computed:{},methods:{queryBranchNum:function(){var t=this;this.loading=!0;var e=new d.a;e.data.orgno=this.$store.getters.BranchNum,Object(a.a)(e).then(function(e){t.loading=!1,t.branchNum=e.RspInfo.Result||[],t.brnoMap=e.RspInfo.orgMap||{},t.permission=T.a.objArray2Hash(t.branchNum,"orgno"),t.brnoList=T.a.formatTreeData(t.branchNum,"orgno","superno"),t.QueryForm.branchNum.push(t.brnoList[0].orgno),t.query()}).catch(function(e){t.loading=!1,t.$aui.message.show({type:"warning",message:e.SYS_HEAD.ReturnMessage}),console.error("查询错误",e)})},dataFormat:function(t,e){return"Brno"==e.property?t[e.property]+"-"+this.brnoMap[t[e.property]]:"DefaultFlag"==e.property?this.defaultFlagMap[t[e.property]]:void 0},clickAdd:function(){this.dialogOptions.isShow=!0,this.dialogOptions.title="新增小票模板",this.dialogOptions.mark="1",this.dialogOptions.isDisabled=!1,this.dialogOptions.branchNum=this.brnoList},clickUpdate:function(){this.dialogOptions.isShow=!0,this.dialogOptions.title="修改小票模板",this.dialogOptions.mark="2",this.dialogOptions.isDisabled=!0,this.dialogOptions.currentRow=this.currentRow,this.dialogOptions.branchNum=this.brnoList},checkPermission:function(t){this.permission[this.currentRow.Brno]?t?this.clickUpdate():this.delBut():this.$aui.message.show({type:"warning",message:"权限不足,无法修改！"})},resetForm:function(){this.busiTypeList=[],this.currentPage=1,this.$refs.QueryForm.resetFields()},delBut:function(){var t=this;this.$aui.confirm.show("此操作将永久删除该小票模板, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.orgQueueDel()}).catch(function(){t.$aui.message.show({type:"info",message:"已取消删除"})})},orgQueueDel:function(){var t=this;this.loading=!0;var e=new h;e.data.Brno=this.currentRow.Brno,e.data.TicketTplNo=this.currentRow.TicketTplNo,Object(a.a)(e).then(function(e){t.loading=!1,t.$aui.message.show({type:"success",message:"小票模板删除成功！"}),t.currentPage=1,t.query()}).catch(function(e){t.loading=!1,console.log(e),t.$aui.message.show({type:"warning",message:e.SYS_HEAD.ReturnMessage})})},query:function(){var t=this;this.$refs.QueryForm.validate(function(e){if(e){t.loading=!0;var i=new f;i.data.Brno=t.QueryForm.branchNum[0],i.data.TicketTplNo=t.QueryForm.templateId,""===t.QueryForm.templateId?i.data.QueryType="1":i.data.QueryType="2",i.data.PageSize=t.pageSize+"",i.data.CurtPage=t.currentPage+"",i.data.StartRows=(t.currentPage-1)*t.pageSize+"",Object(a.a)(i).then(function(e){t.loading=!1,t.busiTypeList=e.RspInfo.data||[],t.total=e.RspInfo.TotalRcrdNum||0,t.total&&0!==t.total||t.$aui.message.show({type:"warning",message:"没有满足条件得记录!"})}).catch(function(e){t.busiTypeList=[],t.total=0,t.loading=!1,t.$aui.message.show({type:"warning",message:"请求失败，错误码:"+e.SYS_HEAD.ReturnCode+"，错误信息："+e.SYS_HEAD.ReturnMessage})})}})},handleCurrentChange:function(t){this.currentPage=t,this.query()},selectList:function(t){1==t.length?(this.isDisabledDel=!0,this.currentRow=t[0]):t.length>1?this.$refs.busiTypeList.toggleRowSelection(t[0]):this.isDisabledDel=!1}}},y={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{"element-loading-text":"加载中。。。"}},[i("aui-card",[i("aui-form",{ref:"QueryForm",attrs:{model:t.QueryForm,rules:t.rules,size:"mini","label-position":"top"}},[i("aui-row",{attrs:{gutter:10}},[i("aui-col",{attrs:{lg:4,md:6}},[i("aui-form-item",{attrs:{label:"机构编号",prop:"branchNum"}},[i("select-tree",{staticStyle:{width:"170px"},attrs:{"single-check":!0,props:{id:"orgno",label:"cname",children:"children"},"tree-data":t.brnoList,placeholder:"请选择机构"},model:{value:t.QueryForm.branchNum,callback:function(e){t.$set(t.QueryForm,"branchNum",e)},expression:"QueryForm.branchNum"}})],1)],1),t._v(" "),i("aui-col",{attrs:{lg:4,md:6}},[i("aui-form-item",{attrs:{label:"小票模版ID",prop:"templateId"}},[i("aui-input",{attrs:{placeholder:"小票模版ID"},model:{value:t.QueryForm.templateId,callback:function(e){t.$set(t.QueryForm,"templateId",e)},expression:"QueryForm.templateId"}})],1)],1),t._v(" "),i("aui-col",{staticClass:"searchBtnMarginTop",attrs:{lg:2,md:3}},[i("aui-button",{attrs:{type:"primary",size:"mini",icon:"aui-icon-search"},on:{click:t.query}},[t._v("查询")])],1),t._v(" "),i("aui-col",{staticClass:"searchBtnMarginTop",attrs:{lg:2,md:3}},[i("aui-button",{attrs:{type:"warning",size:"mini",icon:"aui-icon-refresh"},on:{click:function(e){t.resetForm("QueryForm")}}},[t._v("重置")])],1)],1)],1)],1),t._v(" "),i("aui-card",{staticStyle:{"margin-top":"10px"}},[i("aui-row",[i("aui-col",{attrs:{lg:2,md:3}},[t.btnPermission("Button_Menu_Add")?i("aui-button",{attrs:{type:"primary",icon:"aui-icon-plus",disabled:t.isDisabledDel,size:"mini"},on:{click:t.clickAdd}},[t._v("新增")]):t._e()],1),t._v(" "),i("aui-col",{attrs:{lg:2,md:3}},[t.btnPermission("Button_Menu_Add")?i("aui-button",{attrs:{type:"primary",icon:"aui-icon-edit",disabled:!t.isDisabledDel,size:"mini"},on:{click:function(e){t.checkPermission("1")}}},[t._v("修改")]):t._e()],1),t._v(" "),i("aui-col",{attrs:{lg:2,md:3}},[t.btnPermission("Button_Menu_Edit")?i("aui-button",{attrs:{type:"danger",icon:"aui-icon-delete",disabled:!t.isDisabledDel,size:"mini"},on:{click:function(e){t.checkPermission()}}},[t._v("删除")]):t._e()],1)],1),t._v(" "),i("aui-table",{ref:"busiTypeList",staticClass:"tableMarginTop",staticStyle:{"min-height":"390px"},attrs:{data:t.busiTypeList,border:"","header-row-class-name":"tableHeaderClass"},on:{"selection-change":t.selectList}},[i("aui-table-column",{attrs:{type:"selection",width:"40px"}}),t._v(" "),i("aui-table-column",{attrs:{prop:"Brno",formatter:t.dataFormat,label:"机构编号","min-width":"247px"}}),t._v(" "),i("aui-table-column",{attrs:{prop:"TicketTplNo",label:"小票模板ID","min-width":"107px"}}),t._v(" "),i("aui-table-column",{attrs:{prop:"TplName",label:"模板名称","min-width":"137px"}}),t._v(" "),i("aui-table-column",{attrs:{prop:"DefaultFlag",formatter:t.dataFormat,label:"是否默认标志","min-width":"107px"}})],1),t._v(" "),i("div",{staticStyle:{"text-align":"right","margin-top":"10px"}},[i("aui-pagination",{attrs:{background:"","current-page":t.currentPage,"page-size":10,layout:"total, prev, pager, next, jumper",total:t.total},on:{"current-change":t.handleCurrentChange}})],1)],1)],1),t._v(" "),i("keep-alive",[i(t.dialogList.dialogAdd,{tag:"component",attrs:{option:t.dialogOptions},on:{refreshTable:t.query}})],1)],1)},staticRenderFns:[]};var v=i("/Xao")(b,y,!1,function(t){i("Qe/A")},"data-v-0f686aa4",null);e.default=v.exports},umyH:function(t,e,i){(t.exports=i("BkJT")(!1)).push([t.i,"",""])}});