webpackJsonp([72],{"/GQA":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("0oES"),o=a("pADA"),r=a("fCv1"),s=a("syAl"),l=a("AA3o"),n=a.n(l),u=function t(){n()(this,t),this.data={Brno:"",DefaultFlag:"",EnaeStatus:"",RecallLmtTime:"",CallNextLmtTime:"",DisuseTime:"",NotifyCust:"",TranCode:"SOFTCALL",OperTp:"A"},this.CommCode="CQParaManage",this.SceneCode="SoftCallParmCfg",this.TransServiceCode="mg-afaservices-cq/softCollManage"},c=function t(){n()(this,t),this.data={Brno:"",SoftcallID:"",DefaultFlag:"",EnaeStatus:"",RecallLmtTime:"",CallNextLmtTime:"",DisuseTime:"",NotifyCust:"",TranCode:"SOFTCALL",OperTp:"M"},this.CommCode="CQParaManage",this.SceneCode="SoftCallParmCfg",this.TransServiceCode="mg-afaservices-cq/softCollManage"},m={props:{option:Object},data:function(){return{loading:!1,appId:[],enaeStatusList:[{value:"1",label:"启用"},{value:"0",label:"不启用"}],defaultFlagList:[],form:{brno:"",softCallID:"",defaultFlag:"0",enaeStatus:"1",recallLmtTime:"",callNextLmtTime:"",notifyCust:""},rules:{brno:[{required:!0,message:"请选择机构编号",trigger:"change"}],defaultFlag:[{required:!0,message:"请选择是否默认标志",trigger:"change"}],enaeStatus:[{required:!0,message:"请选择软叫号启用标志",trigger:"change"}],recallLmtTime:[{required:!0,message:"请输入重呼间隔时间",trigger:"blur"},{validator:r.f,trigger:"blur"}],callNextLmtTime:[{required:!0,message:"请输入顺呼间隔时间",trigger:"blur"},{validator:r.f,trigger:"blur"}]}}},created:function(){this.defaultFlagList=o.a.objToArray(s.a.get("isDefault"))},methods:{openUpdate:function(){var t=this;this.$nextTick(function(){"2"==t.option.mark?t.setData():t.$refs.form&&(t.$refs.form.clearValidate(),t.$refs.form.resetFields())})},setData:function(){this.form.brno=this.option.currentRow.Brno,this.form.softCallID=this.option.currentRow.SoftcallID,this.form.defaultFlag=this.option.currentRow.DefaultFlag,this.form.enaeStatus=this.option.currentRow.EnaeStatus,this.form.recallLmtTime=this.option.currentRow.RecallLmtTime,this.form.callNextLmtTime=this.option.currentRow.CallNextLmtTime,this.form.notifyCust=this.option.currentRow.NotifyCust},closeUpdete:function(){this.$refs.form.resetFields(),this.$refs.form.clearValidate()},ItemUpdate:function(){var t=this;this.$refs.form.validate(function(e){if(!e)return t.$aui.message.show({type:"warning",message:"请输入合法的数据！"}),!1;t.loading=!0;var a="1"==t.option.mark?new u:new c;a.data.Brno=t.form.brno,a.data.SoftcallID=t.form.softCallID,a.data.DefaultFlag=t.form.defaultFlag,a.data.EnaeStatus=t.form.enaeStatus,a.data.RecallLmtTime=t.form.recallLmtTime,a.data.CallNextLmtTime=t.form.callNextLmtTime,a.data.DisuseTime="30",a.data.NotifyCust=t.form.notifyCust,console.log(a),Object(i.a)(a).then(function(e){t.$emit("refreshTable"),t.option.isShow=!1;var a="1"==t.option.mark?"创建":"修改";t.$aui.message.show({type:"success",message:a+"成功!"}),t.loading=!1}).catch(function(e){t.$aui.message.show({type:"error",message:e.SYS_HEAD.ReturnMessage+"!"}),t.loading=!1})})}}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("aui-dialog",{attrs:{title:t.option.title,visible:t.option.isShow,width:"800px","close-on-click-modal":!1},on:{"update:visible":function(e){t.$set(t.option,"isShow",e)},show:t.openUpdate,hide:t.closeUpdete}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[a("aui-card",[a("aui-form",{ref:"form",attrs:{model:t.form,size:"mini",rules:t.rules,"label-width":"140px","label-position":"right"}},[a("aui-row",{attrs:{gutter:40}},[a("aui-col",{attrs:{span:12}},[a("aui-form-item",{attrs:{label:"机构编号:",prop:"brno"}},[a("aui-select",{attrs:{disabled:t.option.isDisabled,filterable:"",placeholder:"请选择机构编号"},model:{value:t.form.brno,callback:function(e){t.$set(t.form,"brno",e)},expression:"form.brno"}},t._l(t.option.branchNum,function(t){return a("aui-option",{key:t.orgno,attrs:{label:t.cname,value:t.orgno,disabled:t.disabled}})}))],1)],1),t._v(" "),a("aui-col",{attrs:{span:12}},[t.option.isDisabled?a("aui-form-item",{attrs:{label:"队列类型ID:",prop:"softCallID"}},[a("aui-input",{attrs:{disabled:!0},model:{value:t.form.softCallID,callback:function(e){t.$set(t.form,"softCallID",e)},expression:"form.softCallID"}})],1):t._e()],1),t._v(" "),a("aui-col",{attrs:{span:12}},[a("aui-form-item",{attrs:{label:"是否默认标志:",prop:"defaultFlag"}},[a("aui-select",{attrs:{placeholder:"请选择是否默认标志"},model:{value:t.form.defaultFlag,callback:function(e){t.$set(t.form,"defaultFlag",e)},expression:"form.defaultFlag"}},t._l(t.defaultFlagList,function(t){return a("aui-option",{key:t.value,attrs:{label:t.label,value:t.value,disabled:t.disabled}})}))],1)],1),t._v(" "),a("aui-col",{attrs:{span:12}},[a("aui-form-item",{attrs:{label:"软叫号启用状态:",prop:"enaeStatus"}},[a("aui-select",{attrs:{placeholder:"请选择启用状态"},model:{value:t.form.enaeStatus,callback:function(e){t.$set(t.form,"enaeStatus",e)},expression:"form.enaeStatus"}},t._l(t.enaeStatusList,function(t){return a("aui-option",{key:t.value,attrs:{label:t.label,value:t.value,disabled:t.disabled}})}))],1)],1),t._v(" "),a("aui-col",{attrs:{span:12}},[a("aui-form-item",{attrs:{label:"重呼间隔时间|秒:",prop:"recallLmtTime"}},[a("aui-input-number",{attrs:{size:"small",min:3,max:999,label:"描述文字"},model:{value:t.form.recallLmtTime,callback:function(e){t.$set(t.form,"recallLmtTime",t._n(e))},expression:"form.recallLmtTime"}})],1)],1),t._v(" "),a("aui-col",{attrs:{span:12}},[a("aui-form-item",{attrs:{label:"顺呼间隔时间|秒",prop:"callNextLmtTime"}},[a("aui-input-number",{attrs:{size:"small",min:3,max:999,label:"描述文字"},model:{value:t.form.callNextLmtTime,callback:function(e){t.$set(t.form,"callNextLmtTime",e)},expression:"form.callNextLmtTime"}})],1)],1)],1)],1)],1),t._v(" "),a("aui-row",{staticStyle:{margin:"20px 0","text-align":"right"}},[a("aui-button",{attrs:{size:"mini"},on:{click:function(e){t.option.isShow=!1}}},[t._v("返回")]),t._v(" "),a("aui-button",{attrs:{type:"primary",size:"mini"},on:{click:t.ItemUpdate}},[t._v("确定")])],1)],1)])],1)},staticRenderFns:[]};var f=a("/Xao")(m,d,!1,function(t){a("OBgm")},null,null).exports,p=a("0VOF"),g=function t(){n()(this,t),this.data={SoftcallID:"",OperTp:"D",TranCode:"SOFTCALL"},this.CommCode="CQParaManage",this.SceneCode="SoftCallParmCfg",this.TransServiceCode="mg-afaservices-cq/softCollManage"},h=function t(){n()(this,t),this.data={Brno:"",SoftcallID:"",BusiOper:"Q",CurtPage:"",PageSize:"",StartRows:""},this.BusiDataKey="CQMS_SOFTCALL_CFG_Brno",this.TransServiceCode="ib-dbcomm/dbComm"},b={name:"softCallManage",components:{selectTree:a("tzsN").a},data:function(){return{currentRow:[],QueryForm:{branchNum:[],softCallId:""},branchNum:[],brnoList:[],isDefaultMap:{},enaeStatusMap:{0:"不启用",1:"启用"},total:void 0,busiTypeList:[],brnoMap:{},permission:{},loading:!1,isDisabledDel:!1,dialogList:{dialogAdd:f},dialogOptions:{isShow:!1},currentPage:1,pageSize:void 0,rules:{branchNum:[{required:!0,message:"请选择机构编号",trigger:"change"}],softCallId:[{validator:Object(r.h)(15),trigger:"blur"}]}}},created:function(){this.pageSize=s.a.get("PageSize"),this.isDefaultMap=s.a.get("isDefault"),this.queryBranchNum()},watch:{"QueryForm.branchNum":function(t){this.$refs.QueryForm.clearValidate()}},computed:{},methods:{queryBranchNum:function(){var t=this;this.loading=!0;var e=new p.a;e.data.orgno=this.$store.getters.BranchNum,Object(i.a)(e).then(function(e){t.loading=!1,t.branchNum=e.RspInfo.Result||[],t.brnoMap=e.RspInfo.orgMap||{},t.permission=o.a.objArray2Hash(t.branchNum,"orgno"),t.brnoList=o.a.formatTreeData(t.branchNum,"orgno","superno"),t.QueryForm.branchNum.push(t.brnoList[0].orgno)}).catch(function(e){t.loading=!1,console.error("查询错误",e),t.$aui.message.show({type:"warning",message:e.SYS_HEAD.ReturnMessage})})},dataFormat:function(t,e){return"Brno"==e.property?t[e.property]+"-"+t.BrName:"DefaultFlag"==e.property?this.isDefaultMap[t[e.property]]:"EnaeStatus"==e.property?this.enaeStatusMap[t[e.property]]:void 0},clickAdd:function(){this.dialogOptions.isShow=!0,this.dialogOptions.title="新增软叫号配置",this.dialogOptions.mark="1",this.dialogOptions.isDisabled=!1,this.dialogOptions.branchNum=this.branchNum},clickUpdate:function(){this.dialogOptions.isShow=!0,this.dialogOptions.title="修改软叫号配置",this.dialogOptions.mark="2",this.dialogOptions.isDisabled=!0,this.dialogOptions.currentRow=this.currentRow,this.dialogOptions.branchNum=this.branchNum},checkPermission:function(t){this.permission[this.currentRow.Brno]?t?this.clickUpdate():this.delBut():this.$aui.message.show({type:"warning",message:"权限不足,无法修改！"})},resetForm:function(){this.busiTypeList=[],this.total=0,this.$refs.QueryForm.resetFields()},delBut:function(){var t=this;this.$aui.confirm.show("此操作将永久删除该软叫号配置, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.softCallDel()}).catch(function(){t.$aui.message.show({type:"info",message:"已取消删除"})})},softCallDel:function(){var t=this;this.loading=!0;var e=new g;e.data.SoftcallID=this.currentRow.SoftcallID,Object(i.a)(e).then(function(e){t.loading=!1,t.$aui.message.show({type:"success",message:"软叫号配置删除成功！"}),t.query()}).catch(function(e){t.$aui.message.show({type:"warning",message:e.SYS_HEAD.ReturnMessage}),t.loading=!1,console.log(e)})},query:function(){var t=this;this.$refs.QueryForm.validate(function(e){if(e){t.loading=!0;var a=new h;a.data.Brno=t.QueryForm.branchNum[0],a.data.SoftcallID=t.QueryForm.softCallId,a.data.PageSize=t.pageSize+"",a.data.CurtPage=t.currentPage+"",a.data.StartRows=(t.currentPage-1)*t.pageSize+"",""!=t.QueryForm.softCallId&&(a.BusiDataKey="CQMS_SOFTCALL_CFG_BrnoID"),Object(i.a)(a).then(function(e){t.loading=!1,t.busiTypeList=e.RspInfo.Result||[],t.total=e.RspInfo.totalNum||0,"0"===t.total&&t.$aui.message.show({type:"warning",message:"无满足条件的记录！"})}).catch(function(e){t.busiTypeList=[],t.total=0,t.loading=!1,t.$aui.message.show({type:"warning",message:"错误信息："+e.SYS_HEAD.ReturnMessage}),console.log(e)})}})},handleCurrentChange:function(t){this.currentPage=t,this.query()},selectList:function(t){1==t.length?(this.isDisabledDel=!0,this.currentRow=t[0]):t.length>1?this.$refs.busiTypeList.toggleRowSelection(t[0]):this.isDisabledDel=!1}}},v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{"element-loading-text":"加载中。。。"}},[a("aui-card",[a("aui-form",{ref:"QueryForm",attrs:{model:t.QueryForm,rules:t.rules,size:"mini","label-position":"top"}},[a("aui-row",{attrs:{gutter:10}},[a("aui-col",{attrs:{lg:4,md:6}},[a("aui-form-item",{attrs:{label:"机构编号",prop:"branchNum"}},[a("select-tree",{staticStyle:{width:"170px"},attrs:{"single-check":!0,props:{id:"orgno",label:"cname",children:"children"},"tree-data":t.brnoList,placeholder:"请选择机构"},model:{value:t.QueryForm.branchNum,callback:function(e){t.$set(t.QueryForm,"branchNum",e)},expression:"QueryForm.branchNum"}})],1)],1),t._v(" "),a("aui-col",{attrs:{lg:4,md:6}},[a("aui-form-item",{attrs:{label:"软叫号配置ID",prop:"softCallId"}},[a("aui-input",{attrs:{placeholder:"队列类型ID"},model:{value:t.QueryForm.softCallId,callback:function(e){t.$set(t.QueryForm,"softCallId",e)},expression:"QueryForm.softCallId"}})],1)],1),t._v(" "),a("aui-col",{staticClass:"searchBtnMarginTop",attrs:{lg:2,md:3}},[a("aui-button",{attrs:{type:"primary",size:"mini",icon:"aui-icon-search"},on:{click:t.query}},[t._v("查询")])],1),t._v(" "),a("aui-col",{staticClass:"searchBtnMarginTop",attrs:{lg:2,md:3}},[a("aui-button",{attrs:{type:"warning",size:"mini",icon:"aui-icon-refresh"},on:{click:function(e){t.resetForm("QueryForm")}}},[t._v("重置")])],1)],1)],1)],1),t._v(" "),a("aui-card",{staticStyle:{"margin-top":"10px"}},[a("aui-row",[a("aui-col",{attrs:{lg:2,md:3}},[t.btnPermission("Button_Menu_Add")?a("aui-button",{attrs:{type:"primary",icon:"aui-icon-plus",disabled:t.isDisabledDel,size:"mini"},on:{click:t.clickAdd}},[t._v("新增")]):t._e()],1),t._v(" "),a("aui-col",{attrs:{lg:2,md:3}},[t.btnPermission("Button_Menu_Add")?a("aui-button",{attrs:{type:"primary",icon:"aui-icon-edit",disabled:!t.isDisabledDel,size:"mini"},on:{click:function(e){t.checkPermission("1")}}},[t._v("修改")]):t._e()],1),t._v(" "),a("aui-col",{attrs:{lg:2,md:3}},[t.btnPermission("Button_Menu_Edit")?a("aui-button",{attrs:{type:"danger",icon:"aui-icon-delete",disabled:!t.isDisabledDel,size:"mini"},on:{click:function(e){t.checkPermission()}}},[t._v("删除")]):t._e()],1)],1),t._v(" "),a("aui-table",{ref:"busiTypeList",staticClass:"tableMarginTop",staticStyle:{"min-height":"390px"},attrs:{data:t.busiTypeList,border:"","header-row-class-name":"tableHeaderClass"},on:{"selection-change":t.selectList}},[a("aui-table-column",{attrs:{type:"selection",width:"40px"}}),t._v(" "),a("aui-table-column",{attrs:{prop:"Brno",formatter:t.dataFormat,label:"机构编号","min-width":"247px"}}),t._v(" "),a("aui-table-column",{attrs:{prop:"SoftcallID",label:"软叫号配置ID","min-width":"107px"}}),t._v(" "),a("aui-table-column",{attrs:{prop:"DefaultFlag",formatter:t.dataFormat,label:"是否默认标志","min-width":"107px"}}),t._v(" "),a("aui-table-column",{attrs:{prop:"EnaeStatus",formatter:t.dataFormat,label:"软叫号启用状态","min-width":"117px"}}),t._v(" "),a("aui-table-column",{attrs:{prop:"RecallLmtTime",label:"重呼间隔时间|秒","min-width":"107px"}}),t._v(" "),a("aui-table-column",{attrs:{prop:"CallNextLmtTime",label:"顺呼间隔时间|秒","min-width":"107px"}})],1),t._v(" "),a("div",{staticStyle:{"text-align":"right","margin-top":"10px"}},[a("aui-pagination",{attrs:{background:"","current-page":t.currentPage,"page-size":10,layout:"total, prev, pager, next, jumper",total:t.total},on:{"current-change":t.handleCurrentChange}})],1)],1)],1),t._v(" "),a("keep-alive",[a(t.dialogList.dialogAdd,{tag:"component",attrs:{option:t.dialogOptions},on:{refreshTable:t.query}})],1)],1)},staticRenderFns:[]};var y=a("/Xao")(b,v,!1,function(t){a("AfBQ")},"data-v-1b0f50b4",null);e.default=y.exports},AfBQ:function(t,e,a){var i=a("L+my");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("8bSs")("4193fd4c",i,!0)},GU9l:function(t,e,a){(t.exports=a("BkJT")(!1)).push([t.i,"",""])},"L+my":function(t,e,a){(t.exports=a("BkJT")(!1)).push([t.i,"",""])},OBgm:function(t,e,a){var i=a("GU9l");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("8bSs")("48a1ed96",i,!0)}});