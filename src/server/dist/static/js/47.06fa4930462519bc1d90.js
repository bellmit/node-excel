webpackJsonp([47],{"4Flk":function(e,t,i){"use strict";var a=i("AA3o"),r=i.n(a);t.a=function e(){r()(this,e),this.data={Brno:"",BusiOper:"Q",BsIDTp:"3"},this.BusiDataKey="sel_TP_BSTP_BSID",this.TransServiceCode="ib-dbcomm/dbComm"}},BATM:function(e,t,i){var a=i("wGOh");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);i("8bSs")("1be60408",a,!0)},GzTs:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("0oES"),r=i("syAl"),s=i("fCv1"),o=i("AA3o"),n=i.n(o),l=function e(){n()(this,e),this.data={StartDate:"",EndDate:"",ServeTime:"",Remark:"",Brno:"",BusiOper:"A",BsID:""},this.BusiDataKey="BusiSpeciTime_Add",this.TransServiceCode="ib-dbcomm/dbComm"},u=function e(){n()(this,e),this.data={StartDate:"",EndDate:"",ServeTime:"",Remark:"",Brno:"",BusiOper:"M",BsID:"",OperDate:"",OperTime:"",OperUserID:""},this.BusiDataKey="BusiSpeciTime_Modify",this.TransServiceCode="ib-dbcomm/dbComm"},c=function e(){n()(this,e),this.data={CurtPage:"",PageSize:"",StartRows:"",Brno:"",BusiOper:"Q",BsID:""},this.BusiDataKey="BusiSpeciTime_Query",this.TransServiceCode="ib-dbcomm/dbComm"},m={props:{option:Object},data:function(){var e=this;return{loading:!1,appId:[],form:{eTime:"",sTime:"",isQueue:"",brno:"",ServeTime:"",Remark:""},rules:{brno:[{required:!0,message:"请选择机构编号",trigger:"change"}],isQueue:[{required:!0,message:"请选择业务ID",trigger:"change"}],sTime:[{required:!0,message:"请选择开始时间",trigger:"change"}],eTime:[{required:!0,message:"请选择结束时间",trigger:"change"},{validator:function(t,i,a){""==i&&a(),i-e.form.sTime>=0?a():a(new Error("结束时间必须大于开始时间"))},trigger:"change"}],Remark:[{validator:Object(s.h)(100),trigger:"blur"}],ServeTime:[{required:!0,message:"业务服务时段不能为空",trigger:"change"},{validator:function(e,t,i){if(""!=t){var a=/^[0-1][0-9]|[2][0-3]$/,r=/^[0-5][0-9]$/;(t+"").split(";").forEach(function(e){var t=(e+"").split("-");t.length>2?i(new Error("格式错误")):2==t.length&&t[1].replace(/:/g,"")-t[0].replace(/:/g,"")<=0&&i(new Error("格式错误")),t.forEach(function(e){var t=(e+"").split(":");2==t.length&&a.test(t[0])&&r.test(t[1])||i(new Error("格式错误"))}),i()})}},trigger:"blur"},{validator:Object(s.h)(12),trigger:"blur"}]}}},created:function(){},methods:{openUpdate:function(){"2"==this.option.mark?this.setData():(this.$refs.form&&this.$refs.form.clearValidate(),this.form={eTime:"",isQueue:"",brno:"",sTime:"",ServeTime:"",Remark:""})},setData:function(){this.form.brno=this.option.currentRow.Brno,this.form.isQueue=this.option.currentRow.BsID,this.form.sTime=this.option.currentRow.StartDate,this.form.eTime=this.option.currentRow.EndDate,this.form.ServeTime=this.option.currentRow.ServeTime,this.form.Remark=this.option.currentRow.Remark},closeUpdete:function(){this.$refs.form.resetFields(),this.$refs.form.clearValidate()},ItemUpdate:function(){var e=this;this.$refs.form.validate(function(t){if(t)if("2"==e.option.mark)e.ItemUpdate1();else{e.loading=!0;var i=new c;i.data.Brno=e.form.brno,i.data.BsID=e.form.isQueue,Object(a.a)(i).then(function(t){"000000"==t.SYS_HEAD.ReturnCode?(e.loading=!1,e.$aui.message.show({type:"error",message:"已存在该业务的配置!"})):e.ItemUpdate1()}).catch(function(t){e.loading=!1,console.log(t)})}})},ItemUpdate1:function(){var e=this;this.loading=!0;var t="1"==this.option.mark?new l:new u;t.data.Brno=this.form.brno,t.data.BsID=this.form.isQueue,t.data.StartDate=this.form.sTime,t.data.EndDate=this.form.eTime,t.data.ServeTime=this.form.ServeTime,t.data.Remark=this.form.Remark,Object(a.a)(t).then(function(t){e.option.isShow=!1;var i="1"==e.option.mark?"创建":"修改";e.$aui.message.show({type:"success",message:""+i+t.SYS_HEAD.ReturnMessage+"!"}),e.loading=!1,e.$emit("refreshTable")}).catch(function(t){e.loading=!1,e.$aui.message.show({type:"warning",message:t.SYS_HEAD.ReturnMessage+"!"}),e.option.isShow=!1})}}},p={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("aui-dialog",{attrs:{title:e.option.title,visible:e.option.isShow,width:"800px","close-on-click-modal":!1},on:{"update:visible":function(t){e.$set(e.option,"isShow",t)},show:e.openUpdate,hide:e.closeUpdete}},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[i("aui-card",[i("aui-form",{ref:"form",attrs:{model:e.form,size:"mini",rules:e.rules,"label-width":"140px","label-position":"right"}},[i("aui-row",{attrs:{gutter:40}},[i("aui-col",{attrs:{span:12}},[i("aui-form-item",{attrs:{label:"机构编号:",prop:"brno"}},[i("aui-select",{attrs:{disabled:e.option.isDisabled,filterable:"",placeholder:"请选择机构编号"},model:{value:e.form.brno,callback:function(t){e.$set(e.form,"brno",t)},expression:"form.brno"}},e._l(e.option.branchNum,function(e){return i("aui-option",{key:e.orgno,attrs:{label:e.cname,value:e.orgno,disabled:e.disabled}})}))],1)],1),e._v(" "),i("aui-col",{attrs:{span:12}},[i("aui-form-item",{attrs:{label:"业务ID:",prop:"isQueue"}},[i("aui-select",{attrs:{disabled:e.option.isDisabled,placeholder:"请选择业务ID"},model:{value:e.form.isQueue,callback:function(t){e.$set(e.form,"isQueue",t)},expression:"form.isQueue"}},e._l(e.option.BsIDTpList,function(e){return i("aui-option",{key:e.BsID,attrs:{label:e.BsID+"-"+e.BsName,value:e.BsID,disabled:e.disabled}})}))],1)],1)],1),e._v(" "),i("aui-row",{attrs:{gutter:40}},[i("aui-col",{attrs:{span:12}},[i("aui-form-item",{staticClass:"typeInfo-aui-form-item",attrs:{label:"开始时间",prop:"sTime"}},[i("aui-date-picker",{attrs:{"value-format":"yyyyMMdd",type:"date",disabled:e.option.isDisabled,placeholder:"选择日期"},model:{value:e.form.sTime,callback:function(t){e.$set(e.form,"sTime",t)},expression:"form.sTime"}})],1)],1),e._v(" "),i("aui-col",{attrs:{span:12}},[i("aui-form-item",{staticClass:"typeInfo-aui-form-item",attrs:{label:"结束时间",prop:"eTime"}},[i("aui-date-picker",{attrs:{"value-format":"yyyyMMdd",type:"date",disabled:e.option.isDisabled,placeholder:"选择日期"},model:{value:e.form.eTime,callback:function(t){e.$set(e.form,"eTime",t)},expression:"form.eTime"}})],1)],1)],1),e._v(" "),i("aui-row",{attrs:{gutter:40}},[i("aui-col",{attrs:{span:12}},[i("aui-form-item",{attrs:{label:"服务时间段:",prop:"ServeTime"}},[i("aui-input",{attrs:{placeholder:"服务时间段"},model:{value:e.form.ServeTime,callback:function(t){e.$set(e.form,"ServeTime",t)},expression:"form.ServeTime"}})],1)],1),e._v(" "),i("aui-col",{attrs:{span:12}},[i("aui-form-item",{attrs:{label:"备注:",prop:"Remark"}},[i("aui-input",{model:{value:e.form.Remark,callback:function(t){e.$set(e.form,"Remark",t)},expression:"form.Remark"}})],1)],1)],1),e._v(" "),i("span",{staticStyle:{color:"red"}},[e._v("注:服务时间段格式09:00-12:00 多个时段用;分隔")])],1)],1),e._v(" "),i("aui-row",{staticStyle:{margin:"20px 0","text-align":"right"}},[i("aui-button",{attrs:{size:"mini"},on:{click:function(t){e.option.isShow=!1}}},[e._v("返回")]),e._v(" "),i("aui-button",{attrs:{type:"primary",size:"mini"},on:{click:e.ItemUpdate}},[e._v("确定")])],1)],1)])],1)},staticRenderFns:[]};var d=i("/Xao")(m,p,!1,function(e){i("bNQi")},null,null).exports,h=i("0VOF"),g=i("4Flk"),f=function e(){n()(this,e),this.data={Brno:"",BusiOper:"D",BsID:""},this.BusiDataKey="BusiSpeciTime_Delete",this.TransServiceCode="ib-dbcomm/dbComm"},b=i("pADA"),v={name:"specialdayserviceconfiguration",components:{selectTree:i("tzsN").a},data:function(){return{currentRow:[],QueryForm:{branchNum:[],BsIDTp:""},branchNum:[],brnoList:[],BsIDTpList:[],BsIDTpMap:{},total:void 0,orgParamList:[],brnoMap:{},permission:{},loading:!1,isDisabledDel:!1,dialogList:{orgParamAdd:d},dialogOptions:{isShow:!1},currentPage:1,pageSize:void 0,rules:{branchNum:[{required:!0,message:"请选择机构编号",trigger:"change"}]}}},created:function(){this.pageSize=r.a.get("PageSize"),this.queryBranchNum()},watch:{"QueryForm.branchNum":function(e){this.$refs.QueryForm.clearValidate(),this.BsID()}},computed:{},methods:{BsID:function(){var e=this,t=new g.a;t.data.Brno=this.QueryForm.branchNum[0],Object(a.a)(t).then(function(t){e.BsIDTpList=t.RspInfo.Result||[],e.BsIDTpMap=e.toolBox.objArray2Hash(e.BsIDTpList,"BsID"),e.query()}).catch(function(t){e.loading=!1,e.$aui.message.show({type:"warning",message:t.SYS_HEAD.ReturnMessage}),console.error("查询错误",t)})},queryBranchNum:function(){var e=this;this.loading=!0;var t=new h.a;t.data.orgno=this.$store.getters.BranchNum,Object(a.a)(t).then(function(t){e.loading=!1,e.branchNum=t.RspInfo.Result||[],e.brnoMap=t.RspInfo.orgMap||{},e.permission=b.a.objArray2Hash(e.branchNum,"orgno"),e.brnoList=b.a.formatTreeData(e.branchNum,"orgno","superno"),e.QueryForm.branchNum.push(e.brnoList[0].orgno),e.BsID()}).catch(function(t){e.loading=!1,e.$aui.message.show({type:"warning",message:t.SYS_HEAD.ReturnMessage}),console.error("查询错误",t)})},dataFormat:function(e,t){return"Brno"==t.property?e[t.property]+"-"+this.brnoMap[e[t.property]]:"BsID"==t.property?e[t.property]+(this.BsIDTpMap[e[t.property]]?"-"+this.BsIDTpMap[e[t.property]].BsName:""):void 0},clickAdd:function(){this.dialogOptions.isShow=!0,this.dialogOptions.title="新增特殊日服务时段配置",this.dialogOptions.mark="1",this.dialogOptions.isDisabled=!1,this.dialogOptions.branchNum=this.branchNum,this.dialogOptions.BsIDTpList=this.BsIDTpList},clickUpdate:function(){this.dialogOptions.isShow=!0,this.dialogOptions.title="修改特殊日服务时段配置",this.dialogOptions.mark="2",this.dialogOptions.isDisabled=!0,this.dialogOptions.currentRow=this.currentRow,this.dialogOptions.branchNum=this.branchNum,this.dialogOptions.BsIDTpList=this.BsIDTpList},resetForm:function(){this.total=0,this.orgParamList=[],this.$refs.QueryForm.resetFields()},delBut:function(){var e=this;this.$aui.confirm.show("此操作将永久删除该特殊日服务时段配置, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.Del()}).catch(function(){e.$aui.message.show({type:"info",message:"已取消删除"})})},Del:function(){var e=this;this.loading=!0;var t=new f;t.data.Brno=this.currentRow.Brno,t.data.BsID=this.currentRow.BsID,Object(a.a)(t).then(function(t){e.loading=!1,e.$aui.message.show({type:"success",message:"该特殊日服务时段配置删除成功！"}),e.query()}).catch(function(t){e.loading=!1,e.$aui.message.show({type:"warning",message:t.SYS_HEAD.ReturnMessage}),console.log(t)})},checkPermission:function(e){this.permission[this.currentRow.Brno]?e?this.clickUpdate():this.delBut():this.$aui.message.show({type:"warning",message:"权限不足,无法修改！"})},query:function(){var e=this;this.$refs.QueryForm.validate(function(t){if(t){e.loading=!0;var i=new c;i.data.Brno=e.QueryForm.branchNum[0],i.data.BsID=e.QueryForm.BsIDTp,i.data.PageSize=e.pageSize,i.data.CurtPage=e.currentPage,i.data.StartRows=(e.currentPage-1)*e.pageSize,Object(a.a)(i).then(function(t){e.loading=!1,e.orgParamList=t.RspInfo.Result||[],e.total=t.RspInfo.totalNum||0}).catch(function(t){e.orgParamList=[],e.total=0,e.loading=!1,e.$aui.message.show({type:"warning",message:t.SYS_HEAD.ReturnMessage}),console.log(t)})}})},handleCurrentChange:function(e){this.currentPage=e,this.query()},selectAll:function(e){e.length>=1?this.isDisabledDel=!0:this.isDisabledDel=!1},selectList:function(e){this.currentRow=e[0],1==e.length?this.isDisabledDel=!0:e.length>1?this.$refs.orgParamList.toggleRowSelection(e[0]):this.isDisabledDel=!1}}},D={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":"加载中。。。"}},[i("aui-card",[i("aui-form",{ref:"QueryForm",attrs:{model:e.QueryForm,rules:e.rules,size:"mini","label-position":"top"}},[i("aui-row",{attrs:{gutter:10}},[i("aui-col",{attrs:{lg:4,md:6}},[i("aui-form-item",{attrs:{label:"机构编号",prop:"branchNum"}},[i("select-tree",{staticStyle:{width:"170px"},attrs:{"single-check":!0,props:{id:"orgno",label:"cname",children:"children"},"tree-data":e.brnoList,placeholder:"请选择机构"},model:{value:e.QueryForm.branchNum,callback:function(t){e.$set(e.QueryForm,"branchNum",t)},expression:"QueryForm.branchNum"}})],1)],1),e._v(" "),i("aui-col",{attrs:{lg:4,md:6}},[i("aui-form-item",{attrs:{prop:"BsIDTp",label:"业务ID"}},[i("aui-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.QueryForm.BsIDTp,callback:function(t){e.$set(e.QueryForm,"BsIDTp",t)},expression:"QueryForm.BsIDTp"}},e._l(e.BsIDTpList,function(e){return i("aui-option",{key:e.BsID,attrs:{label:e.BsID+"-"+e.BsName,value:e.BsID}})}))],1)],1),e._v(" "),i("aui-col",{staticClass:"searchBtnMarginTop",attrs:{lg:2,md:3}},[i("aui-button",{attrs:{type:"primary",size:"mini",icon:"aui-icon-search"},on:{click:e.query}},[e._v("查询")])],1),e._v(" "),i("aui-col",{staticClass:"searchBtnMarginTop",attrs:{lg:2,md:3}},[i("aui-button",{attrs:{type:"warning",size:"mini",icon:"aui-icon-refresh"},on:{click:function(t){e.resetForm("QueryForm")}}},[e._v("重置")])],1)],1)],1)],1),e._v(" "),i("aui-card",{staticStyle:{"margin-top":"10px"}},[i("aui-row",[i("aui-col",{attrs:{lg:2,md:3}},[e.btnPermission("Button_Menu_Add")?i("aui-button",{attrs:{type:"primary",icon:"aui-icon-plus",disabled:e.isDisabledDel,size:"mini"},on:{click:e.clickAdd}},[e._v("新增")]):e._e()],1),e._v(" "),i("aui-col",{attrs:{lg:2,md:3}},[e.btnPermission("Button_Menu_Add")?i("aui-button",{attrs:{type:"primary",icon:"aui-icon-edit",disabled:!e.isDisabledDel,size:"mini"},on:{click:function(t){e.checkPermission("1")}}},[e._v("修改")]):e._e()],1),e._v(" "),i("aui-col",{attrs:{lg:2,md:3}},[e.btnPermission("Button_Menu_Edit")?i("aui-button",{attrs:{type:"danger",icon:"aui-icon-delete",disabled:!e.isDisabledDel,size:"mini"},on:{click:function(t){e.checkPermission()}}},[e._v("删除")]):e._e()],1)],1),e._v(" "),i("aui-table",{ref:"orgParamList",staticClass:"tableMarginTop",staticStyle:{"min-height":"390px"},attrs:{data:e.orgParamList,border:"","header-row-class-name":"tableHeaderClass"},on:{"select-all":e.selectAll,"selection-change":e.selectList}},[i("aui-table-column",{attrs:{type:"selection",width:"40px"}}),e._v(" "),i("aui-table-column",{attrs:{prop:"Brno",formatter:e.dataFormat,label:"机构号","min-width":"107px"}}),e._v(" "),i("aui-table-column",{attrs:{prop:"BsID",formatter:e.dataFormat,label:"业务ID","min-width":"127px"}}),e._v(" "),i("aui-table-column",{attrs:{prop:"StartDate",label:"开始日期","min-width":"107px"}}),e._v(" "),i("aui-table-column",{attrs:{prop:"EndDate",label:"结束日期","min-width":"107px"}}),e._v(" "),i("aui-table-column",{attrs:{prop:"ServeTime",label:"服务时间段","min-width":"150px"}}),e._v(" "),i("aui-table-column",{attrs:{prop:"Remark",label:"备注","min-width":"107px"}})],1),e._v(" "),i("div",{staticStyle:{"text-align":"right","margin-top":"10px"}},[i("aui-pagination",{attrs:{background:"","current-page":e.currentPage,"page-size":10,layout:"total, prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange}})],1)],1)],1),e._v(" "),i("keep-alive",[i(e.dialogList.orgParamAdd,{tag:"component",attrs:{option:e.dialogOptions},on:{refreshTable:e.query}})],1)],1)},staticRenderFns:[]};var B=i("/Xao")(v,D,!1,function(e){i("BATM")},"data-v-30b36302",null);t.default=B.exports},Hqin:function(e,t,i){(e.exports=i("BkJT")(!1)).push([e.i,"",""])},bNQi:function(e,t,i){var a=i("Hqin");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);i("8bSs")("5a9916fa",a,!0)},wGOh:function(e,t,i){(e.exports=i("BkJT")(!1)).push([e.i,"",""])}});