webpackJsonp([38],{"A/OI":function(n,e,t){var i=t("agYQ");"string"==typeof i&&(i=[[n.i,i,""]]),i.locals&&(n.exports=i.locals);t("8bSs")("7af4c7df",i,!0)},agYQ:function(n,e,t){(n.exports=t("BkJT")(!1)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},g7ah:function(n,e,t){var i=t("jhXd");"string"==typeof i&&(i=[[n.i,i,""]]),i.locals&&(n.exports=i.locals);t("8bSs")("9c7b7ca6",i,!0)},jhXd:function(n,e,t){(n.exports=t("BkJT")(!1)).push([n.i,'\ncode[data-v-73e0fb7a] {\n  background: #eef1f6;\n  padding: 15px 16px;\n  margin-bottom: 0px;\n  display: block;\n  line-height: 36px;\n  font-size: 15px;\n  font-family: "Source Sans Pro", "Helvetica Neue", Arial, sans-serif;\n}\n',""])},nbKU:function(n,e,t){var i=t("vjyu");"string"==typeof i&&(i=[[n.i,i,""]]),i.locals&&(n.exports=i.locals);t("8bSs")("30119ebb",i,!0)},pa7b:function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=t("ZLEe"),a=t.n(i),o=t("0oES"),r=t("syAl"),s=t("Luip"),l=t("qfSh"),u=t("4Wfm"),c=t("AA3o"),d=t.n(c),p=function n(){d()(this,n),this.data={versionCode:""},this.TransServiceCode="mg-afaservices-vsn/versionIsexist"},m=function n(){d()(this,n),this.data={versionCode:"",strategy_Id:"",uploadFileName:"",description:"",urlAddress:""},this.TransServiceCode="mg-afaservices-vsn/versionFileupload"},f={props:{option:Object},data:function(){return{appQueryList:[],loading:!1,dialogFormVisible:!1,form:{filename:!1,isIncrement:"0"},defaultProps:{value:"devTypeNum",label:"devType"},urlAddress:"",uploadFileName:"",versionCode:"",devSortOptions:[],verOptionsTemplate:[],fileUrl:"",rules:{filename:[{required:!0,validator:function(n,e,t){!1===e?t(new Error("请选择上传文件")):t()},trigger:"change"}],strategy_Id:[{required:!0,message:"请选择版本操作结果",trigger:"change"}],AppNum:[{required:!0,message:"请选择设备分类",trigger:"change"}],description:[{required:!0,message:"请填写版本描述",trigger:"blur"}]}}},computed:{isShow:{get:function(){return this.option.isShow},set:function(n){this.option.isShow=n}}},created:function(){this.fileUrl=r.a.get("versionFileUploadAddress"),this.initSpinnerList()},methods:{appQueryInit:function(){var n=this,e=new l.a;e.data.UserNum=this.$store.getters.UserNum,Object(o.a)(e).then(function(e){n.appQueryList=e.RspInfo.Result}).catch(function(n){console.error("查询错误",n)})},handleExceed:function(n,e){this.$aui.message.show.warning("只能上传一个版本文件！")},initSpinnerList:function(){var n=this,e=new u.a;Object(o.a)(e).then(function(e){n.verOptionsTemplate=e.RspInfo.verOptionsTemplateInfoList}).catch(function(n){console.error("查询错误",n)})},closeCallback:function(){var n=this;this.form={},this.form.filename=!1,this.$refs.upload.clearFiles(),this.$nextTick(function(){n.$refs.form.clearValidate()}),this.versionCode=null},successCallback:function(n){this.form.filename=!0,this.urlAddress=n},delfile:function(){this.form.filename=!1},submitForm:function(n){var e=this;this.$refs[n].validate(function(n){if(!n)return e.$aui.message.show({message:"请完善信息",type:"warning"}),!1;e.loading=!0;var t=new m;t.data.versionCode=e.versionCode,t.data.strategy_Id=e.form.strategy_Id,t.data.description=e.form.description,t.data.uploadFileName=e.uploadFileName,t.data.isFlag=e.form.isIncrement,t.data.appNum=e.form.AppNum,t.data.urlAddress="version/"+e.uploadFileName,Object(o.a)(t).then(function(n){e.loading=!1,e.$parent.initSpinnerList(),e.$parent.setversionCode(e.versionCode),e.$parent.queryInfoList(),e.isShow=!1,e.form.filename=!1,e.$aui.message.show({message:"版本信息保存成功",type:"success"})}).catch(function(n){e.$aui.message.show({message:n.SYS_HEAD.ReturnMessage,type:"error"}),e.loading=!1,console.log("异常信息：",n)})})},versionIsExistChange:function(n,e){var t=this;this.uploadFileName=n.name,this.versionCode=this.uploadFileName.split(".",1).toString();var i=new p;i.data.versionCode=this.versionCode,Object(o.a)(i).then(function(n){t.$refs.upload.submit()}).catch(function(n){return t.$aui.message.show({message:n.SYS_HEAD.ReturnMessage,type:"error"}),t.$refs.upload.clearFiles(),t.uploadFileName=null,t.versionCode=null,!1})}}},h={render:function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("aui-dialog",{attrs:{title:"版本文件上传",visible:n.isShow,"lock-scroll":!1,width:"510px"},on:{"update:visible":function(e){n.isShow=e},hide:n.closeCallback,show:n.appQueryInit}},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:n.loading,expression:"loading"}],attrs:{"element-loading-text":"拼命加载中"}},[t("aui-card",[t("aui-form",{ref:"form",attrs:{model:n.form,rules:n.rules,size:"mini","label-width":"80px","label-position":"right"}},[t("aui-form-item",{attrs:{label:"文件上传",prop:"filename"}},[t("aui-upload",{ref:"upload",attrs:{action:n.fileUrl,"on-change":n.versionIsExistChange,limit:1,"on-exceed":n.handleExceed,"on-success":n.successCallback,"on-remove":n.delfile,accept:".zip","auto-upload":!1}},[t("aui-button",{attrs:{size:"mini",plain:"",type:"primary"}},[n._v("选择上传文件")]),n._v(" "),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[n._v(" 版本号规则：v_8位数字_4位数字，格式：zip")])],1)],1),n._v(" "),t("aui-form-item",{attrs:{label:"版本编号",prop:"versionCode"}},[t("aui-input",{attrs:{"auto-complete":"off",disabled:"",placeholder:"版本编号自动填入"},model:{value:n.versionCode,callback:function(e){n.versionCode=e},expression:"versionCode"}})],1),n._v(" "),t("aui-form-item",{attrs:{label:"版本策略",prop:"strategy_Id"}},[t("aui-select",{attrs:{placeholder:"请选择版本操作结果"},model:{value:n.form.strategy_Id,callback:function(e){n.$set(n.form,"strategy_Id",e)},expression:"form.strategy_Id"}},n._l(n.verOptionsTemplate,function(n){return t("aui-option",{key:n.verOptionsTemplateId,attrs:{label:n.verOptionsTemplateName,value:n.verOptionsTemplateId}})}))],1),n._v(" "),t("aui-row",{attrs:{gutter:10}},[t("aui-col",{attrs:{md:12,lg:12}},[t("aui-form-item",{attrs:{label:"设备应用",prop:"AppNum"}},[t("aui-select",{attrs:{placeholder:"请选择设备应用"},model:{value:n.form.AppNum,callback:function(e){n.$set(n.form,"AppNum",e)},expression:"form.AppNum"}},n._l(n.appQueryList,function(n){return t("aui-option",{key:n.AppNum,attrs:{label:n.AppNum+"-"+n.AppName,value:n.AppNum}})}))],1)],1),n._v(" "),t("aui-col",{attrs:{md:12,lg:12}},[t("aui-form-item",{attrs:{label:"是否增量",prop:"isIncrement"}},[t("aui-radio",{attrs:{label:"1"},model:{value:n.form.isIncrement,callback:function(e){n.$set(n.form,"isIncrement",e)},expression:"form.isIncrement"}},[n._v("是")]),n._v(" "),t("aui-radio",{attrs:{label:"0"},model:{value:n.form.isIncrement,callback:function(e){n.$set(n.form,"isIncrement",e)},expression:"form.isIncrement"}},[n._v("否")])],1)],1)],1),n._v(" "),t("aui-form-item",{attrs:{label:"版本描述",prop:"description"}},[t("aui-input",{attrs:{type:"textarea",autosize:"",placeholder:"请输入版本描述","auto-complete":"off"},model:{value:n.form.description,callback:function(e){n.$set(n.form,"description",e)},expression:"form.description"}})],1)],1)],1),n._v(" "),t("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"right"},attrs:{slot:"footer"},slot:"footer"},[t("aui-button",{staticStyle:{"margin-top":"10px"},attrs:{size:"mini"},on:{click:function(e){n.isShow=!1}}},[n._v("取 消")]),n._v(" "),t("aui-button",{staticStyle:{"margin-top":"10px"},attrs:{size:"mini",type:"primary"},on:{click:function(e){n.submitForm("form")}}},[n._v("确 定")])],1)],1)])},staticRenderFns:[]};var v=t("/Xao")(f,h,!1,function(n){t("nbKU")},"data-v-1d04322a",null).exports,g=function n(){d()(this,n),this.data={versionCode:""},this.TransServiceCode="mg-afaservices-vsn/versionDetaillist"},b={props:{option:Object},data:function(){return{gridData:[],currentPage:1}},computed:{detailIsShow:{get:function(){return this.option.isShow},set:function(n){this.option.isShow=n}},versionCode:function(){return this.option.versionCode},adDescription:function(){return this.option.adDescription}},methods:{handleCurrentChange:function(n){this.getVersionDetailList()},getVersionDetailList:function(){var n=this,e=new g;e.data.versionCode=this.versionCode,e.data.queryrownum=r.a.get("PageSize"),e.data.querypageno=this.currentPage,Object(o.a)(e).then(function(e){n.gridData=e.RspInfo.verDetailInfoList}).catch(function(e){n.$aui.message.show({message:e.SYS_HEAD.ReturnMessage,type:"warning"}),console.log("error",e)})}}},y={render:function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",[t("aui-dialog",{attrs:{title:"版本详情","close-on-click-modal":!1,"lock-scroll":!1,visible:n.detailIsShow,width:"900px"},on:{"update:visible":function(e){n.detailIsShow=e},show:n.getVersionDetailList}},[t("code",[t("div",[n._v("版本编号：\n        "),t("span",{domProps:{textContent:n._s(n.versionCode)}})]),n._v(" "),t("div",[n._v("版本描述：\n        "),t("span",{domProps:{textContent:n._s(n.adDescription)}})])]),n._v(" "),t("aui-card",[t("aui-table",{attrs:{data:n.gridData,border:"","header-row-class-name":"tableHeaderClass"}},[t("aui-table-column",{attrs:{property:"fileName",label:"文件名称",width:"120"}}),n._v(" "),t("aui-table-column",{attrs:{property:"filePath",label:"文件路径","min-width":"200"}}),n._v(" "),t("aui-table-column",{attrs:{property:"fileType",label:"文件类型",width:"80"}}),n._v(" "),t("aui-table-column",{attrs:{property:"fileSize",label:"文件大小",width:"80"}}),n._v(" "),t("aui-table-column",{attrs:{property:"createTime",label:"创建时间",width:"160"}})],1),n._v(" "),t("aui-pagination",{staticStyle:{"text-align":"right","margin-top":"20px"},attrs:{"current-page":n.currentPage,background:"",layout:"total, prev, pager, next, jumper",total:n.gridData.length},on:{"current-change":n.handleCurrentChange,"update:currentPage":function(e){n.currentPage=e}}})],1),n._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("aui-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){n.detailIsShow=!1}}},[n._v("关 闭")])],1)],1)],1)},staticRenderFns:[]};var _=t("/Xao")(b,y,!1,function(n){t("g7ah")},"data-v-73e0fb7a",null).exports,C=function n(){d()(this,n),this.data={versionCode:""},this.TransServiceCode="mg-afaservices-vsn/queryVersionlist"},w=function n(){d()(this,n),this.data={versionCode:""},this.TransServiceCode="mg-afaservices-vsn/versionDeletefile"},S={data:function(){return{oldvcode:"",tableTotal:0,pageSize:r.a.get("PageSize"),formInline:{versionCode:""},currentPage:1,loading:!1,tableData:[],dialogList:{fileUpload:v,versionDeailList:_},dialogOptionsFileUpload:{isShow:!1},dialogOptionsVersionDetail:{isShow:!1,versionCode:"",adDescription:""},multipleSelection:[],verBaseInfo:[],isFalg:{0:"否",1:"是"},appQueryList:null}},created:function(){this.initSpinnerList(),this.queryInfoList(),this.appQueryInit()},computed:{isdeleteDisabled:function(){return!(1===this.multipleSelection.length)},tables:function(){var n=this.formInline.versionCode;return n?this.tableData.filter(function(e){return a()(e).some(function(t){return String(e[t]).toLowerCase().indexOf(n)>-1})}):this.tableData}},methods:{falgFormat:function(n,e,t,i){return n[e.property]+"-"+this.isFalg[n[e.property]]},appNumFormat:function(n,e){var t="";return(this.appQueryList||[]).forEach(function(i){i.AppNum==n[e.property]&&(t=i.AppNum+"-"+i.AppName)}),t},appQueryInit:function(){var n=this,e=new l.a;e.data.UserNum=this.$store.getters.UserNum,Object(o.a)(e).then(function(e){n.appQueryList=e.RspInfo.Result}).catch(function(n){console.error("查询错误",n)})},initSpinnerList:function(){var n=this,e=new s.a;Object(o.a)(e).then(function(e){n.verBaseInfo=e.RspInfo.verDropBoxList||[]}).catch(function(n){console.error("查询错误",n)})},setversionCode:function(n){this.formInline.versionCode=n},handleSizeChange:function(n){this.queryInfoList()},handleCurrentChange:function(n){this.queryInfoList()},queryInfoList:function(){var n=this;this.loading=!0;var e=new C;e.data.versionCode=this.formInline.versionCode,this.formInline.versionCode!=this.oldvcode&&(this.currentPage=1,this.oldvcode=this.formInline.versionCode),e.data.queryrownum=this.pageSize,e.data.querypageno=this.currentPage,Object(o.a)(e).then(function(e){n.loading=!1,n.tableData=e.RspInfo.verInfoList||[],n.tableTotal=Number(e.RspInfo.QueryAllDataCount||n.tableData.length)}).catch(function(e){n.loading=!1,n.$aui.message.show({message:e.SYS_HEAD.ReturnMessage,type:"error"}),console.log("异常信息：",e)})},clearForm:function(n){this.$refs[n].resetFields()},dialogFileUpload:function(){this.dialogOptionsFileUpload.isShow=!0},dialogVersionFileList:function(n,e){this.dialogOptionsVersionDetail.versionCode=e[n].versionCode,this.dialogOptionsVersionDetail.adDescription=e[n].adDescription,this.dialogOptionsVersionDetail.isShow=!0},handleSelectionChange:function(n){this.multipleSelection=n},deleteVertionFile:function(){var n=this;this.$aui.confirm.show("此操作将永久删除该版本文件, 是否继续?","系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",lockScroll:!1}).then(function(){n.versionDeleteFile()}).catch(function(){n.$aui.message.show({type:"info",message:"已取消删除"})})},versionDeleteFile:function(){var n=this,e=new w;e.data.versionCode=this.multipleSelection[0].versionCode,Object(o.a)(e).then(function(e){n.queryInfoList(),n.initSpinnerList(),n.clearForm("formInline"),n.$aui.message.show({type:"success",message:"删除成功!"})}).catch(function(e){n.$aui.message.show({message:e.SYS_HEAD.ReturnMessage,type:"error"}),console.log("异常信息：",e)})}}},I={render:function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:n.loading,expression:"loading"}],attrs:{"element-loading-text":"拼命加载中"}},[t("aui-card",{staticStyle:{"margin-bottom":"10px"}},[t("aui-form",{ref:"formInline",attrs:{model:n.formInline,"label-position":"top",size:"mini"}},[t("aui-row",{attrs:{gutter:10}},[t("aui-col",{attrs:{md:6,lg:4}},[t("aui-form-item",{attrs:{label:"版本编号",prop:"versionCode"}},[t("aui-select",{attrs:{placeholder:"请选择版本编号查询"},model:{value:n.formInline.versionCode,callback:function(e){n.$set(n.formInline,"versionCode",e)},expression:"formInline.versionCode"}},n._l(n.verBaseInfo,function(n){return t("aui-option",{key:n.adID,attrs:{label:n.VERSIONCODE,value:n.VERSIONCODE}})}))],1)],1),n._v(" "),t("aui-col",{staticClass:"searchBtnMarginTop",attrs:{lg:2,md:3}},[t("aui-form-item",[t("aui-button",{attrs:{type:"warning",icon:"aui-icon-refresh"},on:{click:function(e){n.clearForm("formInline")}}},[n._v("重置")])],1)],1)],1)],1)],1),n._v(" "),t("aui-card",[n.btnPermission("Button_VersionUpload_Upload")?t("aui-button",{attrs:{type:"primary",size:"mini",icon:"aui-icon-upload"},on:{click:n.dialogFileUpload}},[n._v("上传")]):n._e(),n._v(" "),n.btnPermission("Button_VersionUpload_Delete")?t("aui-button",{attrs:{type:"danger",size:"mini",icon:"aui-icon-delete",disabled:n.isdeleteDisabled},on:{click:n.deleteVertionFile}},[n._v("删除")]):n._e(),n._v(" "),t("aui-table",{staticClass:"tableMarginTop",attrs:{data:n.tables,"header-row-class-name":"tableHeaderClass",border:""},on:{"selection-change":n.handleSelectionChange}},[t("aui-table-column",{attrs:{type:"selection",width:"40"}}),n._v(" "),t("aui-table-column",{attrs:{fixed:"",prop:"versionCode",label:"版本编号",width:"150"}}),n._v(" "),t("aui-table-column",{attrs:{prop:"verOptionsTemplateName",label:"所属模版分类","min-width":"180"}}),n._v(" "),t("aui-table-column",{attrs:{prop:"verCreateTime",label:"上传时间",width:"160"}}),n._v(" "),t("aui-table-column",{attrs:{prop:"appNum",formatter:n.appNumFormat,label:"设备应用",width:"120"}}),n._v(" "),t("aui-table-column",{attrs:{prop:"isFalg",formatter:n.falgFormat,label:"是否增量",width:"80"}}),n._v(" "),t("aui-table-column",{attrs:{prop:"adDescription",label:"版本描述","min-width":"200"}}),n._v(" "),t("aui-table-column",{attrs:{align:"center",fixed:"right",label:"操作",width:"80"},scopedSlots:n._u([{key:"default",fn:function(e){return[t("aui-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){n.dialogVersionFileList(e.$index,n.tableData)}}},[n._v("查看详情")])]}}])})],1),n._v(" "),t("aui-pagination",{staticStyle:{"text-align":"right","margin-top":"20px"},attrs:{"current-page":n.currentPage,"page-sizes":[10,20,50,100],"page-size":n.pageSize,background:"",layout:"total, prev, pager, next, jumper",total:n.tableTotal},on:{"current-change":n.handleCurrentChange,"size-change":n.handleSizeChange,"update:currentPage":function(e){n.currentPage=e}}})],1),n._v(" "),t("keep-alive",[t(n.dialogList.fileUpload,{tag:"component",attrs:{option:n.dialogOptionsFileUpload}})],1),n._v(" "),t("keep-alive",[t(n.dialogList.versionDeailList,{tag:"component",attrs:{option:n.dialogOptionsVersionDetail}})],1)],1)},staticRenderFns:[]};var x=t("/Xao")(S,I,!1,function(n){t("A/OI")},null,null);e.default=x.exports},vjyu:function(n,e,t){(n.exports=t("BkJT")(!1)).push([n.i,"\n.aui-cascader[data-v-1d04322a] {\r\n  width: 338px;\n}\r\n",""])}});