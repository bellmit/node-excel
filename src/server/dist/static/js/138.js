webpackJsonp([138],{"9XNo":function(t,a,e){(t.exports=e("BkJT")(!1)).push([t.i,"\n.aui-date-editor.aui-input,\n.aui-date-editor.el-input__inner {\n  width: 100%;\n}\n",""])},bUVo:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var n=e("tzsN"),r=e("0oES"),o=e("syAl"),i=e("pADA"),l=e("0VOF"),s=e("AA3o"),u=e.n(s),c=function t(){u()(this,t),this.data={BusiOper:"Q"},this.BusiDataKey="SelectCardBoxInfo",this.TransServiceCode="ib-dbcomm/dbComm"},m={components:{selectTree:n.a},data:function(){return{filename:"卡箱信息查询导出",brnoList:[],formInline:{branchId:[]},rules:{operater:[{required:!0,message:"请输入用户编号",trigger:"blur"}]},currentPage:1,loading:!1,tableData:[],tableTotal:0}},created:function(){this.formInline.startdate=i.a.getNowTime(29),this.formInline.enddate=i.a.getNowTime(0),this.pageSize=o.a.get("PageSize"),this.initBrno()},watch:{formInline:{handler:function(t,a){this.currentPage=1},deep:!0}},methods:{dFormat:function(t,a){return i.a.timeFormat2Date(t[a.property])},tFormat:function(t,a){return i.a.timeFormat2Time(t[a.property])},dataformat:function(t,a){return t[a.property]+"-"+this.brnoMap[t[a.property]]},handleDownload:function(){var t=this;e.e(169).then(e.bind(null,"FNRk")).then(function(a){var e=t.list1,n=t.formatJson(["CARD_BOX_NO","EQUIP_NO","ORG_NO","CARD_BOX_TOTL_CARD_QTY","LSTTM_CLEA_MACH_DT","LSTTM_CLEA_MACH_TM","ADD_CARD_QTY","SUCC_ISCRD_QTY","EQUIP_NO","SWA_CARD_QTY","ORG_NM"],e);a.export_json_to_excel({header:["卡箱号","设备编号","机构号","上次清机操作员","上次清机日期","上次清机时间","加卡数量","成功发卡数量","卡箱现存数量","吞卡数量","备注"],data:n,filename:t.filename,autoWidth:t.autoWidth,bookType:t.bookType})})},formatJson:function(t,a){return a.map(function(a){return t.map(function(t){return"timestamp"===t?parseTime(a[t]):a[t]})})},initBrno:function(){var t=this;this.loading=!0;var a=new l.a;a.data.orgno=this.$store.getters.BranchNum,Object(r.a)(a).then(function(a){t.loading=!1,t.branchNum=a.RspInfo.Result||[],t.permission=i.a.objArray2Hash(t.branchNum,"orgno"),t.brnoMap=a.RspInfo.orgMap||{},t.brnoList=i.a.formatTreeData(t.branchNum,"orgno","superno"),t.formInline.branchId.push(t.brnoList[0].orgno)}).catch(function(a){t.loading=!1,t.$aui.message.show({type:"warning",message:a.SYS_HEAD.ReturnMessage}),console.error("查询错误",a)})},handleSizeChange:function(t){},handleCurrentChange:function(t){this.currentPage=t,this.queryInfoList()},queryInfoList:function(){var t=this;this.$refs.formInline.validate(function(a){if(a){t.loading=!0;var e=new c;e.data.ORG_NO=t.formInline.branchId[0],e.data.EQUIP_NO=t.formInline.devNum,e.data.CurtPage=t.currentPage+"",e.data.PageSize=t.pageSize+"",e.data.StartRows=(t.currentPage-1)*t.pageSize+"",Object(r.a)(e).then(function(a){t.loading=!1,t.tableData=a.RspInfo.Result||[],t.tableTotal=a.RspInfo.totalNum||0,"0"==t.tableTotal&&t.$aui.message.show({type:"warning",message:"无满足条件的记录"})}).catch(function(a){t.$aui.message.show({type:"error",message:"请求失败，错误码:"+a.SYS_HEAD.ReturnCode+"，错误信息："+a.SYS_HEAD.ReturnMessage}),t.loading=!1,t.tableData=[],t.tableTotal=0,console.error("查询错误",a)})}})},export_CardboxInfo:function(){var t=this;this.$refs.formInline.validate(function(a){if(a){t.loading=!0;var e=new c;e.data.branchNo=t.formInline.branchId[0],e.data.devNum=t.formInline.devNum,e.data.CurtPage="1",e.data.PageSize="50000000",e.data.StartRows="",Object(r.a)(e).then(function(a){t.loading=!1,t.list1=a.RspInfo.Result||[],t.handleDownload()}).catch(function(a){t.loading=!1,t.$aui.message.show({type:"warning",message:"请求失败，错误码:"+a.SYS_HEAD.ReturnCode+"，错误信息："+a.SYS_HEAD.ReturnMessage}),console.error("查询错误",a)})}})},resetForm:function(t){this.formInline.selBrno=[],this.$refs[t].resetFields()}}},d={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{"element-loading-text":"拼命加载中"}},[e("aui-card",{staticStyle:{"margin-bottom":"10px",overflow:"visible"}},[e("aui-form",{ref:"formInline",attrs:{model:t.formInline,"label-position":"top",size:"mini"}},[e("aui-row",{attrs:{gutter:10}},[e("aui-col",{attrs:{md:6,lg:4}},[e("aui-form-item",{staticClass:"typeInfo-aui-form-item",attrs:{label:"机构编号",prop:"branchId"}},[e("select-tree",{staticStyle:{width:"170px"},attrs:{"single-check":!0,props:{id:"orgno",label:"cname",children:"children"},"tree-data":t.brnoList,placeholder:"请选择机构"},model:{value:t.formInline.branchId,callback:function(a){t.$set(t.formInline,"branchId",a)},expression:"formInline.branchId"}})],1)],1),t._v(" "),e("aui-col",{attrs:{md:6,lg:4}},[e("aui-form-item",{attrs:{label:"设备编号",prop:"devNum"}},[e("aui-input",{attrs:{placeholder:"请输入设备编号"},model:{value:t.formInline.devNum,callback:function(a){t.$set(t.formInline,"devNum",a)},expression:"formInline.devNum"}})],1)],1),t._v(" "),e("aui-col",{staticClass:"searchBtnMarginTop",attrs:{md:3,lg:2}},[e("aui-form-item",[e("aui-button",{attrs:{type:"primary",icon:"aui-icon-search"},on:{click:t.queryInfoList}},[t._v("查询")])],1)],1),t._v(" "),e("aui-col",{staticClass:"searchBtnMarginTop",attrs:{lg:2,md:3}},[e("aui-form-item",[e("aui-button",{attrs:{type:"warning",icon:"aui-icon-refresh"},on:{click:function(a){t.resetForm("formInline")}}},[t._v("重置")])],1)],1),t._v(" "),e("aui-col",{staticClass:"searchBtnMarginTop",attrs:{lg:2,md:3}},[e("aui-form-item",[t.btnPermission("Button_CardBoxQue_Export")?e("aui-button",{attrs:{type:"primary",icon:"aui-icon-download"},on:{click:t.export_CardboxInfo}},[t._v("导出")]):t._e()],1)],1)],1)],1)],1),t._v(" "),e("aui-card",[e("aui-table",{staticStyle:{},attrs:{data:t.tableData,height:"390","header-row-class-name":"tableHeaderClass",border:""}},[e("aui-table-column",{attrs:{fixed:"",prop:"CARD_BOX_NO",label:"卡箱号"}}),t._v(" "),e("aui-table-column",{attrs:{prop:"EQUIP_NO",label:"设备编号"}}),t._v(" "),e("aui-table-column",{attrs:{prop:"ORG_NO",label:"机构号",formatter:t.dataformat}}),t._v(" "),e("aui-table-column",{attrs:{prop:"LSTTM_CLEA_MACH_OPRR_NO",label:"上次清机操作员"}}),t._v(" "),e("aui-table-column",{attrs:{prop:"LSTTM_CLEA_MACH_DT",label:"上次清机日期"}}),t._v(" "),e("aui-table-column",{attrs:{prop:"LSTTM_CLEA_MACH_TM",label:"上次清机时间"}}),t._v(" "),e("aui-table-column",{attrs:{prop:"ADD_CARD_QTY",label:"加卡数量"}}),t._v(" "),e("aui-table-column",{attrs:{prop:"SUCC_ISCRD_QTY",label:"成功发卡数量"}}),t._v(" "),e("aui-table-column",{attrs:{prop:"CARD_BOX_TOTL_CARD_QTY",label:"卡箱现存数量"}}),t._v(" "),e("aui-table-column",{attrs:{prop:"SWA_CARD_QTY",label:"吞卡数量"}}),t._v(" "),e("aui-table-column",{attrs:{prop:"ORG_NM",label:"备注"}})],1),t._v(" "),e("aui-pagination",{staticStyle:{"text-align":"right","margin-top":"20px"},attrs:{"current-page":t.currentPage,background:"",layout:"total, prev, pager, next, jumper",total:t.tableTotal},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(a){t.currentPage=a}}})],1)],1)},staticRenderFns:[]};var p=e("/Xao")(m,d,!1,function(t){e("kPvc")},null,null);a.default=p.exports},kPvc:function(t,a,e){var n=e("9XNo");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);e("8bSs")("750650ab",n,!0)}});