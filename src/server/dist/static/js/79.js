webpackJsonp([79],{"33nP":function(e,a,t){(e.exports=t("BkJT")(!1)).push([e.i,'\n.selectTree[data-v-04f70b64] {\n  min-width: 150px;\n}\n.text[data-v-04f70b64] {\n  font-size: 14px;\n}\n.item[data-v-04f70b64] {\n  margin-bottom: 18px;\n}\n.dialog-text[data-v-04f70b64] {\n  display: inline-block;\n  width: 100%;\n  text-align: center;\n  color: red;\n}\n.clearfix[data-v-04f70b64]:before,\n.clearfix[data-v-04f70b64]:after {\n  display: table;\n  content: "";\n}\n.clearfix[data-v-04f70b64]:after {\n  clear: both;\n}\n.aui-card[data-v-04f70b64] {\n  width: 100%;\n}\n.aui-form-item[data-v-04f70b64] {\n  margin-left: 30px;\n}\n.aui-form-item1[data-v-04f70b64] {\n  margin-left: 10px;\n}\n.box2-button[data-v-04f70b64] {\n  width: 80px;\n}\n.aui-card[data-v-04f70b64] {\n  overflow: inherit;\n}\n',""])},ECoB:function(e,a,t){"use strict";var i=t("AA3o"),r=t.n(i);a.a=function e(){r()(this,e),this.data={BusiOper:"Q",UserNum:""},this.BusiDataKey="SelectBriefBranch",this.TransServiceCode="ib-dbcomm/dbComm"}},FiRX:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=t("0oES"),r=t("pADA"),n=t("tzsN"),s=t("syAl"),o=t("AA3o"),u=t.n(o),m=function e(){u()(this,e),this.data={OperType:"UL",UserNum:"",TlrNo:""},this.CommCode="IBUserPermissionsManagement",this.SceneCode="UserSpecialPermission",this.TransServiceCode="mg-afaservices-upm/userSpeacialPermission"},c=function e(){u()(this,e),this.data={OperType:"BL",BranchNum:"",TlrNo:""},this.CommCode="IBUserPermissionsManagement",this.SceneCode="UserSpecialPermission",this.TransServiceCode="mg-afaservices-upm/userSpeacialPermission"},l=function e(){u()(this,e),this.data={OperType:"Q",Type:"",Num:"",AppNum:"",MenuViewNum:"",BranchNum:""},this.CommCode="IBUserPermissionsManagement",this.SceneCode="UserSpecialPermission",this.TransServiceCode="mg-afaservices-upm/userSpeacialPermission"},p=function e(){u()(this,e),this.data={OperType:"C",Type:"",Num:"",AppNum:"",MenuViewNum:"",BranchNum:"",MenuNum:[]},this.CommCode="IBUserPermissionsManagement",this.SceneCode="UserSpecialPermission",this.TransServiceCode="mg-afaservices-upm/userSpeacialPermission"},h=function e(){u()(this,e),this.data={OperType:"M",AssoCate:"",Num:"",AppNum:"",MenuViewNum:"",postList:[]},this.CommCode="IBUserPermissionsManagement",this.SceneCode="UserSpecialPermission",this.TransServiceCode="mg-afaservices-upm/userSpeacialPermission"},d=t("QdxY"),f=t("ECoB"),g={name:"user-info-manage",components:{selectTree:n.a},data:function(){return{operTypeList:[{name:"机构特殊权限维护",value:"0"},{name:"用户特殊权限维护",value:"1"}],props:{label:"menuname",children:"children"},pageSize:void 0,appList:[],menuViewList:[],branchList:[],treeList:[],checkList:[],addTable:[],delTable:[],operType:"0",operstate:!0,form:{userNum:"",userName:"",branchId:"",appNum:"",menuView:"",branchNum:"",branchName:""},menuMap:{},currentRow:[],currentPage:1,currentPage1:1,totalRcrdNum:0,totalRcrdNum1:0,tableData:[],loading:!1,total:0,checkedUser:!1,isDisabledDel:!1,confirmstate:!1,querystate:!1,rulesBase:{branchNum:[{required:!0,message:"请输入机构编号",trigger:"blur"}],userNum:[{required:!0,message:"请输入用户编号",trigger:"blur"}],appNum:[{required:!0,message:"请输入应用编号",trigger:"blur"}]}}},computed:{tableDataPage:function(){return this.addTable.slice((this.currentPage-1)*this.pageSize,this.currentPage*this.pageSize)},tableDataPage1:function(){return this.delTable.slice((this.currentPage1-1)*this.pageSize,this.currentPage1*this.pageSize)}},created:function(){this.pageSize=s.a.get("PageSize")},methods:{changePage:function(e){this.currentPage=e},changePage1:function(e){this.currentPage1=e},operTypeChange:function(){},submit:function(){var e=this;this.loading=!0;var a=new h;a.data.AssoCate=this.operType,a.data.Num=this.form.userNum||this.form.branchNum,a.data.AppNum=this.form.appNum,a.data.MenuViewNum=this.form.menuView;var t=[],r=this.addTable||[],n=this.delTable||[];r.forEach(function(a){t.push({TranCode:a.menunum,PrivlegeType:"0",AssoInfo:e.form.userNum||e.form.branchNum,AppNum:e.form.appNum,MenuViewNum:e.form.menuView,AssoCate:e.operType})}),n.forEach(function(a){t.push({TranCode:a.menunum,PrivlegeType:"1",AssoInfo:e.form.userNum||e.form.branchNum,AppNum:e.form.appNum,MenuViewNum:e.form.menuView,AssoCate:e.operType})}),a.data.postList=t,Object(i.a)(a).then(function(a){e.$aui.message.show({type:"success",message:"保存成功"}),e.querystate=!1,e.confirmstate=!1,e.loading=!1}).catch(function(a){e.$aui.message.show({type:"warning",message:"保存失败"}),e.querystate=!1,e.confirmstate=!1,e.loading=!1})},dataClear:function(){this.confirmstate=!1,this.querystate=!1,this.treeList=[],this.checkList=[],this.addTable=[],this.delTable=[],this.menuMap={}},userLoad:function(){var e=this;if(""!=this.form.userNum){this.loading=!0,this.form.userName="",this.appList=[],this.menuViewList=[],this.form.appNum="",this.form.menuView="",this.branchList=[],this.form.branchId="",this.dataClear();var a=new m;a.data.UserNum=this.form.userNum,a.data.TlrNo=this.$store.getters.UserNum,Object(i.a)(a).then(function(a){e.appList=a.RspInfo.pageList||[],e.form.userName=a.RspInfo.pageList1[0].username||"",e.loadBranch(e.form.userNum)}).catch(function(a){e.form.userNum="",e.$aui.message.show({type:"warning",message:"用户不存在!"}),e.loading=!1})}},loadBranch:function(e){var a=this,t=new f.a;t.data.UserNum=e,t.data.Date=r.a.getNowTime(0),Object(i.a)(t).then(function(e){a.branchList=e.RspInfo.Result||[],a.loading=!1}).catch(function(e){a.form.branchNum="",a.$aui.message.show({type:"warning",message:e.SYS_HEAD.ReturnMessage}),a.loading=!1})},confirm:function(){var e=this;this.loading=!0;var a=new p;a.data.Type=this.operType,a.data.Num=this.form.userNum||this.form.branchNum,a.data.AppNum=this.form.appNum,a.data.MenuViewNum=this.form.menuView,a.data.BranchNum=this.form.branchId;var t=[];Object(i.a)(a).then(function(a){(a.RspInfo.pageList1||[]).forEach(function(e){t.push(e.entynum)});var i=[],r=[],n=[];(e.$refs.tree.getCheckedNodes()||[]).forEach(function(a){"02"==a.menutype&&(i.push(a.menunum),t.indexOf(a.menunum)<0&&e.menuMap[a.menunum]&&r.push({menunum:a.menunum,menuname:a.menuname}))}),t.forEach(function(a){i.indexOf(a)<0&&e.menuMap[a]&&n.push({menunum:a,menuname:e.menuMap[a]})}),e.addTable=r,e.delTable=n,e.loading=!1,e.confirmstate=!0,e.loading=!1}).catch(function(a){e.loading=!1})},branchLoad:function(){var e=this;if(""!=this.form.branchNum){this.loading=!0,this.form.branchName="",this.appList=[],this.menuViewList=[],this.form.appNum="",this.form.menuView="",this.dataClear();var a=new c;a.data.BranchNum=this.form.branchNum,a.data.TlrNo=this.$store.getters.UserNum,Object(i.a)(a).then(function(a){e.appList=a.RspInfo.pageList||[],e.form.branchName=a.RspInfo.pageList1[0].branchname||"",e.loading=!1}).catch(function(a){e.form.branchNum="",e.$aui.message.show({type:"warning",message:"机构不存在!"}),e.loading=!1})}},menuViewLoad:function(){var e=this;this.loading=!0,this.menuViewList=[],this.form.menuView="",this.dataClear();var a=new d.a;a.data.AppNum=this.form.appNum,Object(i.a)(a).then(function(a){e.menuViewList=a.RspInfo.Result||[],e.loading=!1}).catch(function(a){e.loading=!1,console.error("查询错误",a)})},resetForm:function(e){this.form={userNum:"",userName:"",branchId:"",appNum:"",menuView:"",branchNum:"",branchName:""},this.appList=[],this.menuViewList=[],this.branchList=[],this.dataClear()},handleCommand:function(e){"detail"==e?this.openDetail():"tradeBind"==e&&this.openTradeBind()},checkUserList:function(){var e=this;this.$refs.form.validate(function(a){if(a){e.$refs.form.clearValidate(),e.loading=!0,e.dataClear();var t=new l;t.data.Type=e.operType,t.data.Num=e.form.userNum||e.form.branchNum,t.data.AppNum=e.form.appNum,t.data.MenuViewNum=e.form.menuView,t.data.BranchNum=e.form.branchId,Object(i.a)(t).then(function(a){e.loading=!1;var t=a.RspInfo.pageList||[],i={};t.forEach(function(a){e.$set(i,a.menunum,a.menuname)}),e.menuMap=i,e.treeList=r.a.formatTreeData(t,"menunum","parentmenunum");var n=[];(a.RspInfo.pageList1||[]).forEach(function(e){n.push(e.entynum)}),e.checkList=n;for(var s=[],o=[],u=0,m=a.RspInfo.pageList2?a.RspInfo.pageList2.length:0;u<m;u++){var c=a.RspInfo.pageList2[u];"0"==c.privlegetype?s.push(c):o.push(c)}e.delTable=o,e.addTable=s,e.querystate=!0}).catch(function(a){e.loading=!1,e.$aui.message.show({type:"warning",message:a.SYS_HEAD.ReturnMessage})})}})},handleCurrentChange:function(e){this.currentRow=e[0],1==e.length?(this.checkedUser=!0,this.isDisabledDel=!0):e.length>1?(this.checkedUser=!1,this.isDisabledDel=!0):(this.checkedUser=!1,this.isDisabledDel=!1)}},watch:{operType:function(e,a){this.form={userNum:"",userName:"",branchId:"",appNum:"",menuView:"",branchNum:"",branchName:""},this.appList=[],this.menuViewList=[],this.branchList=[],this.dataClear(),this.operstate=!this.operstate,void 0!=this.$refs.form&&(this.$refs.form.clearValidate(),this.$refs.form.resetFields())}}},b={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":"加载中。。。"}},[t("aui-row",[t("aui-col",[t("aui-card",[t("aui-form",{ref:"form",attrs:{model:e.form,size:"mini","label-position":"top",rules:e.rulesBase}},[t("aui-row",{attrs:{gutter:10}},[t("aui-col",{attrs:{lg:4,md:6}},[t("aui-form-item",{attrs:{label:"操作类型",prop:"operType"}},[t("aui-select",{attrs:{placeholder:""},on:{change:e.operTypeChange},model:{value:e.operType,callback:function(a){e.operType=a},expression:"operType"}},e._l(e.operTypeList,function(e){return t("aui-option",{key:e.value,attrs:{label:e.name,value:e.value}})}))],1)],1),e._v(" "),e.operstate?t("aui-col",{attrs:{lg:4,md:6}},[t("aui-form-item",{attrs:{label:"机构编号",prop:"branchNum"}},[t("aui-input",{attrs:{placeholder:"请输入机构编号"},on:{blur:e.branchLoad},model:{value:e.form.branchNum,callback:function(a){e.$set(e.form,"branchNum",a)},expression:"form.branchNum"}})],1)],1):e._e(),e._v(" "),e.operstate?t("aui-col",{attrs:{lg:4,md:6}},[t("aui-form-item",{attrs:{label:"机构名称",prop:"branchName"}},[t("aui-input",{attrs:{disabled:"",placeholder:"请输入机构名称"},model:{value:e.form.branchName,callback:function(a){e.$set(e.form,"branchName",a)},expression:"form.branchName"}})],1)],1):e._e(),e._v(" "),e.operstate?e._e():t("aui-col",{attrs:{lg:4,md:6}},[t("aui-form-item",{attrs:{label:"用户编号",prop:"userNum"}},[t("aui-input",{attrs:{placeholder:"请输入用户编号"},on:{blur:e.userLoad},model:{value:e.form.userNum,callback:function(a){e.$set(e.form,"userNum",a)},expression:"form.userNum"}})],1)],1),e._v(" "),e.operstate?e._e():t("aui-col",{attrs:{lg:4,md:6}},[t("aui-form-item",{attrs:{label:"用户名称",prop:"userName"}},[t("aui-input",{attrs:{disabled:"",placeholder:"请输入用户名称"},model:{value:e.form.userName,callback:function(a){e.$set(e.form,"userName",a)},expression:"form.userName"}})],1)],1),e._v(" "),t("aui-col",{attrs:{lg:4,md:6}},[t("aui-form-item",{attrs:{label:"应用编号",prop:"appNum"}},[t("aui-select",{attrs:{placeholder:""},on:{change:e.menuViewLoad},model:{value:e.form.appNum,callback:function(a){e.$set(e.form,"appNum",a)},expression:"form.appNum"}},e._l(e.appList,function(e){return t("aui-option",{key:e.appnum,attrs:{label:e.appnum+"-"+e.appname,value:e.appnum}})}))],1)],1),e._v(" "),t("aui-col",{attrs:{lg:4,md:6}},[t("aui-form-item",{attrs:{label:"菜单视图编号",prop:"menuView"}},[t("aui-select",{attrs:{placeholder:""},on:{change:e.dataClear},model:{value:e.form.menuView,callback:function(a){e.$set(e.form,"menuView",a)},expression:"form.menuView"}},e._l(e.menuViewList,function(e){return t("aui-option",{key:e.value,attrs:{label:e.MenuViewNum+"-"+e.MenuViewName,value:e.MenuViewNum}})}))],1)],1),e._v(" "),e.operstate?e._e():t("aui-col",{attrs:{lg:4,md:6}},[t("aui-form-item",{attrs:{label:"机构号",prop:"branchID"}},[t("aui-select",{attrs:{filterable:"",placeholder:""},on:{change:e.dataClear},model:{value:e.form.branchId,callback:function(a){e.$set(e.form,"branchId",a)},expression:"form.branchId"}},e._l(e.branchList,function(e){return t("aui-option",{key:e.value,attrs:{label:e.BranchNum+"-"+e.BranchName,value:e.BranchNum}})}))],1)],1)],1),e._v(" "),t("aui-row",{attrs:{gutter:10}},[t("aui-col",{staticClass:"searchBtnMarginTop",attrs:{lg:2,md:3}},[t("aui-button",{attrs:{type:"primary",icon:"aui-icon-search",loading:e.loading,size:"mini"},on:{click:e.checkUserList}},[e._v("查询")])],1),e._v(" "),t("aui-col",{staticClass:"searchBtnMarginTop",attrs:{lg:9,md:3}},[t("aui-button",{attrs:{type:"warning",size:"mini",icon:"aui-icon-refresh"},on:{click:function(a){e.resetForm("form")}}},[e._v("重置")])],1),e._v(" "),t("aui-col",{staticClass:"searchBtnMarginTop",attrs:{lg:11,md:3}},[t("aui-button",{attrs:{type:"primary",size:"mini",icon:"aui-icon-success",disabled:!e.querystate},on:{click:function(a){e.confirm()}}},[e._v("确认")])],1),e._v(" "),t("aui-col",{staticClass:"searchBtnMarginTop",attrs:{lg:1,md:3}},[t("aui-button",{attrs:{type:"primary",size:"mini",icon:"aui-icon-check",disabled:!e.confirmstate},on:{click:function(a){e.submit()}}},[e._v("提交")])],1)],1)],1)],1)],1)],1),e._v(" "),t("aui-row",{attrs:{gutter:10}},[t("aui-col",{attrs:{span:8}},[t("aui-card",{staticStyle:{margin:"10px 0 0 0"}},[t("div",{staticClass:"clearfix",staticStyle:{"min-height":"390px"},attrs:{slot:"header"},slot:"header"},[t("span",[e._v("交易菜单")]),e._v(" "),t("aui-tree",{ref:"tree",attrs:{data:e.treeList,props:e.props,"show-checkbox":"","default-checked-keys":e.checkList,"node-key":"menunum"}})],1)])],1),e._v(" "),t("aui-col",{attrs:{span:8}},[t("aui-card",{staticStyle:{margin:"10px 0 0 0"}},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("span",[e._v("添加权限")])]),e._v(" "),t("aui-table",{ref:"table",staticClass:"tableMarginTop",staticStyle:{"min-height":"390px"},attrs:{data:e.tableDataPage,border:"","highlight-current-row":"","max-height":"390","header-row-class-name":"tableHeaderClass"}},[t("aui-table-column",{attrs:{prop:"menunum",label:"菜单编号"}}),e._v(" "),t("aui-table-column",{attrs:{prop:"menuname",label:"菜单名称"}})],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:this.tableData,expression:"this.tableData"}]},[t("aui-pagination",{attrs:{"current-page":e.currentPage,background:"","page-size":e.pageSize,layout:"total, prev, pager, next, jumper",total:e.addTable.length},on:{"current-change":e.changePage}})],1)],1)],1),e._v(" "),t("aui-col",{attrs:{span:8}},[t("aui-card",{staticStyle:{margin:"10px 0 0 0"}},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("span",[e._v("删除权限")])]),e._v(" "),t("aui-table",{ref:"table",staticClass:"tableMarginTop",staticStyle:{"min-height":"390px"},attrs:{data:e.tableDataPage1,border:"","highlight-current-row":"","max-height":"390","header-row-class-name":"tableHeaderClass"}},[t("aui-table-column",{attrs:{prop:"menunum",label:"菜单编号"}}),e._v(" "),t("aui-table-column",{attrs:{prop:"menuname",label:"菜单名称"}})],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:this.tableData,expression:"this.tableData"}]},[t("aui-pagination",{attrs:{"current-page":e.currentPage1,background:"","page-size":e.pageSize,layout:"total, prev, pager, next, jumper",total:e.delTable.length},on:{"current-change":e.changePage1}})],1)],1)],1)],1)],1)},staticRenderFns:[]};var N=t("/Xao")(g,b,!1,function(e){t("Fppc")},"data-v-04f70b64",null);a.default=N.exports},Fppc:function(e,a,t){var i=t("33nP");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);t("8bSs")("4eb348ea",i,!0)}});