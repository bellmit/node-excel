webpackJsonp([146],{Ftva:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("0oES"),n=i("0VOF"),s=i("syAl"),r=(i("2JIZ"),i("AA3o")),o=i.n(r),u=function e(){o()(this,e),this.data={Brno:""},this.CommCode="CQParaManage",this.SceneCode="BsnSvcTmQuy",this.TransServiceCode="mg-afaservices-cq/busiServiceTimeQuery"},c=function e(){o()(this,e),this.data={Brno:"",data:""},this.CommCode="CQParaManage",this.SceneCode="SvcPrdMnt",this.TransServiceCode="mg-afaservices-cq/busiServiceTimeSubmit"},l=i("pADA"),m={name:"busiServiceTime",components:{selectTree:i("tzsN").a},data:function(){return{ruleTypeMap:{"01":"叫号规则","02":"排队机界面"},currentRow:[],QueryForm:{branchNum:[]},brnoList:[],busiStatusMap:{},busiAttrMap:{},total:void 0,busiTypeList:[],brnoMap:{},permission:{},loading:!1,isDisabledDel:!1,currentPage:1,pageSize:void 0,rules:{branchNum:[{required:!0,message:"请选择机构编号",trigger:"change"}]}}},created:function(){this.pageSize=s.a.get("PageSize"),this.busiStatusMap=s.a.get("Status"),this.busiAttrMap=s.a.get("BsAttr1"),this.queryBranchNum()},watch:{"QueryForm.branchNum":function(e){this.$refs.QueryForm.clearValidate()}},computed:{},methods:{queryBranchNum:function(){var e=this;this.loading=!0;var t=new n.a;t.data.orgno=this.$store.getters.BranchNum,Object(a.a)(t).then(function(t){e.loading=!1,e.brnoMap=t.RspInfo.orgMap||{},e.branchNum=t.RspInfo.Result||[],e.permission=l.a.objArray2Hash(e.branchNum,"orgno"),e.brnoList=l.a.formatTreeData(e.branchNum,"orgno","superno"),e.QueryForm.branchNum.push(e.brnoList[0].orgno)}).catch(function(t){e.loading=!1,e.$aui.message.show({type:"warning",message:t.SYS_HEAD.ReturnMessage}),console.error("查询错误",t)})},dataFormat:function(e,t){if("BsID"==t.property)return e.BsID+"-"+e.BsName},checkPermission:function(){if(this.permission[this.QueryForm.branchNum])if(0===this.busiTypeList.length)this.$aui.message.show({type:"warning",message:"无提交信息!"});else{for(var e=!0,t="",i=0,a=this.busiTypeList.length;i<a;i++){t="";for(var n=1;n<8;n++)this.busiTypeList[i]["Cntnt"+n]&&(t+=n);if(this.busiTypeList[i].Week=t,""!==this.busiTypeList[i].ServeTime&&!this.busiTypeList[i].ServeTime.match("^((([01][0-9])|(2[0-3])):[0-5][0-9]-(([01][0-9])|(2[0-3])):[0-5][0-9])(;((([01][0-9])|(2[0-3])):[0-5][0-9]-(([01][0-9])|(2[0-3])):[0-5][0-9]))?$"))return this.$aui.message.show({type:"warning",message:this.busiTypeList[i].BsID+"业务服务时段格式有误!"}),e=!1,!1;this.busiTypeList[i].HolidayServeTime=this.busiTypeList[i].ServeTime}e&&this.submit()}else this.$aui.message.show({type:"warning",message:"权限不足,无法修改！"})},submit:function(){var e=this,t=new c;t.data.Brno=this.QueryForm.branchNum[0],t.data.data=this.busiTypeList,Object(a.a)(t).then(function(t){e.loading=!1,e.$aui.message.show({type:"success",message:"修改成功"})}).catch(function(t){e.$aui.message.show({type:"warning",message:"错误信息："+t.SYS_HEAD.ReturnMessage}),e.loading=!1,console.log(t)})},resetForm:function(){this.busiTypeList=[],this.total=0,this.$refs.QueryForm.resetFields()},query:function(){var e=this;this.$refs.QueryForm.validate(function(t){if(t){e.loading=!0;var i=new u;i.data.Brno=e.QueryForm.branchNum[0],Object(a.a)(i).then(function(t){e.loading=!1,e.busiTypeList=t.RspInfo.data||[],e.busiTypeList.forEach(function(t){""!=t.ServeTime&&void 0!=t.ServeTime||(t.ServeTime="08:00-18:00");for(var i=1;i<8;i++)void 0!==t.Week&&-1!==t.Week.indexOf(i+"")?e.$set(t,"Cntnt"+i,!0):e.$set(t,"Cntnt"+i,!1)}),0===e.busiTypeList.length&&e.$aui.message.show({type:"warning",message:"无业务类型,请添加!"})}).catch(function(t){e.$aui.message.show({type:"warning",message:"请求失败，错误码:"+t.SYS_HEAD.ReturnCode+"，错误信息："+t.SYS_HEAD.ReturnMessage}),e.loading=!1,console.log(t)})}})},handleCurrentChange:function(e){this.currentPage=e,this.query()},selectList:function(e){1==e.length?(this.isDisabledDel=!0,this.currentRow=e[0]):this.isDisabledDel=!1}}},h={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":"加载中。。。"}},[i("aui-card",[i("aui-form",{ref:"QueryForm",attrs:{model:e.QueryForm,rules:e.rules,size:"mini","label-position":"top"}},[i("aui-row",{attrs:{gutter:10}},[i("aui-col",{attrs:{lg:4,md:6}},[i("aui-form-item",{attrs:{label:"机构编号",prop:"branchNum"}},[i("select-tree",{staticStyle:{width:"170px"},attrs:{"single-check":!0,props:{id:"orgno",label:"cname",children:"children"},"tree-data":e.brnoList,placeholder:"请选择机构"},model:{value:e.QueryForm.branchNum,callback:function(t){e.$set(e.QueryForm,"branchNum",t)},expression:"QueryForm.branchNum"}})],1)],1),e._v(" "),i("aui-col",{staticClass:"searchBtnMarginTop",attrs:{lg:2,md:3}},[i("aui-button",{attrs:{type:"primary",size:"mini",icon:"aui-icon-search"},on:{click:e.query}},[e._v("查询")])],1),e._v(" "),i("aui-col",{staticClass:"searchBtnMarginTop",attrs:{lg:2,md:3}},[i("aui-button",{attrs:{type:"warning",size:"mini",icon:"aui-icon-refresh"},on:{click:function(t){e.resetForm("QueryForm")}}},[e._v("重置")])],1)],1)],1)],1),e._v(" "),i("aui-card",{staticStyle:{"margin-top":"10px"}},[i("aui-table",{ref:"busiTypeList",staticClass:"tableMarginTop",staticStyle:{"min-height":"390px"},attrs:{data:e.busiTypeList,border:"","header-row-class-name":"tableHeaderClass"},on:{"selection-change":e.selectList}},[i("aui-table-column",{attrs:{prop:"BsID",formatter:e.dataFormat,label:"业务类型","min-width":"187px"}}),e._v(" "),i("aui-table-column",{attrs:{label:"星期一","min-width":"57px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("aui-checkbox",{model:{value:t.row.Cntnt1,callback:function(i){e.$set(t.row,"Cntnt1",i)},expression:"scope.row.Cntnt1"}})]}}])}),e._v(" "),i("aui-table-column",{attrs:{label:"星期二","min-width":"57px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("aui-checkbox",{model:{value:t.row.Cntnt2,callback:function(i){e.$set(t.row,"Cntnt2",i)},expression:"scope.row.Cntnt2"}})]}}])}),e._v(" "),i("aui-table-column",{attrs:{label:"星期三","min-width":"57px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("aui-checkbox",{model:{value:t.row.Cntnt3,callback:function(i){e.$set(t.row,"Cntnt3",i)},expression:"scope.row.Cntnt3"}})]}}])}),e._v(" "),i("aui-table-column",{attrs:{label:"星期四","min-width":"57px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("aui-checkbox",{model:{value:t.row.Cntnt4,callback:function(i){e.$set(t.row,"Cntnt4",i)},expression:"scope.row.Cntnt4"}})]}}])}),e._v(" "),i("aui-table-column",{attrs:{label:"星期五","min-width":"57px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("aui-checkbox",{model:{value:t.row.Cntnt5,callback:function(i){e.$set(t.row,"Cntnt5",i)},expression:"scope.row.Cntnt5"}})]}}])}),e._v(" "),i("aui-table-column",{attrs:{label:"星期六","min-width":"57px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("aui-checkbox",{model:{value:t.row.Cntnt6,callback:function(i){e.$set(t.row,"Cntnt6",i)},expression:"scope.row.Cntnt6"}})]}}])}),e._v(" "),i("aui-table-column",{attrs:{label:"星期日","min-width":"57px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("aui-checkbox",{model:{value:t.row.Cntnt7,callback:function(i){e.$set(t.row,"Cntnt7",i)},expression:"scope.row.Cntnt7"}})]}}])}),e._v(" "),i("aui-table-column",{attrs:{label:"服务时段","min-width":"107px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("aui-input",{attrs:{placeholder:"服务时段"},model:{value:t.row.ServeTime,callback:function(i){e.$set(t.row,"ServeTime",i)},expression:"scope.row.ServeTime"}})]}}])})],1),e._v(" "),i("div",{staticStyle:{"text-align":"center","margin-top":"10px"}},[i("aui-button",{attrs:{type:"primary",icon:"aui-icon-check"},on:{click:e.checkPermission}},[e._v("提交")])],1)],1)],1)])},staticRenderFns:[]};var p=i("/Xao")(m,h,!1,function(e){i("VSC4")},"data-v-1c43dea4",null);t.default=p.exports},MlJU:function(e,t,i){(e.exports=i("BkJT")(!1)).push([e.i,"",""])},VSC4:function(e,t,i){var a=i("MlJU");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);i("8bSs")("4b62e3fa",a,!0)}});