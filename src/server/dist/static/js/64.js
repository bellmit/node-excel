webpackJsonp([64],{"/vtf":function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e("0oES"),r=e("AA3o"),o=e.n(r),s=function t(){o()(this,t),this.data={OperTp:"A",Brno:"",DefaultFlag:"",BsServTimeFlag:"1",TicketTplNo:"",SoundboxNo:"",SoundboxStatus:"1",CallVoice:"",QueInterfaceID:"",QuePswd:"",IsDplyWait:"",MainPrompt:"",StopPrompt:"",ShutTime:"",ChannelCode:"02",TradeCode:"QueueParam"},this.CommCode="CQParaManage",this.SceneCode="QuegParaMgr",this.TransServiceCode="mg-afaservices-cq/queueParamSet"},n=function t(){o()(this,t),this.data={OperTp:"M",ParamID:"",Brno:"",DefaultFlag:"",BsServTimeFlag:"1",TicketTplNo:"",SoundboxNo:"",SoundboxStatus:"1",CallVoice:"",QueInterfaceID:"",QuePswd:"",IsDplyWait:"",MainPrompt:"",StopPrompt:"",ShutTime:"",TradeCode:"QueueParam"},this.CommCode="CQParaManage",this.SceneCode="QuegParaMgr",this.TransServiceCode="mg-afaservices-cq/queueParamSet"},l=e("pADA"),u=e("fCv1"),c=e("syAl"),p=function t(){o()(this,t),this.data={Brno:"",QueryType:"1"},this.CommCode="CQParaManage",this.SceneCode="SmlTictPlCfgQuy",this.TransServiceCode="mg-afaservices-cq/ticketIdLoad"},m=function t(){o()(this,t),this.data={Brno:"",RuleTp:"02",BusiOper:"Q1"},this.BusiDataKey="sel_CQMS_RULE1",this.TransServiceCode="ib-dbcomm/dbComm"},d={props:{option:Object},data:function(){return{loading:!1,appId:[],isDplyWaitList:[],defaultFlagList:[],ticketTplNoList:[],queInterfaceIDList:[],callVoiceList:[],defaultList:[],form:{paramId:"",callVoice:[],ticketTplNo:"",brno:"",queInterfaceID:"",defaultFlag:"0",isDplyWait:"0",mainPrompt:"",stopPrompt:""},rules:{brno:[{required:!0,message:"请选择机构编号",trigger:"change"}],defaultFlag:[{required:!0,message:"请选择是否默认标志",trigger:"change"}],callVoice:[{type:"array",required:!0,message:"请选择语音呼叫顺序",trigger:"change"}],isDplyWait:[{required:!0,message:"请选择是否显示等待人数",trigger:"change"}],queInterfaceID:[{required:!0,message:"请选择排队机界面ID",trigger:"change"}],mainPrompt:[{validator:Object(u.h)(100),trigger:"blur"},{validator:u.l,trigger:"blur"}],stopPrompt:[{validator:Object(u.h)(100),trigger:"blur"},{validator:u.l,trigger:"blur"}]}}},created:function(){this.defaultList=l.a.objToArray(c.a.get("isDefault")),this.callVoiceList=l.a.objToArray(c.a.get("callVoice")),this.isDplyWaitList=l.a.objToArray(c.a.get("isShow"))},methods:{openUpdate:function(){"2"==this.option.mark?this.setData():this.$refs.form&&this.$refs.form.clearValidate()},setData:function(){this.form.brno=this.option.currentRow.Brno,this.ticketLoad(),this.form.paramId=this.option.currentRow.ParamID,this.form.isDplyWait=this.option.currentRow.IsDplyWait,this.form.stopPrompt=this.option.currentRow.StopPrompt,this.form.mainPrompt=this.option.currentRow.MainPrompt,this.form.defaultFlag=this.option.currentRow.DefaultFlag,this.form.ticketTplNo=this.option.currentRow.TicketTplNo,this.form.queInterfaceID=this.option.currentRow.QueInterfaceID,this.form.callVoice=this.option.currentRow.CallVoice.split(",")},closeUpdete:function(){this.$refs.form.resetFields(),this.$refs.form.clearValidate()},ticketLoad:function(){var t=this;this.loading=!0,this.form.ticketTplNo="",this.form.queInterfaceID="";var a=new p,e=new m;a.data.Brno=this.form.brno,a.data.PageSize="99999",a.data.CurtPage="1",a.data.StartRows="0",e.data.Brno=this.form.brno,Object(i.a)(a).then(function(a){t.ticketTplNoList=a.RspInfo.data||[],t.ticketTplNoList.unshift({TicketTplNo:"",TplName:"默认-"})}).catch(function(a){t.loading=!1}),Object(i.a)(e).then(function(a){t.loading=!1,t.queInterfaceIDList=a.RspInfo.Result||[]}).catch(function(a){t.loading=!1})},ItemUpdate:function(){var t=this;this.$refs.form.validate(function(a){if(!a)return t.$aui.message.show({type:"warning",message:"请输入合法的数据！"}),!1;t.loading=!0;var e="1"==t.option.mark?new s:new n;e.data.Brno=t.form.brno,e.data.ParamID=t.form.paramId,e.data.TicketTplNo=t.form.ticketTplNo,e.data.QueInterfaceID=t.form.queInterfaceID,e.data.DefaultFlag=t.form.defaultFlag,e.data.IsDplyWait=t.form.isDplyWait,e.data.MainPrompt=t.form.mainPrompt,e.data.StopPrompt=t.form.stopPrompt,e.data.CallVoice=t.form.callVoice.join(","),Object(i.a)(e).then(function(a){t.$emit("refreshTable"),t.option.isShow=!1;var e="1"==t.option.mark?"创建":"修改";t.$aui.message.show({type:"success",message:e+"成功!"}),t.loading=!1}).catch(function(a){t.$aui.message.show({type:"warning",message:a.SYS_HEAD.ReturnMessage+"!"}),t.loading=!1})})}}},h={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("aui-dialog",{attrs:{title:t.option.title,visible:t.option.isShow,width:"800px","close-on-click-modal":!1},on:{"update:visible":function(a){t.$set(t.option,"isShow",a)},show:t.openUpdate,hide:t.closeUpdete}},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[e("aui-card",[e("aui-form",{ref:"form",attrs:{model:t.form,size:"mini",rules:t.rules,"label-width":"140px","label-position":"right"}},[e("aui-row",{attrs:{gutter:40}},[e("aui-col",{attrs:{span:12}},[t.option.isDisabled?e("aui-form-item",{attrs:{label:"参数ID:",prop:"paramId"}},[e("aui-input",{attrs:{disabled:!0},model:{value:t.form.paramId,callback:function(a){t.$set(t.form,"paramId",a)},expression:"form.paramId"}})],1):t._e()],1),t._v(" "),e("aui-col",{attrs:{span:12}},[e("aui-form-item",{attrs:{label:"机构编号:",prop:"brno"}},[e("aui-select",{attrs:{disabled:t.option.isDisabled,filterable:"",placeholder:"请选择机构编号"},on:{change:t.ticketLoad},model:{value:t.form.brno,callback:function(a){t.$set(t.form,"brno",a)},expression:"form.brno"}},t._l(t.option.branchNum,function(t){return e("aui-option",{key:t.orgno,attrs:{label:t.cname,value:t.orgno,disabled:t.disabled}})}))],1)],1)],1),t._v(" "),e("aui-row",{attrs:{gutter:40}},[e("aui-col",{attrs:{span:12}},[e("aui-form-item",{attrs:{label:"是否默认标志:",prop:"defaultFlag"}},[e("aui-select",{attrs:{placeholder:"请选择是否默认标志"},model:{value:t.form.defaultFlag,callback:function(a){t.$set(t.form,"defaultFlag",a)},expression:"form.defaultFlag"}},t._l(t.defaultList,function(t){return e("aui-option",{key:t.value,attrs:{label:t.label,value:t.value,disabled:t.disabled}})}))],1)],1),t._v(" "),e("aui-col",{attrs:{span:12}},[e("aui-form-item",{attrs:{label:"小票模板编号:",prop:"ticketTplNo"}},[e("aui-select",{attrs:{placeholder:"默认小票模板"},model:{value:t.form.ticketTplNo,callback:function(a){t.$set(t.form,"ticketTplNo",a)},expression:"form.ticketTplNo"}},t._l(t.ticketTplNoList,function(t){return e("aui-option",{key:t.TicketTplNo,attrs:{label:t.TicketTplNo+"-"+t.TplName,value:t.TicketTplNo,disabled:t.disabled}})}))],1)],1)],1),t._v(" "),e("aui-row",{attrs:{gutter:40}},[e("aui-col",{attrs:{span:12}},[e("aui-form-item",{attrs:{label:"排队机界面ID",prop:"queInterfaceID"}},[e("aui-select",{attrs:{placeholder:"请选择排队机界面ID"},model:{value:t.form.queInterfaceID,callback:function(a){t.$set(t.form,"queInterfaceID",a)},expression:"form.queInterfaceID"}},t._l(t.queInterfaceIDList,function(t){return e("aui-option",{key:t.RuleId,attrs:{label:t.RuleName,value:t.RuleId,disabled:t.disabled}})}))],1)],1),t._v(" "),e("aui-col",{attrs:{span:12}},[e("aui-form-item",{attrs:{label:"语音呼叫顺序:",prop:"callVoice"}},[e("aui-select",{attrs:{multiple:"",placeholder:"请选择语音呼叫顺序"},model:{value:t.form.callVoice,callback:function(a){t.$set(t.form,"callVoice",a)},expression:"form.callVoice"}},t._l(t.callVoiceList,function(t){return e("aui-option",{key:t.value,attrs:{label:t.label,value:t.value,disabled:t.disabled}})}))],1)],1)],1),t._v(" "),e("aui-row",{attrs:{gutter:40}},[e("aui-col",{attrs:{span:12}},[e("aui-form-item",{attrs:{label:"是否显示等待人数:",prop:"isDplyWait"}},[e("aui-select",{attrs:{placeholder:"请选择小票模板"},model:{value:t.form.isDplyWait,callback:function(a){t.$set(t.form,"isDplyWait",a)},expression:"form.isDplyWait"}},t._l(t.isDplyWaitList,function(t){return e("aui-option",{key:t.value,attrs:{label:t.label,value:t.value,disabled:t.disabled}})}))],1)],1),t._v(" "),e("aui-col",{attrs:{span:12}},[e("aui-form-item",{attrs:{label:"主界面提示信息:",prop:"mainPrompt"}},[e("aui-input",{attrs:{placeholder:"请输入主界面提示信息"},model:{value:t.form.mainPrompt,callback:function(a){t.$set(t.form,"mainPrompt",a)},expression:"form.mainPrompt"}})],1)],1),t._v(" "),e("aui-col",{attrs:{span:12}},[e("aui-form-item",{attrs:{label:"暂停服务提示信息:",prop:"stopPrompt"}},[e("aui-input",{attrs:{placeholder:"请输入暂停服务提示信息"},model:{value:t.form.stopPrompt,callback:function(a){t.$set(t.form,"stopPrompt",a)},expression:"form.stopPrompt"}})],1)],1)],1)],1)],1),t._v(" "),e("aui-row",{staticStyle:{margin:"20px 0","text-align":"right"}},[e("aui-button",{attrs:{size:"mini"},on:{click:function(a){t.option.isShow=!1}}},[t._v("返回")]),t._v(" "),e("aui-button",{attrs:{type:"primary",size:"mini"},on:{click:t.ItemUpdate}},[t._v("确定")])],1)],1)])],1)},staticRenderFns:[]};var f=e("/Xao")(d,h,!1,function(t){e("1G+F")},null,null).exports,g=e("0VOF"),b=function t(){o()(this,t),this.data={OperTp:"D",Brno:"",ParamID:"",TradeCode:"QueueParam"},this.CommCode="CQParaManage",this.SceneCode="QuegParaMgr",this.TransServiceCode="mg-afaservices-cq/queueParamSet"},v=function t(){o()(this,t),this.data={Brno:"",ParamID:"",QueryTp:"1",CurtPage:"",PageSize:"",StartRows:"",ChannelCode:"02"},this.CommCode="CQParaManage",this.SceneCode="QuegMchnParmQuy",this.TransServiceCode="mg-afaservices-cq/queueParamQuery"},y={name:"queueParamManage",components:{selectTree:e("tzsN").a},data:function(){return{currentRow:[],QueryForm:{branchNum:[],paramId:""},branchNum:[],brnoList:[],defaultMap:{},callVoiceMap:{},isShowMap:{},total:void 0,busiTypeList:[],brnoMap:{},permission:{},loading:!1,isDisabledDel:!1,dialogList:{dialogAdd:f},dialogOptions:{isShow:!1},currentPage:1,pageSize:void 0,rules:{branchNum:[{required:!0,message:"请选择机构编号",trigger:"change"}],paramId:[{validator:Object(u.h)(15),trigger:"blur"}]}}},created:function(){this.pageSize=c.a.get("PageSize"),this.defaultMap=c.a.get("isDefault"),this.callVoiceMap=c.a.get("callVoice"),this.isShowMap=c.a.get("isShow"),this.queryBranchNum()},watch:{"QueryForm.branchNum":function(t){this.$refs.QueryForm.clearValidate()}},computed:{},methods:{queryBranchNum:function(){var t=this;this.loading=!0;var a=new g.a;a.data.orgno=this.$store.getters.BranchNum,Object(i.a)(a).then(function(a){t.loading=!1,t.branchNum=a.RspInfo.Result||[],t.brnoMap=a.RspInfo.orgMap||{},t.permission=l.a.objArray2Hash(t.branchNum,"orgno"),t.brnoList=l.a.formatTreeData(t.branchNum,"orgno","superno"),t.QueryForm.branchNum.push(t.brnoList[0].orgno)}).catch(function(a){t.loading=!1,t.$aui.message.show({type:"warning",message:a.SYS_HEAD.ReturnMessage}),console.error("查询错误",a)})},dataFormat:function(t,a){if("Brno"==a.property)return t[a.property]+"-"+t.BrName;if("DefaultFlag"==a.property)return this.defaultMap[t[a.property]];if("CallVoice"==a.property){for(var e=t[a.property].split(","),i=0;i<e.length;i++)e[i]=this.callVoiceMap[e[i]];return e.join(",")}return"IsDplyWait"==a.property?this.isShowMap[t[a.property]]:void 0},clickAdd:function(){this.dialogOptions.isShow=!0,this.dialogOptions.title="新增排队机参数",this.dialogOptions.mark="1",this.dialogOptions.isDisabled=!1,this.dialogOptions.branchNum=this.branchNum},clickUpdate:function(){this.dialogOptions.isShow=!0,this.dialogOptions.title="修改排队机参数",this.dialogOptions.mark="2",this.dialogOptions.isDisabled=!0,this.dialogOptions.currentRow=this.currentRow,this.dialogOptions.branchNum=this.branchNum},checkPermission:function(t){this.permission[this.currentRow.Brno]?t?this.clickUpdate():this.delBut():this.$aui.message.show({type:"warning",message:"权限不足,无法修改！"})},resetForm:function(){this.busiTypeList=[],this.currentPage=1,this.$refs.QueryForm.resetFields()},delBut:function(){var t=this;this.$aui.confirm.show("此操作将永久删除该排队机参数, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.orgQueueDel()}).catch(function(){t.$aui.message.show({type:"info",message:"已取消删除"})})},orgQueueDel:function(){var t=this;this.loading=!0;var a=new b;a.data.Brno=this.currentRow.Brno,a.data.QueueTpID=this.currentRow.QueueTpID,a.data.ParamID=this.currentRow.ParamID,Object(i.a)(a).then(function(a){t.loading=!1,t.$aui.message.show({type:"success",message:"排队机参数删除成功！"}),t.query()}).catch(function(a){t.$aui.message.show({type:"warning",message:a.SYS_HEAD.ReturnMessage}),t.loading=!1,console.log(a)})},query:function(){var t=this;this.$refs.QueryForm.validate(function(a){if(a){t.loading=!0;var e=new v;e.data.Brno=t.QueryForm.branchNum[0],e.data.ParamID=t.QueryForm.paramId,t.QueryForm.paramId&&(e.data.QueryTp="2"),e.data.PageSize=t.pageSize+"",e.data.CurtPage=t.currentPage+"",e.data.StartRows=(t.currentPage-1)*t.pageSize+"",Object(i.a)(e).then(function(a){t.loading=!1,"0"==a.RspInfo.TotalRcrdNum&&t.$aui.message.show({type:"warning",message:"无满足条件的记录！"}),t.busiTypeList=a.RspInfo.data||[],t.total=a.RspInfo.TotalRcrdNum||0}).catch(function(a){t.busiTypeList=[],t.total=0,t.loading=!1,t.$aui.message.show({type:"warning",message:"请求失败，错误码:"+a.SYS_HEAD.ReturnCode+"，错误信息："+a.SYS_HEAD.ReturnMessage})})}})},handleCurrentChange:function(t){this.currentPage=t,this.query()},selectList:function(t){1==t.length?(this.isDisabledDel=!0,this.currentRow=t[0]):t.length>1?this.$refs.busiTypeList.toggleRowSelection(t[0]):this.isDisabledDel=!1}}},D={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{"element-loading-text":"加载中。。。"}},[e("aui-card",[e("aui-form",{ref:"QueryForm",attrs:{model:t.QueryForm,rules:t.rules,size:"mini","label-position":"top"}},[e("aui-row",{attrs:{gutter:10}},[e("aui-col",{attrs:{lg:4,md:6}},[e("aui-form-item",{attrs:{label:"机构编号",prop:"branchNum"}},[e("select-tree",{staticStyle:{width:"170px"},attrs:{"single-check":!0,props:{id:"orgno",label:"cname",children:"children"},"tree-data":t.brnoList,placeholder:"请选择机构"},model:{value:t.QueryForm.branchNum,callback:function(a){t.$set(t.QueryForm,"branchNum",a)},expression:"QueryForm.branchNum"}})],1)],1),t._v(" "),e("aui-col",{attrs:{lg:4,md:6}},[e("aui-form-item",{attrs:{label:"参数ID",prop:"paramId"}},[e("aui-input",{attrs:{placeholder:"参数ID"},model:{value:t.QueryForm.paramId,callback:function(a){t.$set(t.QueryForm,"paramId",a)},expression:"QueryForm.paramId"}})],1)],1),t._v(" "),e("aui-col",{staticClass:"searchBtnMarginTop",attrs:{lg:2,md:3}},[e("aui-button",{attrs:{type:"primary",size:"mini",icon:"aui-icon-search"},on:{click:t.query}},[t._v("查询")])],1),t._v(" "),e("aui-col",{staticClass:"searchBtnMarginTop",attrs:{lg:2,md:3}},[e("aui-button",{attrs:{type:"warning",size:"mini",icon:"aui-icon-refresh"},on:{click:function(a){t.resetForm("QueryForm")}}},[t._v("重置")])],1)],1)],1)],1),t._v(" "),e("aui-card",{staticStyle:{"margin-top":"10px"}},[e("aui-row",[e("aui-col",{attrs:{lg:2,md:3}},[t.btnPermission("Button_Menu_Add")?e("aui-button",{attrs:{type:"primary",icon:"aui-icon-plus",disabled:t.isDisabledDel,size:"mini"},on:{click:t.clickAdd}},[t._v("新增")]):t._e()],1),t._v(" "),e("aui-col",{attrs:{lg:2,md:3}},[t.btnPermission("Button_Menu_Add")?e("aui-button",{attrs:{type:"primary",icon:"aui-icon-edit",disabled:!t.isDisabledDel,size:"mini"},on:{click:function(a){t.checkPermission("1")}}},[t._v("修改")]):t._e()],1),t._v(" "),e("aui-col",{attrs:{lg:2,md:3}},[t.btnPermission("Button_Menu_Edit")?e("aui-button",{attrs:{type:"danger",icon:"aui-icon-delete",disabled:!t.isDisabledDel,size:"mini"},on:{click:function(a){t.checkPermission()}}},[t._v("删除")]):t._e()],1)],1),t._v(" "),e("aui-table",{ref:"busiTypeList",staticClass:"tableMarginTop",staticStyle:{"min-height":"390px"},attrs:{data:t.busiTypeList,border:"","header-row-class-name":"tableHeaderClass"},on:{"selection-change":t.selectList}},[e("aui-table-column",{attrs:{type:"selection",width:"40px"}}),t._v(" "),e("aui-table-column",{attrs:{prop:"ParamID",label:"参数ID","min-width":"147px"}}),t._v(" "),e("aui-table-column",{attrs:{prop:"Brno",formatter:t.dataFormat,label:"机构编号","min-width":"247px"}}),t._v(" "),e("aui-table-column",{attrs:{prop:"DefaultFlag",formatter:t.dataFormat,label:"是否默认标志","min-width":"107px"}}),t._v(" "),e("aui-table-column",{attrs:{prop:"TicketTplNo",label:"小票模板编号","min-width":"117px"}}),t._v(" "),e("aui-table-column",{attrs:{prop:"CallVoice",formatter:t.dataFormat,label:"语音呼叫顺序","min-width":"107px"}}),t._v(" "),e("aui-table-column",{attrs:{prop:"QueInterfaceID",label:"排队机界面ID","min-width":"117px"}}),t._v(" "),e("aui-table-column",{attrs:{prop:"IsDplyWait",formatter:t.dataFormat,label:"是否显示等待人数","min-width":"147px"}}),t._v(" "),e("aui-table-column",{attrs:{prop:"MainPrompt",label:"主界面提示信息","min-width":"127px"}}),t._v(" "),e("aui-table-column",{attrs:{prop:"StopPrompt",label:"\t暂停服务提示信息","min-width":"147px"}})],1),t._v(" "),e("div",{staticStyle:{"text-align":"right","margin-top":"10px"}},[e("aui-pagination",{attrs:{background:"","current-page":t.currentPage,"page-size":10,layout:"total, prev, pager, next, jumper",total:t.total},on:{"current-change":t.handleCurrentChange}})],1)],1)],1),t._v(" "),e("keep-alive",[e(t.dialogList.dialogAdd,{tag:"component",attrs:{option:t.dialogOptions},on:{refreshTable:t.query}})],1)],1)},staticRenderFns:[]};var w=e("/Xao")(y,D,!1,function(t){e("BykP")},"data-v-96d4f072",null);a.default=w.exports},"1G+F":function(t,a,e){var i=e("N5gg");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);e("8bSs")("77fdd037",i,!0)},BXqJ:function(t,a,e){(t.exports=e("BkJT")(!1)).push([t.i,"",""])},BykP:function(t,a,e){var i=e("BXqJ");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);e("8bSs")("aa4a2f40",i,!0)},N5gg:function(t,a,e){(t.exports=e("BkJT")(!1)).push([t.i,"",""])}});