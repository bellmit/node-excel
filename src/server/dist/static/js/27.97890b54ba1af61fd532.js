webpackJsonp([27],{"/qpx":function(e,t,a){var i=a("9bNj");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a("8bSs")("13e80ef5",i,!0)},"9bNj":function(e,t,a){(e.exports=a("BkJT")(!1)).push([e.i,"",""])},ZY47:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("3cXf"),o=a.n(i),s=a("0oES"),n=a("tzsN"),r=a("pADA"),d=a("AA3o"),l=a.n(d),c=function e(){l()(this,e),this.data={DeviceNum:"",DeviceModel:"",ServiceProvNum:"",VersionNum:"",DateInsu:"",FinalGuarDate:"",MachineCode:"",MacAddr:"",AscrBranch:""},this.CommCode="IBDeviceManagement",this.SceneCode="DevInfoCreat",this.TransServiceCode="mg-afaservices-dev/devInfoCreat"},u=function e(){l()(this,e),this.data={DeviceNum:"",DeviceModel:"",ServiceProvNum:"",VersionNum:"",DateInsu:"",FinalGuarDate:"",MachineCode:"",MacAddr:"",AscrBranch:""},this.CommCode="IBDeviceManagement",this.SceneCode="DevInfoUpdate",this.TransServiceCode="mg-afaservices-dev/devInfoUpdate"},v=a("fCv1"),m={components:{selectTree:n.a},data:function(){var e=this;return{pickerEffeDate:v.b,devModel:[],serverId:[],brnoList:[],loading:!1,devBox:void 0,devSort:[],devSortList:[],cSort:[],devForm:[],startTime:"00:00:00",endTime:"00:00:00",devInfoBaseAdd:{brno:[],devModel:"",devNum:"",startDate:"",endDate:"",serverId:"",devSysNum:"",machenNum:"",macAddr:"",startbusihours:"",endbusihours:"",starttime:"",shuttime:"",effedate:"",expidate:""},rulesBase:{devNum:[{required:!0,message:"请输入设备编号",trigger:"change"}],startDate:[{required:!0,message:"请选择起保日期",trigger:"change"}],endDate:[{required:!0,message:"请选择终保日期",trigger:"change"}],devModel:[{required:!0,message:"请选择设备型号",trigger:"change"}],brno:[{type:"array",required:!0,message:"请选择所属机构",trigger:"change"}],effedate:[{required:!0,message:"请选择设备领用生效日期",trigger:"change"}],expidate:[{required:!0,message:"请选择设备领用失效日期",trigger:"change"},{validator:function(t,a,i){""==a&&i(),a-e.devInfoBaseAdd.effedate>=0?i():i(new Error("失效日期必须大于生效日期"))},trigger:"change"}]}}},methods:{sure:function(){var e=this;this.$refs.devInfoBaseAdd.validate(function(t){if(!t)return e.$aui.message.show({type:"warning",message:"请输入合法的数据！"}),!1;e.loading=!0;var a="1"==e.option.log?new c:new u;a.data.DeviceNum=e.devInfoBaseAdd.devNum,a.data.DeviceModel=e.devInfoBaseAdd.devModel,a.data.DateInsu=e.devInfoBaseAdd.startDate,a.data.FinalGuarDate=e.devInfoBaseAdd.endDate,a.data.StartbusiHours=e.devInfoBaseAdd.startbusihours,a.data.EndbusiHours=e.devInfoBaseAdd.endbusihours,a.data.StartTime=e.devInfoBaseAdd.starttime,a.data.ShutTime=e.devInfoBaseAdd.shuttime,a.data.rcvuseefftdate=e.devInfoBaseAdd.effedate,a.data.rcvuseinvaliddate=e.devInfoBaseAdd.expidate,Object(s.a)(a).then(function(t){e.$emit("refreshTable");var a="1"==e.option.log?"创建":"修改";e.$aui.message.show({type:"success",message:"设备信息"+a+"成功!"}),e.isShow=!1,e.loading=!1}).catch(function(t){e.$aui.message.show({type:"warning",message:"设备信息"+mes+response.SYS_HEAD.ReturnMessage+"!"}),e.loading=!1})})},openDevInfo:function(){this.$nextTick(function(){"2"==this.option.log&&this.updateDate()})},updateDate:function(){this.devInfoBaseAdd.devNum=this.option.currentRow.devicenum,this.devInfoBaseAdd.devModel=this.option.currentRow.devicemodel,this.devInfoBaseAdd.startDate=this.option.currentRow.dateinsu,this.devInfoBaseAdd.endDate=this.option.currentRow.finalguardate,this.devInfoBaseAdd.startbusihours=this.option.currentRow.equip_bizn_bgn_tm,this.devInfoBaseAdd.endbusihours=this.option.currentRow.equip_end_bizn_tm,this.devInfoBaseAdd.starttime=this.option.currentRow.equip_bot_tm,this.devInfoBaseAdd.shuttime=this.option.currentRow.equip_off_tm,this.devInfoBaseAdd.effedate=this.option.currentRow.rcvuseefftdate,this.devInfoBaseAdd.expidate=this.option.currentRow.rcvuseinvaliddate},clearForm:function(){this.$refs.devInfoBaseAdd.clearValidate(),this.$refs.devInfoBaseAdd.resetFields()},dateChange:function(){this.devInfoBaseAdd.startDate>this.devInfoBaseAdd.endDate&&(this.$aui.message.show({type:"warning",message:"起保日期不能大于终保日期"}),this.devInfoBaseAdd.startDate=r.a.getDateTime("date"),this.devInfoBaseAdd.endDate=r.a.getDateTime("date"))},busiTimeChange:function(){this.devInfoBaseAdd.startbusihours>this.devInfoBaseAdd.endbusihours&&(this.$aui.message.show({type:"warning",message:"开始营业时间不能大于结束营业时间"}),this.devInfoBaseAdd.startbusihours="000000",this.devInfoBaseAdd.endbusihours="235959")},timeChange:function(){this.devInfoBaseAdd.starttime>this.devInfoBaseAdd.shuttime&&(this.$aui.message.show({type:"warning",message:"开机时间不能大于关机时间"}),this.devInfoBaseAdd.starttime="000000",this.devInfoBaseAdd.shuttime="235959")}},props:{option:Object},watch:{devInfoBaseAdd:{handler:function(e,t){},deep:!0}},computed:{isShow:{get:function(){return this.option.isShow},set:function(e){this.option.isShow=e}}}},p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("aui-dialog",{attrs:{title:e.option.title,visible:e.isShow,width:"800px","close-on-click-modal":!1},on:{"update:visible":function(t){e.isShow=t},show:e.openDevInfo,hide:function(t){e.clearForm()}}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[a("aui-card",[a("aui-form",{ref:"devInfoBaseAdd",attrs:{model:e.devInfoBaseAdd,rules:e.rulesBase,"label-width":"130px",size:"mini","label-position":"right"}},[a("aui-row",{attrs:{gutter:20}},[a("aui-col",{attrs:{span:12}},[a("aui-form-item",{attrs:{label:"设备编号:",prop:"devNum"}},[a("aui-input",{attrs:{disabled:e.option.isChecked,placeholder:"请输入设备编号"},model:{value:e.devInfoBaseAdd.devNum,callback:function(t){e.$set(e.devInfoBaseAdd,"devNum",t)},expression:"devInfoBaseAdd.devNum"}})],1)],1),e._v(" "),a("aui-col",{attrs:{span:12}},[a("aui-form-item",{attrs:{label:"设备型号:",prop:"devModel"}},[a("aui-select",{attrs:{disabled:e.option.isChecked,placeholder:"请选择设备型号"},model:{value:e.devInfoBaseAdd.devModel,callback:function(t){e.$set(e.devInfoBaseAdd,"devModel",t)},expression:"devInfoBaseAdd.devModel"}},e._l(e.option.devModel,function(e){return a("aui-option",{key:e.devicemodel,attrs:{label:e.devicemodel+"-"+e.devicetype,value:e.devicemodel,disabled:e.disabled}})}))],1)],1)],1),e._v(" "),a("aui-row",{attrs:{gutter:20}},[a("aui-col",{attrs:{span:12}},[a("aui-form-item",{attrs:{label:"起保日期:",prop:"startDate"}},[a("aui-date-picker",{attrs:{"value-format":"yyyyMMdd",type:"date",placeholder:"选择日期"},on:{change:e.dateChange},model:{value:e.devInfoBaseAdd.startDate,callback:function(t){e.$set(e.devInfoBaseAdd,"startDate",t)},expression:"devInfoBaseAdd.startDate"}})],1)],1),e._v(" "),a("aui-col",{attrs:{span:12}},[a("aui-form-item",{attrs:{label:"终保日期:",prop:"endDate"}},[a("aui-date-picker",{attrs:{"value-format":"yyyyMMdd",type:"date",placeholder:"选择日期"},on:{change:e.dateChange},model:{value:e.devInfoBaseAdd.endDate,callback:function(t){e.$set(e.devInfoBaseAdd,"endDate",t)},expression:"devInfoBaseAdd.endDate"}})],1)],1)],1),e._v(" "),a("aui-row",{attrs:{gutter:20}},[a("aui-col",{attrs:{span:12}},[a("aui-form-item",{attrs:{label:"设备开始营业时间:",prop:"startbusihours"}},[a("aui-time-picker",{attrs:{"value-format":"HHmmss",placeholder:"设备开始营业时间"},on:{change:e.busiTimeChange},model:{value:e.devInfoBaseAdd.startbusihours,callback:function(t){e.$set(e.devInfoBaseAdd,"startbusihours",t)},expression:"devInfoBaseAdd.startbusihours"}})],1)],1),e._v(" "),a("aui-col",{attrs:{span:12}},[a("aui-form-item",{attrs:{label:"设备结束营业时间:",prop:"endbusihours"}},[a("aui-time-picker",{attrs:{"value-format":"HHmmss",placeholder:"设备结束营业时间"},on:{change:e.busiTimeChange},model:{value:e.devInfoBaseAdd.endbusihours,callback:function(t){e.$set(e.devInfoBaseAdd,"endbusihours",t)},expression:"devInfoBaseAdd.endbusihours"}})],1)],1)],1),e._v(" "),a("aui-row",{attrs:{gutter:20}},[a("aui-col",{attrs:{span:12}},[a("aui-form-item",{attrs:{label:"设备开机时间:",prop:"starttime"}},[a("aui-time-picker",{attrs:{"value-format":"HHmmss",placeholder:"设备开机时间"},on:{change:e.timeChange},model:{value:e.devInfoBaseAdd.starttime,callback:function(t){e.$set(e.devInfoBaseAdd,"starttime",t)},expression:"devInfoBaseAdd.starttime"}})],1)],1),e._v(" "),a("aui-col",{attrs:{span:12}},[a("aui-form-item",{attrs:{label:"设备关机时间:",prop:"shuttime"}},[a("aui-time-picker",{attrs:{"value-format":"HHmmss",placeholder:"设备关机时间"},on:{change:e.timeChange},model:{value:e.devInfoBaseAdd.shuttime,callback:function(t){e.$set(e.devInfoBaseAdd,"shuttime",t)},expression:"devInfoBaseAdd.shuttime"}})],1)],1)],1),e._v(" "),a("aui-row",{attrs:{gutter:20}},[a("aui-col",{attrs:{span:12}},[a("aui-form-item",{attrs:{label:"设备领用生效日期:",prop:"effedate"}},[a("aui-date-picker",{attrs:{type:"date","value-format":"yyyyMMdd",placeholder:"设备领用生效日期","picker-options":e.pickerEffeDate},model:{value:e.devInfoBaseAdd.effedate,callback:function(t){e.$set(e.devInfoBaseAdd,"effedate",t)},expression:"devInfoBaseAdd.effedate"}})],1)],1),e._v(" "),a("aui-col",{attrs:{span:12}},[a("aui-form-item",{attrs:{label:"设备领用失效日期:",prop:"expidate"}},[a("aui-date-picker",{attrs:{type:"date","value-format":"yyyyMMdd",placeholder:"设备领用失效日期","picker-options":e.pickerEffeDate},model:{value:e.devInfoBaseAdd.expidate,callback:function(t){e.$set(e.devInfoBaseAdd,"expidate",t)},expression:"devInfoBaseAdd.expidate"}})],1)],1)],1)],1)],1),e._v(" "),a("div",{staticStyle:{margin:"10px","text-align":"right"}},[a("aui-button",{attrs:{size:"mini"},on:{click:function(t){e.isShow=!1}}},[e._v("取消")]),e._v(" "),a("aui-button",{attrs:{type:"primary",size:"mini"},on:{click:e.sure}},[e._v("确定")])],1)],1)])},staticRenderFns:[]};var f=a("/Xao")(m,p,!1,function(e){a("mpHR")},"data-v-f605b428",null).exports,h={data:function(){return{enum:{0:"已入库",1:"设备布放申请",2:"设备布放审批",3:"待激活",4:"设备投产",5:"故障状态",6:"报废状态",9:"其他"},loading:!1,deviceInfo:[],devInfo:{devId:"",devNum:"",devAssortmentId:"",devAssortmentName:"",devForm:"",brandId:"",brandName:"",devType:"",devTypeNum:"",devModelId:"",devModel:"",devicetype:"",ipaddr:""}}},methods:{formate:function(e){return this.enum[e]},timeFomat:function(e){return r.a.timeFormat2Time(e)},openCollback:function(){console.log(this.optionDetail.currentRow),console.log("======",this.devInfo.devicetype),this.devInfo=JSON.parse(o()(this.optionDetail.currentRow));for(var e=this.optionDetail.deviceTypeSpinner,t=0;t<e.length;t++){var a=e[t];this.devInfo.devicetype==a.DataKeyVal&&(this.devInfo.devicetype=a.DataKeyVal+"-"+a.Meaning)}this.devInfo.brno=this.optionDetail.currentRow.ascrbranch+"-"+this.optionDetail.currentRow.ascrbranchname}},created:function(){},props:{optionDetail:Object},computed:{isShow:{get:function(){return this.optionDetail.isShow},set:function(e){this.optionDetail.isShow=e}},devIds:function(){return this.optionDetail.devId}}},g={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("aui-dialog",{attrs:{title:"详细信息",visible:e.isShow,width:"800px","close-on-click-modal":!1},on:{"update:visible":function(t){e.isShow=t},show:e.openCollback}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[a("aui-card",{staticStyle:{"margin-bottom":"10px"}},[a("aui-form",{attrs:{"label-position":"right",size:"mini","label-width":"140px"}},[a("aui-row",{attrs:{gutter:20}},[a("aui-col",{attrs:{md:24,lg:12}},[a("aui-form-item",{attrs:{label:"设备编号:"}},[a("span",[e._v(e._s(e.devInfo.devicenum))])])],1),e._v(" "),a("aui-col",{attrs:{md:24,lg:12}},[a("aui-form-item",{attrs:{label:"设备型号:"}},[a("span",[e._v(e._s(e.devInfo.devicemodel))])])],1),e._v(" "),a("aui-col",{attrs:{md:24,lg:12}},[a("aui-form-item",{attrs:{label:"物理设备序号:"}},[a("span",[e._v(e._s(e.devInfo.physdeviceserialnum))])])],1),e._v(" "),a("aui-col",{attrs:{md:24,lg:12}},[a("aui-form-item",{attrs:{label:"设备类型:"}},[a("span",[e._v(e._s(e.devInfo.devicetype))])])],1),e._v(" "),a("aui-col",{attrs:{md:24,lg:12}},[a("aui-form-item",{attrs:{label:"起保日期:"}},[a("span",[e._v(e._s(e.toolBox.timeFormat2Date(e.devInfo.dateinsu)))])])],1),e._v(" "),a("aui-col",{attrs:{md:24,lg:12}},[a("aui-form-item",{attrs:{label:"终保日期:"}},[a("span",[e._v(e._s(e.toolBox.timeFormat2Date(e.devInfo.finalguardate)))])])],1),e._v(" "),a("aui-col",{attrs:{md:24,lg:12}},[a("aui-form-item",{attrs:{label:"设备开始营业时间:"}},[a("span",[e._v(e._s(e.toolBox.timeFormat2Time(e.devInfo.equip_bizn_bgn_tm)))])])],1),e._v(" "),a("aui-col",{attrs:{md:24,lg:12}},[a("aui-form-item",{attrs:{label:"设备结束营业时间:"}},[a("span",[e._v(e._s(e.toolBox.timeFormat2Time(e.devInfo.equip_end_bizn_tm)))])])],1),e._v(" "),a("aui-col",{attrs:{md:24,lg:12}},[a("aui-form-item",{attrs:{label:"设备开机时间:"}},[a("span",[e._v(e._s(e.toolBox.timeFormat2Time(e.devInfo.equip_bot_tm)))])])],1),e._v(" "),a("aui-col",{attrs:{md:24,lg:12}},[a("aui-form-item",{attrs:{label:"设备关机时间:"}},[a("span",[e._v(e._s(e.toolBox.timeFormat2Time(e.devInfo.equip_off_tm)))])])],1),e._v(" "),a("aui-col",{attrs:{md:24,lg:12}},[a("aui-form-item",{attrs:{label:"设备领用生效日期:"}},[a("span",[e._v(e._s(e.toolBox.timeFormat2Date(e.devInfo.rcvuseefftdate)))])])],1),e._v(" "),a("aui-col",{attrs:{md:24,lg:12}},[a("aui-form-item",{attrs:{label:"设备领用失效日期:"}},[a("span",[e._v(e._s(e.toolBox.timeFormat2Date(e.devInfo.rcvuseinvaliddate)))])])],1)],1),e._v(" "),a("aui-row",{attrs:{gutter:20}},[a("aui-col",{attrs:{md:24,lg:12}},[a("aui-form-item",{attrs:{label:"设备系统版本号:"}},[a("span",[e._v(e._s(e.devInfo.serviceprovnum))])])],1)],1),e._v(" "),a("aui-row",{attrs:{gutter:20}},[a("aui-col",{attrs:{md:24,lg:12}},[a("aui-form-item",{attrs:{label:"机器码:"}},[a("span",[e._v(e._s(e.devInfo.machinecode))])])],1)],1),e._v(" "),a("aui-row",{attrs:{gutter:20}},[a("aui-col",{attrs:{md:24,lg:12}},[a("aui-form-item",{attrs:{label:"IP地址:"}},[a("span",[e._v(e._s(e.devInfo.deviceipaddress))])])],1),e._v(" "),a("aui-col",{attrs:{md:24,lg:12}},[a("aui-form-item",{attrs:{label:"所属机构:"}},[a("span",[e._v(e._s(e.devInfo.brno))])])],1),e._v(" "),a("aui-col",{attrs:{md:24,lg:12}},[a("aui-form-item",{attrs:{label:"设备状态:"}},[a("span",[e._v(e._s(e.formate(e.devInfo.devicestate)))])])],1)],1)],1)],1),e._v(" "),a("aui-row",{staticStyle:{"margin-top":"10px","text-align":"right"}},[a("aui-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.isShow=!1}}},[e._v("返回")])],1)],1)])],1)},staticRenderFns:[]};var b=a("/Xao")(h,g,!1,function(e){a("tAkX")},"data-v-693c0ba5",null).exports,I=a("0VOF"),w=a("syAl"),_=function e(){l()(this,e),this.data={DeviceNum:"",DeviceModel:"",CallOutBranch:"",CallInBranch:"",CauseTran:"",AscrBranch:"",AscrBranchName:""},this.CommCode="IBDeviceManagement",this.SceneCode="DevAllocation",this.TransServiceCode="mg-afaservices-dev/devAllocation"},D={props:{options:Object},components:{selectTree:n.a},data:function(){return{brnoList:[],devInfoBaseAdd:{devModel:"",devNum:"",intoBrno:"",outBrno:"",reason:""},outBrno:"",rulesBase:{},loading:!1}},methods:{openDevInfo:function(){var e=this;this.loading=!0;var t=new I.a;t.data.orgno=this.$store.getters.BranchNum,Object(s.a)(t).then(function(t){e.loading=!1,e.brnoList=t.RspInfo.Result||[],e.brnoList=r.a.formatTreeData(e.brnoList,"orgno","superno")}).catch(function(t){e.loading=!1,e.$aui.message.show({type:"error",message:t.SYS_HEAD.ReturnMessage+"!"})}),this.devInfoBaseAdd.devNum=this.options.currentRow.devicenum,this.devInfoBaseAdd.devModel=this.options.currentRow.devicemodel,this.outBrno=this.options.currentRow.ascrbranch,this.devInfoBaseAdd.outBrno=this.options.currentRow.ascrbranch+"-"+this.options.currentRow.ascrbranchname},clearForm:function(){this.$refs.devInfoBaseAdd.resetFields(),this.$refs.devInfoBaseAdd.clearValidate()},sure:function(){var e=this;this.$refs.devInfoBaseAdd.validate(function(t){if(!t)return e.$aui.message.show({type:"warning",message:"请输入合法的数据！"}),!1;if(e.outBrno==e.devInfoBaseAdd.intoBrno[0])return e.$aui.message.show({type:"warning",message:"调出机构与调入机构相同!"}),!1;e.loading=!0;var a=new _;a.data.DeviceNum=e.devInfoBaseAdd.devNum,a.data.DeviceModel=e.devInfoBaseAdd.devModel,a.data.CallOutBranch=e.outBrno,a.data.CallInBranch=e.devInfoBaseAdd.intoBrno[0],a.data.CauseTran=e.devInfoBaseAdd.reason,a.data.AscrBranch=e.devInfoBaseAdd.intoBrno[0],a.data.AscrBranchName=e.options.brnoMap[e.devInfoBaseAdd.intoBrno[0]],Object(s.a)(a).then(function(t){e.$emit("refreshTable"),e.$aui.message.show({type:"success",message:"设备调拨成功！"}),e.$emit("refreshTable"),e.loading=!1,e.options.isShow=!1}).catch(function(t){e.$aui.message.show({type:"error",message:t.SYS_HEAD.ReturnMessage+"!"}),e.options.isShow=!1,e.loading=!1})})}}},B={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("aui-dialog",{attrs:{title:"设备调拨",visible:e.options.isShow,width:"800px","close-on-click-modal":!1},on:{"update:visible":function(t){e.$set(e.options,"isShow",t)},show:e.openDevInfo,hide:e.clearForm}},[a("aui-card",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[a("aui-form",{ref:"devInfoBaseAdd",attrs:{model:e.devInfoBaseAdd,rules:e.rulesBase,"label-width":"120px",size:"mini","label-position":"left"}},[a("aui-row",{attrs:{gutter:20}},[a("aui-col",{attrs:{span:12}},[a("aui-form-item",{attrs:{label:"设备型号:",prop:"devModel"}},[a("aui-input",{attrs:{disabled:"",placeholder:"请输入设备型号"},model:{value:e.devInfoBaseAdd.devModel,callback:function(t){e.$set(e.devInfoBaseAdd,"devModel",t)},expression:"devInfoBaseAdd.devModel"}})],1)],1),e._v(" "),a("aui-col",{attrs:{span:12}},[a("aui-form-item",{attrs:{label:"设备编号:",prop:"devNum"}},[a("aui-input",{attrs:{disabled:"",placeholder:"请输入设备编号"},model:{value:e.devInfoBaseAdd.devNum,callback:function(t){e.$set(e.devInfoBaseAdd,"devNum",t)},expression:"devInfoBaseAdd.devNum"}})],1)],1)],1),e._v(" "),a("aui-row",{attrs:{gutter:20}},[a("aui-col",{attrs:{span:12}},[a("aui-form-item",{attrs:{label:"调出机构:",prop:"outBrno"}},[a("aui-input",{attrs:{disabled:""},model:{value:e.devInfoBaseAdd.outBrno,callback:function(t){e.$set(e.devInfoBaseAdd,"outBrno",t)},expression:"devInfoBaseAdd.outBrno"}})],1)],1),e._v(" "),a("aui-col",{attrs:{span:12}},[a("aui-form-item",{attrs:{label:"调入机构:",prop:"intoBrno"}},[a("select-tree",{staticStyle:{width:"170px"},attrs:{"single-check":!0,props:{id:"orgno",label:"cname",children:"children"},"tree-data":e.brnoList,placeholder:"请选择机构"},model:{value:e.devInfoBaseAdd.intoBrno,callback:function(t){e.$set(e.devInfoBaseAdd,"intoBrno",t)},expression:"devInfoBaseAdd.intoBrno"}})],1)],1),e._v(" "),a("aui-col",{attrs:{span:24}},[a("aui-form-item",{attrs:{label:"调拨原因:",prop:"reason"}},[a("aui-input",{attrs:{placeholder:"请输入调拨原因"},model:{value:e.devInfoBaseAdd.reason,callback:function(t){e.$set(e.devInfoBaseAdd,"reason",t)},expression:"devInfoBaseAdd.reason"}})],1)],1)],1)],1)],1),e._v(" "),a("div",{staticStyle:{margin:"10px","text-align":"right"}},[a("aui-button",{attrs:{size:"mini"},on:{click:function(t){e.options.isShow=!1}}},[e._v("取消")]),e._v(" "),a("aui-button",{attrs:{type:"primary",size:"mini"},on:{click:e.sure}},[e._v("确定")])],1)],1)},staticRenderFns:[]};var y=a("/Xao")(D,B,!1,function(e){a("/qpx")},"data-v-93c52178",null).exports,A=a("xcog"),S=a("nXXQ"),x=a("zdBp"),M=a("XDsu"),k=function e(){l()(this,e),this.data={DeviceNum:"",DeviceModel:"",MainBranch:"",MainUser:"",MainDate:"",MainTime:""},this.CommCode="IBDeviceManagement",this.SceneCode="DevInfoDelete",this.TransServiceCode="mg-afaservices-dev/devInfoDelete"},T=function e(){l()(this,e),this.data={DeviceNum:"",DeviceModel:"",OperType:""},this.CommCode="IBDeviceManagement",this.SceneCode="DevStaStop",this.TransServiceCode="mg-afaservices-dev/devStaStop"},R=function e(){l()(this,e),this.data={EquipNo:"",MainTainDate:"",MainTainTime:"",MainTainPerson:"",EquipIP:"",InstallAddr:"",EquipOrg:""},this.CommCode="IBDeviceInfoManage",this.SceneCode="EquipMaintain",this.TransServiceCode="mg-afaservices-dev/devStaStop"},$={name:"type-info-manage",components:{selectTree:n.a},data:function(){return{dataTypeInfoPage:[],enum:{0:"已入库",1:"设备布放申请",2:"设备布放审批",3:"待激活",4:"设备投产",5:"故障状态",6:"报废状态",9:"其他"},pageSize:void 0,deviceTypeSpinner:"",currentPage:1,total:0,loading:!1,brnoList:[],selBrno:[],deviceRunState:[],devInfoMgrQueryForm:{brno:[],devModelId:"",deviceRunState:"",devNum:""},devModel:[],dialogList:{createTypeInfo:f,detailTypeInfo:b,devTransfer:y},dialogOptions:{isShow:!1,active:0,devForm:"",log:""},dialogOptionsListGS:{isShow:!0,devInfoList:[],comDeviceStatuSpinner:[]},dialogOptionsListPad:{isShow:!0,devInfoList:[]},detailDialogOptions:{isShow:!1,devId:"",dataTypeInfo:[]},transfersOptions:{isShow:!1},dataTypeInfo:[],devicefixDialogVisible:!1,transferDialogVisible:!1,scrapDialogVisible:!1,stopDialogVisible:!1,backDialogVisible:!1,uploadDialogVisible:!1,fileList:[],isUse:!0,isUsePad:!0,devId:"",currentRow:[],comDeviceStatuSpinner:void 0}},created:function(){this.initList(),this.pageSize=w.a.get("PageSize"),this.deviceRunState=w.a.get("devState")},watch:{devInfoMgrQueryForm:{handler:function(e,t){this.currentPage=1},deep:!0}},mounted:function(){},methods:{dataFormat:function(e,t){return"devicestate"==t.property?this.enum[e[t.property]]:"ascrbranch"==t.property?e[t.property]+"-"+this.brnoMap[e[t.property]]:"devicetype"==t.property?e[t.property]+"-"+e.devicetypename:void 0},changePage:function(e){this.currentPage=e,this.devQuery()},isDelete:function(){return"6"!=this.currentRow[0].devicestate||(this.$aui.message.show({type:"warning",message:"设备已报废!"}),!1)},isTransfer:function(){return"0"==this.currentRow[0].devicestate||(this.$aui.message.show({type:"warning",message:"已入库的设备才能进行调拨!"}),!1)},backDev:function(){var e=this;if("0"==this.currentRow[0].devicestate)return this.$aui.message.show({type:"warning",message:"已入库的设备不能进行归还!"}),!1;this.backDialogVisible=!1,this.$aui.confirm.show("此操作将归还该设备, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",closeOnClickModal:!1}).then(function(){e.devManage("0","归还")}).catch(function(){e.$aui.message.show({type:"info",message:"已取消操作"})})},stopDevInfo:function(){var e=this;this.$aui.confirm.show("此操作将报故障该设备, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",closeOnClickModal:!1}).then(function(){e.devManage("5","故障")}).catch(function(){e.$aui.message.show({type:"info",message:"已取消操作"})})},scrapDev:function(){var e=this;this.$aui.confirm.show("此操作将报废该设备, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",closeOnClickModal:!1}).then(function(){e.devManage("6","报废")}).catch(function(){e.$aui.message.show({type:"info",message:"已取消操作"})})},fixDev:function(){var e=this;this.$aui.confirm.show("此操作将维修该设备, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",closeOnClickModal:!1}).then(function(){e.fixDevRequest()}).catch(function(){e.$aui.message.show({type:"info",message:"已取消操作"})})},fixDevRequest:function(){var e=this;this.loading=!0;var t=new R;t.data.EquipNo=this.currentRow[0].devicenum,t.data.MainTainDate=r.a.getDateTime("date"),t.data.MainTainTime=r.a.getDateTime("time"),t.data.MainTainPerson=Object(A.q)(),t.data.EquipIP=this.currentRow[0].deviceipaddress,t.data.InstallAddr=this.currentRow[0].instladdr,t.data.EquipOrg=this.currentRow[0].ascrbranch,Object(s.a)(t).then(function(t){e.loading=!1,e.$aui.message.show({type:"success",message:"设备维修成功"}),e.devQuery()}).catch(function(t){e.$aui.message.show({type:"error",message:t.SYS_HEAD.ReturnMessage+"!"}),e.loading=!1,console.log(t)})},devManage:function(e,t){var a=this;this.loading=!0;var i=new T;i.data.OrgNo=this.currentRow[0].orgnum,i.data.DeviceModel=this.currentRow[0].devicemodel,i.data.DeviceNum=this.currentRow[0].devicenum,i.data.OperType=e,Object(s.a)(i).then(function(e){a.loading=!1,a.$aui.message.show({type:"success",message:"设备"+t+"成功"}),a.devQuery()}).catch(function(e){a.$aui.message.show({type:"error",message:e.SYS_HEAD.ReturnMessage+"!"}),a.loading=!1,console.log(e)})},initList:function(){var e=this,t=new x.a;Object(s.a)(t).then(function(t){e.devModel=t.RspInfo.pageList||[]}).catch(function(t){e.$aui.message.show({type:"error",message:t.SYS_HEAD.ReturnMessage+"!"})}),this.loading=!0;var a=new I.a;a.data.orgno=this.$store.getters.BranchNum,Object(s.a)(a).then(function(t){e.loading=!1,e.brnoList=t.RspInfo.Result||[],e.brnoMap=t.RspInfo.orgMap||{},e.brnoList=r.a.formatTreeData(e.brnoList,"orgno","superno");var a=new S.a;Object(s.a)(a).then(function(t){e.deviceTypeSpinner=t.RspInfo.Result||[]}).catch(function(e){console.error("查询错误",e)})}).catch(function(t){e.loading=!1,e.$aui.message.show({type:"error",message:t.SYS_HEAD.ReturnMessage+"!"})})},rowDate:function(e){this.currentRow=e,e.length>1&&this.$refs.dataTypeInfo.toggleRowSelection(e[0])},devInfoDel:function(){var e=this;this.loading=!0;var t=new k;t.data.DeviceNum=this.devId,t.data.DeviceModel=this.currentRow[0].devicemodel,Object(s.a)(t).then(function(t){e.loading=!1,e.devQuery(),e.$aui.message.show({type:"success",message:"设备信息删除"+t.SYS_HEAD.ReturnMessage+"!"})}).catch(function(t){e.loading=!1,e.$aui.message.show({type:"error",message:"设备信息删除"+t.SYS_HEAD.ReturnMessage+"!"})})},delDialogShow:function(){var e=this;this.isDelete()&&this.$aui.confirm.show("此操作将永久删除该设备信息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.devInfoDel()}).catch(function(){e.$aui.message.show({type:"info",message:"已取消删除"})})},isEnabled:function(e){this.isUse=!e},isEnabledPad:function(e){this.isUsePad=!e},handleCommand:function(e){if("devicefixDialogVisible"==e){if("5"!=this.currentRow[0].devicestate)return this.$aui.message.show({type:"warning",message:"只有故障状态的设备才能执行此操作!"}),!1;this.devicefixDialogVisible=!0,this.fixDev()}"uploadDialogVisible"==e&&(this.uploadDialogVisible=!0),"transferDialogVisible"==e&&this.isDelete()&&this.isTransfer()&&(this.transfersOptions.isShow=!0,this.transfersOptions.currentRow=this.currentRow[0],this.transfersOptions.brnoList=JSON.parse(o()(this.brnoList)),this.transfersOptions.brnoMap=this.brnoMap),"scrapDialogVisible"==e&&this.isDelete()&&this.scrapDev(),"stopDialogVisible"==e&&this.isDelete()&&this.stopDevInfo(),"backDialogVisible"==e&&this.isDelete()&&this.backDev(),"detailDev"==e&&this.detailDev()},detailDev:function(){this.detailDialogOptions.devId=this.devId,this.detailDialogOptions.isShow=!0,this.detailDialogOptions.currentRow=this.currentRow[0],this.detailDialogOptions.deviceTypeSpinner=this.deviceTypeSpinner,this.detailDialogOptions.deviceRunState=this.deviceRunState},devQuery:function(){var e=this;this.loading=!0,this.dataTypeInfo=[];var t=new M.a;t.data.DeviceModel=this.devInfoMgrQueryForm.devModelId,t.data.DeviceNum=this.devInfoMgrQueryForm.devNum,t.data.DeviceState=this.devInfoMgrQueryForm.deviceRunState,t.data.AscrBranch=this.devInfoMgrQueryForm.brno[0],t.data.start=(this.currentPage-1)*this.pageSize,t.data.length=this.pageSize,Object(s.a)(t).then(function(t){e.loading=!1,t.RspInfo&&(e.dataTypeInfo=t.RspInfo.pageList),e.total=t.RspInfo.recordsTotal?t.RspInfo.recordsTotal:0}).catch(function(t){e.$aui.message.show({type:"warning",message:t.SYS_HEAD.ReturnMessage+"!"}),e.loading=!1,e.total=t.RspInfo.recordsTotal?t.RspInfo.recordsTotal:0,console.log(t)})},resetForm:function(e){this.$refs[""+e].resetFields(),this.selBrno=[]},dialogShow:function(){this.dialogOptions.isShow=!0,this.dialogOptions.isChecked=!1,this.dialogOptions.title="新增设备信息",this.dialogOptions.devModel=JSON.parse(o()(this.devModel)),this.dialogOptions.brnoList=JSON.parse(o()(this.brnoList)),this.dialogOptions.log="1",this.dialogOptions.brnoMap=this.brnoMap},modDialogShow:function(){this.isDelete()&&(this.dialogOptions.isShow=!0,this.dialogOptions.isChecked=!0,this.dialogOptions.devId=this.devId,this.dialogOptions.currentRow=this.currentRow[0],this.dialogOptions.title="修改设备信息",this.dialogOptions.log="2",this.dialogOptions.brnoList=JSON.parse(o()(this.brnoList)),this.dialogOptions.brnoMap=this.brnoMap)},onSucess:function(e,t,a){this.fileList.push({name:t.name,url:t.url}),this.$aui.message.show({message:"上传文件成功!",type:"success"})},beforeAvatarUpload:function(e){var t="xls"===e.name.split(".")[1],a="xlsx"===e.name.split(".")[1],i="doc"===e.name.split(".")[1],o="docx"===e.name.split(".")[1],s=e.size/1024/1024<10;return t||a||i||o||this.$aui.message.show({message:"上传模板只能是 xls、xlsx、doc、docx 格式!",type:"warning"}),s||this.$aui.message.show({message:"上传模板大小不能超过 10MB!",type:"warning"}),t||a||i||o&&s}}},C={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"type-info-manage",attrs:{"element-loading-text":"加载中。。。"}},[a("aui-card",{staticStyle:{overflow:"visible"}},[a("aui-form",{ref:"devInfoMgrQueryForm",attrs:{model:e.devInfoMgrQueryForm,size:"mini","label-position":"top"}},[a("aui-row",{attrs:{gutter:10}},[a("aui-col",{attrs:{lg:4,md:6}},[a("aui-form-item",{attrs:{label:"设备型号",prop:"devModelId"}},[a("aui-select",{attrs:{filterable:"",placeholder:"请选择设备型号"},model:{value:e.devInfoMgrQueryForm.devModelId,callback:function(t){e.$set(e.devInfoMgrQueryForm,"devModelId",t)},expression:"devInfoMgrQueryForm.devModelId"}},e._l(e.devModel,function(e){return a("aui-option",{key:e.devicemodel,attrs:{label:e.devicemodel+"-"+e.devicetype,value:e.devicemodel,disabled:e.disabled}})}))],1)],1),e._v(" "),a("aui-col",{attrs:{lg:4,md:6}},[a("aui-form-item",{attrs:{label:"设备编号",prop:"devNum"}},[a("aui-input",{attrs:{placeholder:"请输入设备编号"},model:{value:e.devInfoMgrQueryForm.devNum,callback:function(t){e.$set(e.devInfoMgrQueryForm,"devNum",t)},expression:"devInfoMgrQueryForm.devNum"}})],1)],1),e._v(" "),a("aui-col",{attrs:{lg:4,md:6}},[a("aui-form-item",{attrs:{label:"设备状态",prop:"deviceRunState"}},[a("aui-select",{attrs:{placeholder:"请选择设备运行状态"},model:{value:e.devInfoMgrQueryForm.deviceRunState,callback:function(t){e.$set(e.devInfoMgrQueryForm,"deviceRunState",t)},expression:"devInfoMgrQueryForm.deviceRunState"}},e._l(e.deviceRunState,function(e){return a("aui-option",{key:e.value,attrs:{label:e.label,value:e.value,disabled:e.disabled}})}))],1)],1),e._v(" "),a("aui-col",{attrs:{lg:4,md:6}},[a("aui-form-item",{attrs:{label:"所属机构号",prop:"brno"}},[a("select-tree",{staticStyle:{width:"170px"},attrs:{"single-check":!0,props:{id:"orgno",label:"cname",children:"children"},"tree-data":e.brnoList,placeholder:"请选择机构"},model:{value:e.devInfoMgrQueryForm.brno,callback:function(t){e.$set(e.devInfoMgrQueryForm,"brno",t)},expression:"devInfoMgrQueryForm.brno"}})],1)],1)],1)],1)],1),e._v(" "),a("aui-card",{staticClass:"type-info-bottom"},[a("aui-row",[a("aui-col",{attrs:{lg:2,md:3}},[a("aui-button",{attrs:{type:"primary",size:"mini",icon:"aui-icon-search"},on:{click:e.devQuery}},[e._v("查询")])],1),e._v(" "),a("aui-col",{attrs:{lg:2,md:3}},[a("aui-button",{attrs:{type:"warning",size:"mini",icon:"aui-icon-refresh"},on:{click:function(t){e.resetForm("devInfoMgrQueryForm")}}},[e._v("重置")])],1),e._v(" "),e.btnPermission("Button_DevInfo_Edit")?a("aui-col",{attrs:{lg:2,md:3}},[a("aui-button",{staticClass:"b-button",attrs:{type:"primary",size:"mini",icon:"aui-icon-edit",disabled:1!=e.currentRow.length},on:{click:e.modDialogShow}},[e._v("修改")])],1):e._e(),e._v(" "),a("aui-col",{attrs:{lg:2,md:3}},[a("aui-dropdown",{attrs:{trigger:"click"},on:{command:e.handleCommand}},[a("aui-button",{attrs:{type:"primary",size:"mini",disabled:1!=e.currentRow.length}},[e._v("\n            更多操作"),a("i",{staticClass:"aui-icon-arrow-down aui-icon--right"})]),e._v(" "),a("aui-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e.btnPermission("Button_DevInfo_Enable")?a("aui-dropdown-item",{attrs:{command:"backDialogVisible"}},[e._v("归还")]):e._e(),e._v(" "),e.btnPermission("Button_DevInfo_Scrap")?a("aui-dropdown-item",{attrs:{command:"transferDialogVisible"}},[e._v("调配")]):e._e(),e._v(" "),e.btnPermission("Button_DevInfo_Disable")?a("aui-dropdown-item",{attrs:{command:"stopDialogVisible"}},[e._v("故障")]):e._e(),e._v(" "),e.btnPermission("Button_DevInfo_Disable")?a("aui-dropdown-item",{attrs:{command:"scrapDialogVisible"}},[e._v("报废")]):e._e(),e._v(" "),e.btnPermission("Button_DevInfo_Fix")?a("aui-dropdown-item",{attrs:{command:"devicefixDialogVisible"}},[e._v("维修完成")]):e._e(),e._v(" "),e.btnPermission("Button_DevInfo_Detail")?a("aui-dropdown-item",{attrs:{command:"detailDev"}},[e._v("详细信息")]):e._e()],1)],1)],1)],1),e._v(" "),a("aui-table",{ref:"dataTypeInfo",staticClass:"tableMarginTop",staticStyle:{"min-height":"392px"},attrs:{data:e.dataTypeInfo,border:"",width:"100%","header-row-class-name":"tableHeaderClass","highlight-current-row":""},on:{"selection-change":e.rowDate}},[a("aui-table-column",{attrs:{type:"selection",width:"40px"}}),e._v(" "),a("aui-table-column",{attrs:{prop:"devicetype",formatter:e.dataFormat,label:"设备类型"}}),e._v(" "),a("aui-table-column",{attrs:{prop:"devicemodel",label:"设备型号"}}),e._v(" "),a("aui-table-column",{attrs:{prop:"devicenum",label:"设备编号"}}),e._v(" "),a("aui-table-column",{attrs:{prop:"devicestate",label:"设备状态",formatter:e.dataFormat}}),e._v(" "),a("aui-table-column",{attrs:{prop:"ascrbranch",label:"所属机构",formatter:e.dataFormat}})],1),e._v(" "),a("div",{staticStyle:{"text-align":"right","margin-top":"20px"}},[a("aui-pagination",{attrs:{background:"","page-size":e.pageSize,"current-page":e.currentPage,layout:"total, prev, pager, next, jumper",total:e.total},on:{"current-change":e.changePage}})],1)],1),e._v(" "),a("keep-alive",[a(e.dialogList.createTypeInfo,{tag:"component",attrs:{option:e.dialogOptions},on:{refreshTable:e.devQuery}})],1),e._v(" "),a("keep-alive",[a(e.dialogList.detailTypeInfo,{tag:"component",attrs:{optionDetail:e.detailDialogOptions}})],1),e._v(" "),a("keep-alive",[a(e.dialogList.devTransfer,{tag:"component",attrs:{options:e.transfersOptions},on:{refreshTable:e.devQuery}})],1),e._v(" "),a("aui-dialog",{attrs:{title:"报废",visible:e.scrapDialogVisible,width:"30%"},on:{"update:visible":function(t){e.scrapDialogVisible=t}}},[a("span",{staticClass:"dialog-text"},[e._v("请问确定要报废该设备吗？")]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("aui-button",{attrs:{size:"mini"},on:{click:function(t){e.scrapDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("aui-button",{attrs:{type:"primary",size:"mini"},on:{click:e.scrapDev}},[e._v("确 定")])],1)]),e._v(" "),a("aui-dialog",{attrs:{title:"故障",visible:e.stopDialogVisible,width:"460px"},on:{"update:visible":function(t){e.stopDialogVisible=t}}},[a("span",{staticClass:"dialog-text"},[e._v("请问确定要报故障该设备吗？")]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("aui-button",{attrs:{size:"mini"},on:{click:function(t){e.stopDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("aui-button",{attrs:{type:"primary",size:"mini"},on:{click:e.stopDevInfo}},[e._v("确 定")])],1)]),e._v(" "),a("aui-dialog",{attrs:{title:"归还",visible:e.backDialogVisible,width:"30%"},on:{"update:visible":function(t){e.backDialogVisible=t}}},[a("span",{staticClass:"dialog-text"},[e._v("请问确定要归还该设备吗？")]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("aui-button",{attrs:{size:"mini"},on:{click:function(t){e.backDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("aui-button",{attrs:{type:"primary",size:"mini"},on:{click:e.backDev}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]};var O=a("/Xao")($,C,!1,function(e){a("dGJp")},"data-v-0e3d9cd2",null);t.default=O.exports},bYeW:function(e,t,a){(e.exports=a("BkJT")(!1)).push([e.i,"\n.aui-dialog .el-dialog__body[data-v-f605b428] {\n  padding: 20px 27px 20px !important;\n}\n.content[data-v-f605b428] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n}\n.content .footer[data-v-f605b428] {\n    margin: 10px;\n    text-align: right;\n}\n",""])},dGJp:function(e,t,a){var i=a("hBp0");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a("8bSs")("315c2838",i,!0)},hBp0:function(e,t,a){(e.exports=a("BkJT")(!1)).push([e.i,'\n.type-info-manage[data-v-0e3d9cd2] {\n  text-align: left;\n}\n.top-position[data-v-0e3d9cd2] {\n  margin: 30px 0 0 30px;\n}\n.type-info-bottom[data-v-0e3d9cd2] {\n  margin-top: 10px;\n}\n.dialog-text[data-v-0e3d9cd2] {\n  display: inline-block;\n  width: 100%;\n  text-align: center;\n  color: red;\n  font-size: 18px;\n}\n.headerClass[data-v-0e3d9cd2] {\n  background: #f7f7f7 !important;\n}\n.aui-card[data-v-0e3d9cd2],\n.el-message[data-v-0e3d9cd2] {\n  overflow: "";\n}\n',""])},mpHR:function(e,t,a){var i=a("bYeW");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a("8bSs")("39218120",i,!0)},tAkX:function(e,t,a){var i=a("ze57");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a("8bSs")("387b336d",i,!0)},ze57:function(e,t,a){(e.exports=a("BkJT")(!1)).push([e.i,"",""])}});