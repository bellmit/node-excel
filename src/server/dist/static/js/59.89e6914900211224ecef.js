webpackJsonp([59],{6964:function(a,e,t){var i=t("t8pO");"string"==typeof i&&(i=[[a.i,i,""]]),i.locals&&(a.exports=i.locals);t("8bSs")("9619cc4c",i,!0)},aL0G:function(a,e,t){(a.exports=t("BkJT")(!1)).push([a.i,"",""])},aVgK:function(a,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=t("aA9S"),r=t.n(i),o=t("0oES"),s=t("pADA"),n=t("tzsN"),l=t("B+2e"),c=t("AA3o"),m=t.n(c),u=function a(){m()(this,a),this.data={OrgNo:"",ParamName:"",ParamValue:"",ParamDesc:"",ModyDate:"",ModyTime:""},this.CommCode="SSParamManage",this.SceneCode="ParamAdd",this.TransServiceCode="mg-afaservices-stm/ParamAdd"},d=function a(){m()(this,a),this.data={OrgNo:"",ParamName:"",ParamValue:"",ParamDesc:"",ModyDate:"",ModyTime:""},this.CommCode="SSParamManage",this.SceneCode="ParamUpd",this.TransServiceCode="mg-afaservices-stm/ParamUpd"},p=t("fCv1"),g={props:{option:Object},components:{selectTree:n.a},data:function(){return{loading:!1,brnoList:[],form:{OrgNo:[],ParamName:"",ParamValue:"",ParamDesc:"",ModyDate:"",ModyTime:""},rules:{OrgNo:[{required:!0,message:"请选择机构号",trigger:"change"}],ParamName:[{required:!0,message:"请选择参数名称",trigger:"change"}],ParamValue:[{required:!0,message:"请输入参数数值",trigger:"blur"},{required:!1,validator:Object(p.i)(18,2),trigger:"blur"}],ParamDesc:[{required:!0,message:"请输入参数描述",trigger:"blur"},{required:!0,validator:Object(p.h)(256),trigger:"blur"}]}}},created:function(){},methods:{openUpdate:function(){var a=this;this.$nextTick(function(){a.option.isDisabled?a.setData():a.$refs.form&&a.$refs.form.clearValidate()})},setData:function(){this.form=r()({},this.option.currentRow),this.form.OrgNo=[this.form.OrgNo],this.form.ParamValue=this.option.currentRow.ParamValue},closeUpdete:function(){this.$refs.form.resetFields(),this.$refs.form.clearValidate()},paramNameChange:function(){this.form.ParamValue=5e4},ItemUpdate:function(){var a=this;this.$refs.form.validate(function(e){if(e){a.loading=!0;var t=a.option.isDisabled?new d:new u;t.data=r()({},a.form),t.data.OrgNo=t.data.OrgNo[0],t.data.ModyDate=s.a.getDateTime("date"),t.data.ModyTime=s.a.getDateTime("time"),console.log(t.data),Object(o.a)(t).then(function(e){console.log("resBody",t),a.$emit("refreshTable"),a.option.isShow=!1;a.option.isDisabled;a.$aui.message.show({type:"success",message:""+e.SYS_HEAD.ReturnMessage}),a.loading=!1}).catch(function(e){a.$aui.message.show({type:"warning",message:""+e.SYS_HEAD.ReturnMessage}),a.loading=!1})}else a.$aui.message.show({type:"warning",message:"请输入合法数据!"}),a.loading=!1})}}},h={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",[t("aui-dialog",{attrs:{title:a.option.title,visible:a.option.isShow,width:"800px","close-on-click-modal":!1},on:{"update:visible":function(e){a.$set(a.option,"isShow",e)},show:a.openUpdate,hide:a.closeUpdete}},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:a.loading,expression:"loading"}]},[t("aui-card",[t("aui-form",{ref:"form",attrs:{model:a.form,size:"mini",rules:a.rules,"label-width":"140px","label-position":"right"}},[t("aui-row",{attrs:{gutter:40}},[t("aui-col",{attrs:{span:12}},[t("aui-form-item",{attrs:{label:"机构编号:",prop:"OrgNo"}},[t("select-tree",{staticStyle:{width:"170px"},attrs:{"single-check":!0,props:{id:"orgno",label:"cname",children:"children"},"tree-data":a.option.branchNum,disabled:a.option.isDisabled,placeholder:"请选择机构"},model:{value:a.form.OrgNo,callback:function(e){a.$set(a.form,"OrgNo",e)},expression:"form.OrgNo"}})],1)],1),a._v(" "),t("aui-col",{attrs:{span:12}},[t("aui-form-item",{attrs:{label:"参数名称:",prop:"ParamName"}},[t("aui-select",{attrs:{placeholder:"请选择参数名称",disabled:a.option.isDisabled},on:{change:a.paramNameChange},model:{value:a.form.ParamName,callback:function(e){a.$set(a.form,"ParamName",e)},expression:"form.ParamName"}},a._l(a.option.paramTypeList,function(a){return t("aui-option",{key:a.DataKeyVal,attrs:{label:a.DataKeyVal+"-"+a.Meaning,value:a.DataKeyVal}})}))],1)],1),a._v(" "),t("aui-col",{attrs:{span:12}},[t("aui-form-item",{attrs:{label:"参数数值:",prop:"ParamValue"}},[t("aui-input",{attrs:{placeholder:"请输入参数数值"},model:{value:a.form.ParamValue,callback:function(e){a.$set(a.form,"ParamValue",e)},expression:"form.ParamValue"}})],1)],1),a._v(" "),t("aui-col",{attrs:{span:24}},[t("aui-form-item",{attrs:{label:"参数描述:",prop:"ParamDesc"}},[t("aui-input",{attrs:{type:"textarea",rows:4,resize:"none"},model:{value:a.form.ParamDesc,callback:function(e){a.$set(a.form,"ParamDesc",e)},expression:"form.ParamDesc"}})],1)],1)],1)],1)],1),a._v(" "),t("aui-row",{staticStyle:{margin:"20px 0","text-align":"right"}},[t("aui-button",{attrs:{size:"mini"},on:{click:function(e){a.option.isShow=!1}}},[a._v("返回")]),a._v(" "),t("aui-button",{attrs:{type:"primary",size:"mini"},on:{click:a.ItemUpdate}},[a._v("确定")])],1)],1)])],1)},staticRenderFns:[]};var f=t("/Xao")(g,h,!1,function(a){t("xwIn")},null,null).exports,b=t("syAl"),y=t("0VOF"),v=function a(){m()(this,a),this.data={OrgNo:"",ParamName:""},this.CommCode="SSParamManage",this.SceneCode="ParamDel",this.TransServiceCode="mg-afaservices-stm/ParamDel"},w=function a(){m()(this,a),this.data={OrgNo:"",Page:"",PageNum:""},this.CommCode="SSParamManage",this.SceneCode="ParamQuey",this.TransServiceCode="mg-afaservices-stm/ParamQuey"},P={components:{selectTree:n.a},data:function(){return{currentRow:[],paramTypeList:[],paramTypeMap:{},QueryForm:{branchNum:[]},brnoList:[],branchNum:[],total:void 0,busiTypeList:[],brnoMap:{},permission:{},loading:!1,isDisabledDel:!1,dialogList:{dialogAdd:f},dialogOptions:{isShow:!1},currentPage:1,pageSize:void 0,rules:{}}},mounted:function(){var a=this;this.pageSize=b.a.get("PageSize"),this.$nextTick(function(){a.paramLoad()})},computed:{},methods:{paramLoad:function(){this.queryBranchNum(),this.paramTypeLoad()},paramTypeLoad:function(){var a=this;this.loading=!0;var e=new l.a;e.data.DataKey="stmTranParam",Object(o.a)(e).then(function(e){a.paramTypeList=e.RspInfo.Result||[],a.paramTypeMap=s.a.objArray2Hash(a.paramTypeList,"DataKeyVal"),a.loading=!1}).catch(function(e){a.$aui.message.show({type:"warning",message:e.SYS_HEAD.ReturnMessage+"!"}),a.loading=!1})},queryBranchNum:function(){var a=this;this.loading=!0;var e=new y.a;e.data.orgno=this.$store.getters.BranchNum,Object(o.a)(e).then(function(e){a.loading=!1,a.branchNum=e.RspInfo.Result||[],a.brnoMap=e.RspInfo.orgMap||{},a.permission=s.a.objArray2Hash(a.branchNum,"orgno"),a.brnoList=s.a.formatTreeData(a.branchNum,"orgno","superno"),a.QueryForm.branchNum.push(a.brnoList[0].orgno)}).catch(function(e){a.loading=!1,a.$aui.message.show({type:"warning",message:e.SYS_HEAD.ReturnMessage}),console.error("查询错误",e)})},dataFormat:function(a,e){var t=a[e.property];return"OrgNo"==e.property?t+"-"+a.ORG_Nm:"ParamName"==e.property?t+(this.paramTypeMap[t]?"-"+this.paramTypeMap[t].Meaning:""):"ModyDate"==e.property?this.toolBox.timeFormat2Date(t):"ModyTime"==e.property?this.toolBox.timeFormat2Time(t):void 0},clickAdd:function(){this.dialogOptions.isShow=!0,this.dialogOptions.title="新增交易费用参数",this.dialogOptions.isDisabled=!1,this.dialogOptions.branchNum=this.brnoList,this.dialogOptions.paramTypeList=this.paramTypeList},clickUpdate:function(){this.dialogOptions.isShow=!0,this.dialogOptions.title="修改交易费用参数",this.dialogOptions.isDisabled=!0,this.dialogOptions.currentRow=this.currentRow,this.dialogOptions.branchNum=this.brnoList,this.dialogOptions.paramTypeList=this.paramTypeList},checkPermission:function(a){this.permission[this.currentRow.OrgNo]?"1"==a?this.clickUpdate():this.delBut():this.$aui.message.show({type:"warning",message:"权限不足,无法修改！"})},resetForm:function(){this.currentPage=1,this.$refs.QueryForm.resetFields()},delBut:function(){var a=this;this.$aui.confirm.show("此操作将永久删除该交易费用参数, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.dateDel()}).catch(function(){a.$aui.message.show({type:"info",message:"已取消删除"})})},dateDel:function(){var a=this;this.loading=!0;var e=new v;e.data.OrgNo=this.currentRow.OrgNo,e.data.ParamName=this.currentRow.ParamName,Object(o.a)(e).then(function(e){a.loading=!1,a.$aui.message.show({type:"success",message:"删除成功！"}),a.currentRow=1,a.query()}).catch(function(e){a.$aui.message.show({type:"warning",message:e.SYS_HEAD.ReturnMessage}),a.loading=!1,console.log(e)})},query:function(){var a=this;this.loading=!0;var e=new w,t=this.QueryForm.branchNum[0]||"";e.data.OrgNo=""==t?this.$store.getters.BranchNum:t,e.data.PageNum=this.pageSize,e.data.Page=this.currentPage,Object(o.a)(e).then(function(e){console.log("数据：",e.RspInfo.QueyResult),a.loading=!1;var t=e.RspInfo.QueyResult||[];a.busiTypeList=t,a.total=e.RspInfo.TotalRcdCount||0,a.total&&0!==a.total||(a.$aui.message.show({type:"warning",message:"没有满足条件得记录!"}),a.busiTypeList=[])}).catch(function(e){a.loading=!1,a.$aui.message.show({type:"error",message:"请求失败，错误码:"+e.SYS_HEAD.ReturnCode+"，错误信息："+e.SYS_HEAD.ReturnMessage}),a.busiTypeList=[],console.log(e)})},handleCurrentChange:function(a){this.currentPage=a,this.query()},selectList:function(a){1==a.length?(this.isDisabledDel=!0,this.currentRow=a[0]):a.length>1?this.$refs.busiTypeList.toggleRowSelection(a[0]):this.isDisabledDel=!1}}},N={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",[t("div",{directives:[{name:"loading",rawName:"v-loading",value:a.loading,expression:"loading"}],attrs:{"element-loading-text":"加载中。。。"}},[t("aui-card",[t("aui-form",{ref:"QueryForm",attrs:{model:a.QueryForm,rules:a.rules,size:"mini","label-position":"top"}},[t("aui-row",{attrs:{gutter:10}},[t("aui-col",{attrs:{lg:4,md:6}},[t("aui-form-item",{attrs:{label:"机构编号",prop:"branchNum"}},[t("select-tree",{staticStyle:{width:"170px"},attrs:{"single-check":!0,props:{id:"orgno",label:"cname",children:"children"},"tree-data":a.brnoList,placeholder:"请选择机构"},model:{value:a.QueryForm.branchNum,callback:function(e){a.$set(a.QueryForm,"branchNum",e)},expression:"QueryForm.branchNum"}})],1)],1),a._v(" "),t("aui-col",{staticClass:"searchBtnMarginTop",attrs:{lg:2,md:3}},[t("aui-button",{attrs:{type:"primary",size:"mini",icon:"aui-icon-search"},on:{click:a.query}},[a._v("查询")])],1),a._v(" "),t("aui-col",{staticClass:"searchBtnMarginTop",attrs:{lg:2,md:3}},[t("aui-button",{attrs:{type:"warning",size:"mini",icon:"aui-icon-refresh"},on:{click:function(e){a.resetForm("QueryForm")}}},[a._v("重置")])],1)],1)],1)],1),a._v(" "),t("aui-card",{staticStyle:{"margin-top":"10px"}},[t("aui-row",{attrs:{gutter:10}},[t("aui-col",{attrs:{lg:2,md:3}},[a.btnPermission("Button_Menu_Add")?t("aui-button",{attrs:{type:"primary",size:"mini",icon:"aui-icon-plus"},on:{click:a.clickAdd}},[a._v("新增")]):a._e()],1),a._v(" "),t("aui-col",{attrs:{lg:2,md:3}},[a.btnPermission("Button_Menu_Add")?t("aui-button",{attrs:{type:"primary",disabled:!a.isDisabledDel,size:"mini",icon:"aui-icon-edit"},on:{click:function(e){a.checkPermission("1")}}},[a._v("修改")]):a._e()],1),a._v(" "),t("aui-col",{attrs:{lg:2,md:3}},[a.btnPermission("Button_Menu_Edit")?t("aui-button",{attrs:{type:"danger",disabled:!a.isDisabledDel,size:"mini",icon:"aui-icon-delete"},on:{click:function(e){a.checkPermission()}}},[a._v("删除")]):a._e()],1)],1),a._v(" "),t("aui-table",{ref:"busiTypeList",staticClass:"tableMarginTop",staticStyle:{"min-height":"390px"},attrs:{data:a.busiTypeList,border:"","header-row-class-name":"tableHeaderClass"},on:{"selection-change":a.selectList}},[t("aui-table-column",{attrs:{type:"selection",width:"40px"}}),a._v(" "),t("aui-table-column",{attrs:{prop:"OrgNo",label:"机构编号",formatter:a.dataFormat,"min-width":"137px"}}),a._v(" "),t("aui-table-column",{attrs:{prop:"ParamName",label:"参数名称",formatter:a.dataFormat,"min-width":"137px"}}),a._v(" "),t("aui-table-column",{attrs:{prop:"ParamValue",label:"参数数值","min-width":"107px","show-overflow-tooltip":""}}),a._v(" "),t("aui-table-column",{attrs:{prop:"ParamDesc",label:"参数描述","min-width":"107px"}}),a._v(" "),t("aui-table-column",{attrs:{prop:"ModyDate",label:"上次修改日期",formatter:a.dataFormat,"min-width":"107px"}}),a._v(" "),t("aui-table-column",{attrs:{prop:"ModyTime",label:"上次修改时间",formatter:a.dataFormat,"min-width":"107px"}})],1),a._v(" "),t("div",{staticStyle:{"text-align":"right","margin-top":"10px"}},[t("aui-pagination",{attrs:{background:"","current-page":a.currentPage,"page-size":10,layout:"total, prev, pager, next, jumper",total:a.total},on:{"current-change":a.handleCurrentChange}})],1)],1)],1),a._v(" "),t("keep-alive",[t(a.dialogList.dialogAdd,{tag:"component",attrs:{option:a.dialogOptions},on:{refreshTable:a.query}})],1)],1)},staticRenderFns:[]};var D=t("/Xao")(P,N,!1,function(a){t("6964")},"data-v-5c5e3352",null);e.default=D.exports},t8pO:function(a,e,t){(a.exports=t("BkJT")(!1)).push([a.i,"",""])},xwIn:function(a,e,t){var i=t("aL0G");"string"==typeof i&&(i=[[a.i,i,""]]),i.locals&&(a.exports=i.locals);t("8bSs")("5145894a",i,!0)}});